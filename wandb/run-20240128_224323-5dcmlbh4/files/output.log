Training flows transformer...
{'activation': 'softplus', 'batch_size': 4, 'd_k': 64, 'd_rnn': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 5, 'smooth': 0}
Loading All Datasets...
45 9
d_model: 128
d_inner 512
d_k 64
d_k 64
hawkes False
WITH RNN
[ Epoch 1 ]


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.51it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
(Testing) Acc:  0.16345, MAE:  0.57448, GPA:  0.03158
Best ACC:  0.16345, MAE:  0.57448, GPA:  0.03158
improvement in epoch 1



  - (Training)   :  57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 69/121 [00:05<00:03, 16.71it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.27542, MAE:  0.53718, GPA:  0.06316
Best ACC:  0.27542, MAE:  0.53718, GPA:  0.06316
improvement in epoch 2



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.36it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.35135, MAE:  0.53571, GPA:  0.06316
Best ACC:  0.35135, MAE:  0.53571, GPA:  0.06316
improvement in epoch 3



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.19it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.39254, MAE:  0.53411, GPA:  0.13684
Best ACC:  0.39254, MAE:  0.53411, GPA:  0.13684
improvement in epoch 4



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.24it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.41699, MAE:  0.51202, GPA:  0.15789
Best ACC:  0.41699, MAE:  0.51202, GPA:  0.15789
improvement in epoch 5


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:51,  2.93s/it]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.43372, MAE:  0.51381, GPA:  0.17895
Best ACC:  0.43372, MAE:  0.51202, GPA:  0.17895
improvement in epoch 6



  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.48153, MAE:  0.44928, Itv. GPA:  0.67710
(Testing) Acc:  0.49807, MAE:  0.53303, GPA:  0.21053
Best ACC:  0.49807, MAE:  0.51202, GPA:  0.21053
improvement in epoch 7



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:05<00:03, 15.61it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
(Testing) Acc:  0.51223, MAE:  0.51494, GPA:  0.18947
Best ACC:  0.51223, MAE:  0.51202, GPA:  0.21053
improvement in epoch 8



  - (Training)   :  57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 69/121 [00:05<00:03, 16.72it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.54440, MAE:  0.50986, GPA:  0.28421
Best ACC:  0.54440, MAE:  0.50986, GPA:  0.28421
improvement in epoch 9



  - (Training)   :  57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 69/121 [00:05<00:03, 16.75it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
(Testing) Acc:  0.54826, MAE:  0.50998, GPA:  0.29474
Best ACC:  0.54826, MAE:  0.50986, GPA:  0.29474
improvement in epoch 10



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.34it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.55985, MAE:  0.51641, GPA:  0.29474
Best ACC:  0.55985, MAE:  0.50986, GPA:  0.29474
improvement in epoch 11



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.10it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.58044, MAE:  0.63067, GPA:  0.29474
Best ACC:  0.58044, MAE:  0.50986, GPA:  0.29474



  - (Training)   :  53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 64/121 [00:04<00:03, 15.62it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.56757, MAE:  0.51667, GPA:  0.29474
Best ACC:  0.58044, MAE:  0.50986, GPA:  0.29474
improvement in epoch 13



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.35it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.57915, MAE:  0.51422, GPA:  0.29474
Best ACC:  0.58044, MAE:  0.50986, GPA:  0.29474
improvement in epoch 14



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.52it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.58687, MAE:  0.50302, GPA:  0.29474
Best ACC:  0.58687, MAE:  0.50302, GPA:  0.29474
improvement in epoch 15


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.55it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
(Testing) Acc:  0.60618, MAE:  0.52061, GPA:  0.29474
Best ACC:  0.60618, MAE:  0.50302, GPA:  0.29474
improvement in epoch 16



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:05<00:03, 16.51it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
(Testing) Acc:  0.60618, MAE:  0.57677, GPA:  0.29474
Best ACC:  0.60618, MAE:  0.50302, GPA:  0.29474



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:05<00:03, 15.67it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
(Testing) Acc:  0.61261, MAE:  0.50282, GPA:  0.29474
Best ACC:  0.61261, MAE:  0.50282, GPA:  0.29474
improvement in epoch 18



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.38it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61261, MAE:  0.49110, GPA:  0.30526
Best ACC:  0.61261, MAE:  0.49110, GPA:  0.30526
improvement in epoch 19



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:04<00:03, 15.95it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61004, MAE:  0.50080, GPA:  0.29474
Best ACC:  0.61261, MAE:  0.49110, GPA:  0.30526
improvement in epoch 20


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:49,  2.91s/it]


  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61133, MAE:  0.51235, GPA:  0.29474
Best ACC:  0.61261, MAE:  0.49110, GPA:  0.30526



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.58it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61776, MAE:  0.50809, GPA:  0.30526
Best ACC:  0.61776, MAE:  0.49110, GPA:  0.30526
improvement in epoch 22



  - (Training)   :  53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 64/121 [00:05<00:03, 15.47it/s]


(Testing) Acc:  0.61261, MAE:  0.49438, GPA:  0.30526
Best ACC:  0.61776, MAE:  0.49110, GPA:  0.30526
improvement in epoch 23
[ Epoch 24 ]


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.55it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
(Testing) Acc:  0.61647, MAE:  0.50814, GPA:  0.30526
Best ACC:  0.61776, MAE:  0.49110, GPA:  0.30526
improvement in epoch 24



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.58it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
(Testing) Acc:  0.61519, MAE:  0.49122, GPA:  0.30526
Best ACC:  0.61776, MAE:  0.49110, GPA:  0.30526
improvement in epoch 25



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.35it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61776, MAE:  0.49929, GPA:  0.30526
Best ACC:  0.61776, MAE:  0.49110, GPA:  0.30526
improvement in epoch 26



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.17it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62162, MAE:  0.51197, GPA:  0.30526
Best ACC:  0.62162, MAE:  0.49110, GPA:  0.30526



  - (Training)   :  53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 64/121 [00:04<00:03, 15.64it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61905, MAE:  0.48652, GPA:  0.30526
Best ACC:  0.62162, MAE:  0.48652, GPA:  0.30526
improvement in epoch 28



  - (Training)   :  55%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                             | 67/121 [00:04<00:03, 16.41it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61390, MAE:  0.49446, GPA:  0.30526
Best ACC:  0.62162, MAE:  0.48652, GPA:  0.30526



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.58it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.62033, MAE:  0.50511, GPA:  0.30526
Best ACC:  0.62162, MAE:  0.48652, GPA:  0.30526


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.61it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.62162, MAE:  0.48741, GPA:  0.30526
Best ACC:  0.62162, MAE:  0.48652, GPA:  0.30526
improvement in epoch 31


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:05<00:03, 16.43it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.62420, MAE:  0.52693, GPA:  0.30526
Best ACC:  0.62420, MAE:  0.48652, GPA:  0.30526



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:05<00:03, 15.98it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
(Testing) Acc:  0.62806, MAE:  0.49167, GPA:  0.30526
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.30526
improvement in epoch 33



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.55it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62548, MAE:  0.49975, GPA:  0.30526
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.30526



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.24it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61776, MAE:  0.50966, GPA:  0.30526
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.30526



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:04<00:03, 15.94it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62420, MAE:  0.49807, GPA:  0.30526
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.30526
improvement in epoch 36




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.63419, MAE:  0.43879, Itv. GPA:  0.78544
(Testing) Acc:  0.62420, MAE:  0.49650, GPA:  0.30526
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.30526
improvement in epoch 37



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.11it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.62033, MAE:  0.53671, GPA:  0.31579
Best ACC:  0.62806, MAE:  0.48652, GPA:  0.31579



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:05<00:03, 16.48it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.62548, MAE:  0.47875, GPA:  0.31579
Best ACC:  0.62806, MAE:  0.47875, GPA:  0.31579
improvement in epoch 39



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.50it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.63320, MAE:  0.49739, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:05<00:03, 16.44it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
(Testing) Acc:  0.62934, MAE:  0.48267, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.49it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63320, MAE:  0.49804, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  53%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 64/121 [00:04<00:03, 15.60it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63192, MAE:  0.50490, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  55%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                               | 66/121 [00:04<00:03, 16.15it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63192, MAE:  0.49921, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63192, MAE:  0.48601, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579
improvement in epoch 45


  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.58it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.62806, MAE:  0.49423, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579


  - (Training)   :  57%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                         | 69/121 [00:05<00:03, 16.71it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.62806, MAE:  0.47896, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579
improvement in epoch 47



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:05<00:03, 15.67it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.62806, MAE:  0.49752, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                           | 68/121 [00:04<00:03, 16.55it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62677, MAE:  0.55375, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.47875, GPA:  0.31579



  - (Training)   :  54%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                | 65/121 [00:04<00:03, 15.88it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62934, MAE:  0.50537, GPA:  0.31579

