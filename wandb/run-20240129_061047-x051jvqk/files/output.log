Training flows transformer...
{'activation': 'softplus', 'batch_size': 4, 'd_k': 256, 'd_rnn': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 6, 'smooth': 0}
Loading All Datasets...
45 9
d_model: 512
d_inner 2048
d_k 256
d_k 256
hawkes False
WITH RNN
[ Epoch 1 ]



  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.16778, MAE:  0.51601, Itv. GPA:  0.17517
(Testing) Acc:  0.20335, MAE:  0.53281, GPA:  0.03158
Best ACC:  0.20335, MAE:  0.53281, GPA:  0.03158
improvement in epoch 1



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.41it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.38353, MAE:  0.52976, GPA:  0.09474
Best ACC:  0.38353, MAE:  0.52976, GPA:  0.09474
improvement in epoch 2



  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
(Testing) Acc:  0.44916, MAE:  0.51752, GPA:  0.23158
Best ACC:  0.44916, MAE:  0.51752, GPA:  0.23158
improvement in epoch 3



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.25it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.45689, MAE:  0.50636, GPA:  0.25263
Best ACC:  0.45689, MAE:  0.50636, GPA:  0.25263
improvement in epoch 4



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.43it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.45302, MAE:  0.52707, GPA:  0.27368
Best ACC:  0.45689, MAE:  0.50636, GPA:  0.27368
improvement in epoch 5



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.47it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.47490, MAE:  0.54260, GPA:  0.29474
Best ACC:  0.47490, MAE:  0.50636, GPA:  0.29474
improvement in epoch 6



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.70it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.49035, MAE:  0.52469, GPA:  0.29474
Best ACC:  0.49035, MAE:  0.50636, GPA:  0.29474
improvement in epoch 7



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.64it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.52252, MAE:  0.49679, GPA:  0.29474
Best ACC:  0.52252, MAE:  0.49679, GPA:  0.29474
improvement in epoch 8



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                              | 57/121 [00:04<00:04, 13.87it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.56499, MAE:  0.48632, GPA:  0.30526
Best ACC:  0.56499, MAE:  0.48632, GPA:  0.30526
improvement in epoch 9




  - (Training)   :  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 120/121 [00:07<00:00, 20.74it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.56371, MAE:  0.49284, GPA:  0.29474
Best ACC:  0.56499, MAE:  0.48632, GPA:  0.30526
improvement in epoch 10



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.87it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.57400, MAE:  0.51500, GPA:  0.31579
Best ACC:  0.57400, MAE:  0.48632, GPA:  0.31579
improvement in epoch 11



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.81it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.57143, MAE:  0.53247, GPA:  0.31579
Best ACC:  0.57400, MAE:  0.48632, GPA:  0.31579




  - (Training)   :  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 119/121 [00:06<00:00, 20.62it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.58559, MAE:  0.50957, GPA:  0.31579
Best ACC:  0.58559, MAE:  0.48632, GPA:  0.31579
improvement in epoch 13



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:05<00:04, 14.42it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
(Testing) Acc:  0.57529, MAE:  0.51432, GPA:  0.31579
Best ACC:  0.58559, MAE:  0.48632, GPA:  0.31579



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.69it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.58044, MAE:  0.48547, GPA:  0.31579
Best ACC:  0.58559, MAE:  0.48547, GPA:  0.31579
improvement in epoch 15



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.69it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.60232, MAE:  0.52235, GPA:  0.31579
Best ACC:  0.60232, MAE:  0.48547, GPA:  0.31579
improvement in epoch 16



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.73it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.59331, MAE:  0.48716, GPA:  0.31579
Best ACC:  0.60232, MAE:  0.48547, GPA:  0.31579




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 118/121 [00:07<00:00, 20.49it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61647, MAE:  0.50787, GPA:  0.31579
Best ACC:  0.61647, MAE:  0.48547, GPA:  0.31579
improvement in epoch 18



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:05<00:04, 14.28it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.61004, MAE:  0.48572, GPA:  0.31579
Best ACC:  0.61647, MAE:  0.48547, GPA:  0.31579
improvement in epoch 19



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.70it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.61390, MAE:  0.46076, GPA:  0.31579
Best ACC:  0.61647, MAE:  0.46076, GPA:  0.31579
improvement in epoch 20




  - (Training)   : 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 121/121 [00:07<00:00, 20.88it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62291, MAE:  0.58738, GPA:  0.31579
Best ACC:  0.62291, MAE:  0.46076, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.50it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
(Testing) Acc:  0.64350, MAE:  0.49149, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.39it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62806, MAE:  0.50130, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.34it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63320, MAE:  0.51628, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579




  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.71it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62677, MAE:  0.49952, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579
improvement in epoch 25




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.63700, MAE:  0.44099, Itv. GPA:  0.80654
(Testing) Acc:  0.63578, MAE:  0.47535, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579
improvement in epoch 26



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.63it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
(Testing) Acc:  0.64350, MAE:  0.49304, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.31579



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.69it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63578, MAE:  0.52223, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 118/121 [00:07<00:00, 20.40it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63449, MAE:  0.65862, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.81it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
(Testing) Acc:  0.63578, MAE:  0.52646, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  51%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                      | 62/121 [00:04<00:03, 15.02it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63449, MAE:  0.51463, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 31



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.57it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63192, MAE:  0.49738, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 32


  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.77it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
(Testing) Acc:  0.63578, MAE:  0.48752, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 33




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.64931, MAE:  0.44573, Itv. GPA:  0.81041
(Testing) Acc:  0.63449, MAE:  0.48569, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 34



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.82it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63707, MAE:  0.57434, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632


  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.75it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63449, MAE:  0.53062, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.65916, MAE:  0.43748, Itv. GPA:  0.81604
(Testing) Acc:  0.63320, MAE:  0.54772, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.60it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63449, MAE:  0.49444, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:05<00:04, 14.47it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63964, MAE:  0.48910, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 39



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.65it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63964, MAE:  0.46822, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632
improvement in epoch 40


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.52it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.63707, MAE:  0.51684, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.67it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63578, MAE:  0.48069, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:05<00:04, 14.18it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.64093, MAE:  0.50346, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.36it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63835, MAE:  0.48899, GPA:  0.32632
Best ACC:  0.64350, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.85it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64607, MAE:  0.48883, GPA:  0.32632
Best ACC:  0.64607, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.81it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.64221, MAE:  0.68658, GPA:  0.32632
Best ACC:  0.64607, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.84it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64736, MAE:  0.49902, GPA:  0.32632
Best ACC:  0.64736, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 118/121 [00:07<00:00, 20.31it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.64350, MAE:  0.46938, GPA:  0.32632
Best ACC:  0.64736, MAE:  0.46076, GPA:  0.32632
improvement in epoch 48


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:05<00:04, 14.26it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
(Testing) Acc:  0.63835, MAE:  0.48963, GPA:  0.32632
Best ACC:  0.64736, MAE:  0.46076, GPA:  0.32632



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.81it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64093, MAE:  0.55252, GPA:  0.32632

