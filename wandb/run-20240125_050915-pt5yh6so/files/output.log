Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 5, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.12050199508667 with time_loss: -2.3180596828460693 and type_loss 3.4385616779327393



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.6291574239730835 with time_loss: -1.6161619424819946 and type_loss 3.245319366455078




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.3094015121459961 with time_loss: -2.770406723022461 and type_loss 3.079808235168457




  - (Training)   :  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 92/121 [00:07<00:01, 16.78it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.25146055221557617 with time_loss: -2.7575154304504395 and type_loss 3.0089759826660156




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:07<00:06,  9.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.16540813446044922 with time_loss: -3.122736692428589 and type_loss 2.9573285579681396
New best found!




  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:07<00:07,  9.23it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.7489298582077026 with time_loss: -1.2994922399520874 and type_loss 3.04842209815979




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:07<00:07,  9.15it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.2996678352355957 with time_loss: -3.1814727783203125 and type_loss 2.881804943084717
New best found!





  - (Training)   :  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 93/121 [00:09<00:02, 13.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.0839779376983643 with time_loss: -1.8618433475494385 and type_loss 2.9458212852478027





  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:09<00:01, 13.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 1.7827606201171875 with time_loss: -1.250411033630371 and type_loss 3.0331716537475586



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:04<00:03, 16.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 1.3530073165893555 with time_loss: -1.5408992767333984 and type_loss 2.893906593322754




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 17.69it/s]



  - (Training)   :  91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                  | 29/32 [00:05<00:00,  6.84it/s]
Test loss: 0.5590076446533203 with time_loss: -2.3300774097442627 and type_loss 2.889085054397583



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: 2.738865852355957 with time_loss: -0.16293130815029144 and type_loss 2.90179705619812



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.10s/it]
Test loss: 0.37851476669311523 with time_loss: -2.5354056358337402 and type_loss 2.9139204025268555




  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:07<00:03, 13.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7136468887329102 with time_loss: -3.587841033935547 and type_loss 2.8741941452026367
New best found!





  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:09<00:04,  9.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 0.8268842697143555 with time_loss: -2.0580101013183594 and type_loss 2.884894371032715






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8243465423583984 with time_loss: -3.6416471004486084 and type_loss 2.81730055809021
Test loss: 1.630173683166504 with time_loss: -1.2317721843719482 and type_loss 2.861945867538452





  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:09<00:04,  9.52it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3429298400878906 with time_loss: -2.5284907817840576 and type_loss 2.8714206218719482





  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:09<00:04,  9.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.38052821159362793 with time_loss: -3.212867498397827 and type_loss 2.832339286804199





  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:09<00:04, 10.01it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.4244863986968994 with time_loss: -3.263017177581787 and type_loss 2.8385307788848877





  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:09<00:05,  9.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2514972686767578 with time_loss: -2.5972580909729004 and type_loss 2.848755359649658





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:11<00:02, 10.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4777641296386719 with time_loss: -1.4507615566253662 and type_loss 2.928525686264038






  - (Training)   :  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 103/121 [00:11<00:01, 10.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.342609167098999 with time_loss: -0.5392377376556396 and type_loss 2.8818469047546387





  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:09<00:04,  9.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.13135552406311035 with time_loss: -2.986325263977051 and type_loss 2.8549697399139404





  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:09<00:04,  9.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2470334768295288 with time_loss: -1.5668541193008423 and type_loss 2.813887596130371






  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:11<00:02, 10.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.156183958053589 with time_loss: -0.6502032279968262 and type_loss 2.806387186050415






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.2022078037261963 with time_loss: -3.961934804916382 and type_loss 2.7597270011901855
Test loss: 2.059142827987671 with time_loss: -0.7545141577720642 and type_loss 2.81365704536438





  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:09<00:04, 10.02it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5529862642288208 with time_loss: -1.2616556882858276 and type_loss 2.8146419525146484





  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:09<00:04,  9.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8462774753570557 with time_loss: -2.0619571208953857 and type_loss 2.9082345962524414






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.2181456089019775 with time_loss: -3.9757351875305176 and type_loss 2.75758957862854
Test loss: 2.362387180328369 with time_loss: -0.4344927668571472 and type_loss 2.796880006790161





  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:09<00:04,  9.93it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6396059989929199 with time_loss: -2.1951589584350586 and type_loss 2.8347649574279785





  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:09<00:04, 10.04it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7381365299224854 with time_loss: -2.070063829421997 and type_loss 2.8082003593444824





  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:09<00:04, 10.06it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.5299177169799805 with time_loss: -0.31588393449783325 and type_loss 2.845801591873169





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3485889434814453 with time_loss: -4.080128192901611 and type_loss 2.731539249420166
Test loss: 1.993947148323059 with time_loss: -0.8082693815231323 and type_loss 2.8022165298461914






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4065873622894287 with time_loss: -4.133129119873047 and type_loss 2.726541757583618
Test loss: 2.6112375259399414 with time_loss: -0.1932835578918457 and type_loss 2.804521083831787






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.393608808517456 with time_loss: -4.1147260665893555 and type_loss 2.7211172580718994
Test loss: 2.9265570640563965 with time_loss: 0.12204458564519882 and type_loss 2.8045125007629395






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.957286834716797 with time_loss: 0.15315715968608856 and type_loss 2.8041296005249023





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4151945114135742 with time_loss: -4.131002426147461 and type_loss 2.7158079147338867
Test loss: 2.8002960681915283 with time_loss: -0.030383937060832977 and type_loss 2.8306798934936523






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4510133266448975 with time_loss: -4.170952320098877 and type_loss 2.7199389934539795
Test loss: 2.9924838542938232 with time_loss: 0.16288422048091888 and type_loss 2.829599618911743






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.437143087387085 with time_loss: -4.152200698852539 and type_loss 2.715057611465454
Test loss: 3.0955216884613037 with time_loss: 0.29204991459846497 and type_loss 2.803471803665161






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4514870643615723 with time_loss: -4.166480541229248 and type_loss 2.714993476867676
Test loss: 3.006840229034424 with time_loss: 0.195613294839859 and type_loss 2.8112268447875977






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.496523380279541 with time_loss: -4.199947357177734 and type_loss 2.7034239768981934
Test loss: 3.228740692138672 with time_loss: 0.40184304118156433 and type_loss 2.826897621154785






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4834225177764893 with time_loss: -4.189891338348389 and type_loss 2.7064688205718994
Test loss: 3.1227965354919434 with time_loss: 0.3276839256286621 and type_loss 2.7951126098632812





  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:09<00:04, 10.04it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.9679267406463623 with time_loss: 0.17816098034381866 and type_loss 2.7897658348083496






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.518319845199585 with time_loss: -4.220945358276367 and type_loss 2.7026255130767822
Test loss: 2.3989057540893555 with time_loss: -0.4117041826248169 and type_loss 2.810609817504883





  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:09<00:04,  9.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.369304656982422 with time_loss: 0.5497679114341736 and type_loss 2.8195366859436035





  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:09<00:04,  9.75it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.494778871536255 with time_loss: 0.6558883786201477 and type_loss 2.838890552520752





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5425212383270264 with time_loss: -4.241114139556885 and type_loss 2.6985929012298584
Test loss: 3.0282697677612305 with time_loss: 0.23290684819221497 and type_loss 2.795362949371338





  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:09<00:05,  9.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.310452938079834 with time_loss: 0.5040225386619568 and type_loss 2.8064303398132324





  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:09<00:04,  9.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.1134021282196045 with time_loss: 0.3053540587425232 and type_loss 2.8080480098724365







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5320634841918945 with time_loss: -4.227352619171143 and type_loss 2.695289134979248
Test loss: 3.149670124053955 with time_loss: 0.3564966917037964 and type_loss 2.793173313140869

