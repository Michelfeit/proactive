
  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')


  - (Training)   :  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                         | 85/121 [00:05<00:01, 19.80it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 0.3983025550842285 with time_loss: -2.4124014377593994 and type_loss 2.810703992843628




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.053698062896728516 with time_loss: -2.5667147636413574 and type_loss 2.513016700744629
New best found!



  - (Training)   :  62%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                         | 75/121 [00:05<00:02, 16.52it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6479535102844238 with time_loss: -1.9823925495147705 and type_loss 2.6303460597991943



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.17it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.1969890594482422 with time_loss: -2.6283297538757324 and type_loss 2.4313406944274902
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:15,  3.13s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5373246669769287 with time_loss: -2.6400985717773438 and type_loss 2.102773904800415
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.9402220249176025 with time_loss: -2.97422194480896 and type_loss 2.0339999198913574
New best found!


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8453474044799805 with time_loss: -3.0668418407440186 and type_loss 2.221494436264038
Test loss: -0.41674041748046875 with time_loss: -2.7178986072540283 and type_loss 2.3011581897735596


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:08,  3.07s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.852266788482666 with time_loss: -2.9353554248809814 and type_loss 2.0830886363983154


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.05s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8509349822998047 with time_loss: -1.1964921951293945 and type_loss 2.047427177429199


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.037203311920166 with time_loss: -1.4520039558410645 and type_loss 2.4892072677612305



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:05<00:01, 20.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0357763767242432 with time_loss: -1.339674472808838 and type_loss 2.375450849533081


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:08,  3.07s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6718077659606934 with time_loss: -1.6003608703613281 and type_loss 2.2721686363220215



  - (Training)   :  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 84/121 [00:05<00:01, 20.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:37,  3.15s/it]
Test loss: -0.4228096008300781 with time_loss: -2.5187911987304688 and type_loss 2.0959815979003906



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.50it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.04263937473297119 with time_loss: -1.9504948854446411 and type_loss 1.9931342601776123


  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:05<00:01, 20.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: 0.630868673324585 with time_loss: -1.363495945930481 and type_loss 1.994364619255066



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3491322994232178 with time_loss: -3.3578805923461914 and type_loss 2.0087482929229736
Test loss: 0.4298882484436035 with time_loss: -1.5319854021072388 and type_loss 1.9618736505508423


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:12,  3.10s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.549846887588501 with time_loss: -1.272875189781189 and type_loss 1.82272207736969


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:12,  3.10s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5855886936187744 with time_loss: -1.3121031522750854 and type_loss 1.8976918458938599


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:09,  3.08s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4490818977355957 with time_loss: -2.258307695388794 and type_loss 1.8092257976531982



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:05<00:01, 20.33it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 0.19629251956939697 with time_loss: -1.598235011100769 and type_loss 1.794527530670166



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.47it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.2630727291107178 with time_loss: -1.4459484815597534 and type_loss 1.7090212106704712



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5832535028457642 with time_loss: -2.2728404998779297 and type_loss 1.6895869970321655



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 18.05it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.11729955673217773 with time_loss: -1.6236218214035034 and type_loss 1.7409213781356812




  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.05it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.06s/it]
Test loss: -0.045447707176208496 with time_loss: -1.7524428367614746 and type_loss 1.7069951295852661



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.29it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.3500380516052246 with time_loss: -1.30805242061615 and type_loss 1.6580904722213745


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.9810112714767456 with time_loss: -3.6886093616485596 and type_loss 1.707598090171814
Test loss: -0.22752737998962402 with time_loss: -1.8939471244812012 and type_loss 1.6664197444915771


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:07,  3.06s/it]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.30801188945770264 with time_loss: -1.3436483144760132 and type_loss 1.6516602039337158


  - (Training)   :  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 81/121 [00:05<00:02, 19.41it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.1510981321334839 with time_loss: -1.4824531078338623 and type_loss 1.6335512399673462


  - (Training)   :  67%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 81/121 [00:05<00:02, 19.50it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.11453819274902344 with time_loss: -1.5437055826187134 and type_loss 1.6582437753677368


  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:05<00:02, 19.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.07s/it]
Test loss: 0.041492581367492676 with time_loss: -1.549719214439392 and type_loss 1.5912117958068848



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:05<00:02, 19.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.08s/it]
Test loss: -0.241083025932312 with time_loss: -1.8378491401672363 and type_loss 1.5967661142349243



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:05<00:02, 18.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.05452084541320801 with time_loss: -1.5054669380187988 and type_loss 1.5599877834320068



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.04329502582550049 with time_loss: -1.5642368793487549 and type_loss 1.6075319051742554



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.13it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.03899669647216797 with time_loss: -1.6125688552856445 and type_loss 1.5735721588134766



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.02it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.05605316162109375 with time_loss: -1.513124942779541 and type_loss 1.5691781044006348



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.14463627338409424 with time_loss: -1.4065686464309692 and type_loss 1.5512049198150635



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.3104238510131836 with time_loss: -3.8757879734039307 and type_loss 1.5653642416000366
Test loss: 0.04408466815948486 with time_loss: -1.506794810295105 and type_loss 1.5508794784545898


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:10,  3.08s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.08713734149932861 with time_loss: -1.474351406097412 and type_loss 1.5614887475967407



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.35036301612854 with time_loss: -3.9012084007263184 and type_loss 1.5508453845977783
Test loss: -0.024851322174072266 with time_loss: -1.565002679824829 and type_loss 1.5401513576507568



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.366110324859619 with time_loss: -3.9161434173583984 and type_loss 1.5500330924987793
Test loss: 0.06862139701843262 with time_loss: -1.4669642448425293 and type_loss 1.535585641860962


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:07,  3.06s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.05641031265258789 with time_loss: -1.5754930973052979 and type_loss 1.51908278465271


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:08,  3.07s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.007555127143859863 with time_loss: -1.5301049947738647 and type_loss 1.5225498676300049


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:14,  3.12s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.017544150352478027 with time_loss: -1.5329391956329346 and type_loss 1.5153950452804565



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.09it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: -0.06501388549804688 with time_loss: -1.567662239074707 and type_loss 1.5026483535766602



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -0.015848398208618164 with time_loss: -1.5240042209625244 and type_loss 1.5081558227539062



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: -0.07230234146118164 with time_loss: -1.5707241296768188 and type_loss 1.4984217882156372



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.09it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.022620320320129395 with time_loss: -1.483762264251709 and type_loss 1.5063825845718384



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 0.3044222593307495 with time_loss: -1.206445336341858 and type_loss 1.5108675956726074



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:05<00:01, 20.85it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.42075860500335693 with time_loss: -1.084907054901123 and type_loss 1.50566565990448


  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:05<00:01, 19.77it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.5114616751670837 with time_loss: -0.98105388879776 and type_loss 1.4925155639648438

