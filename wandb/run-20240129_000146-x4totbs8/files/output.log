Training flows transformer...
{'activation': 'softplus', 'batch_size': 4, 'd_k': 64, 'd_rnn': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'smooth': 0}
Loading All Datasets...
45 9
d_model: 512
d_inner 2048
d_k 64
d_k 64
hawkes False
WITH RNN
[ Epoch 1 ]


  - (Training)   :  51%|███████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                      | 62/121 [00:05<00:03, 14.81it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.21879, MAE:  0.54428, GPA:  0.03158
Best ACC:  0.21879, MAE:  0.54428, GPA:  0.03158
improvement in epoch 1



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:05<00:04, 14.54it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.38610, MAE:  0.52708, GPA:  0.14737
Best ACC:  0.38610, MAE:  0.52708, GPA:  0.14737
improvement in epoch 2



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.78it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.44788, MAE:  0.52378, GPA:  0.22105
Best ACC:  0.44788, MAE:  0.52378, GPA:  0.22105
improvement in epoch 3



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.73it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.48777, MAE:  0.51046, GPA:  0.15789
Best ACC:  0.48777, MAE:  0.51046, GPA:  0.22105
improvement in epoch 4



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:05<00:04, 14.04it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.56242, MAE:  0.52058, GPA:  0.29474
Best ACC:  0.56242, MAE:  0.51046, GPA:  0.29474
improvement in epoch 5



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.22it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.55470, MAE:  0.51176, GPA:  0.29474
Best ACC:  0.56242, MAE:  0.51046, GPA:  0.29474
improvement in epoch 6



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.26it/s]


  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.53925, MAE:  0.52706, GPA:  0.29474
Best ACC:  0.56242, MAE:  0.51046, GPA:  0.29474
improvement in epoch 7



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.26it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
(Testing) Acc:  0.57272, MAE:  0.52575, GPA:  0.29474
Best ACC:  0.57272, MAE:  0.51046, GPA:  0.29474
improvement in epoch 8



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.18it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.58172, MAE:  0.52116, GPA:  0.29474
Best ACC:  0.58172, MAE:  0.51046, GPA:  0.29474
improvement in epoch 9



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                | 56/121 [00:04<00:04, 13.71it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.59202, MAE:  0.48568, GPA:  0.30526
Best ACC:  0.59202, MAE:  0.48568, GPA:  0.30526
improvement in epoch 10


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.20it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.59331, MAE:  0.53090, GPA:  0.31579
Best ACC:  0.59331, MAE:  0.48568, GPA:  0.31579
improvement in epoch 11




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.60992, MAE:  0.45954, Itv. GPA:  0.77946
(Testing) Acc:  0.60618, MAE:  0.50440, GPA:  0.30526
Best ACC:  0.60618, MAE:  0.48568, GPA:  0.31579
improvement in epoch 12



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.43it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
(Testing) Acc:  0.61776, MAE:  0.50457, GPA:  0.31579
Best ACC:  0.61776, MAE:  0.48568, GPA:  0.31579
improvement in epoch 13



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.41it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62677, MAE:  0.48726, GPA:  0.31579
Best ACC:  0.62677, MAE:  0.48568, GPA:  0.31579
improvement in epoch 14



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                              | 57/121 [00:04<00:04, 13.83it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.61390, MAE:  0.48432, GPA:  0.31579
Best ACC:  0.62677, MAE:  0.48432, GPA:  0.31579
improvement in epoch 15



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.45it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62291, MAE:  0.55947, GPA:  0.30526
Best ACC:  0.62677, MAE:  0.48432, GPA:  0.31579




  - (Training)   :  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████       | 117/121 [00:07<00:00, 20.25it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62934, MAE:  0.49908, GPA:  0.31579
Best ACC:  0.62934, MAE:  0.48432, GPA:  0.31579
improvement in epoch 17



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.72it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.61519, MAE:  0.50028, GPA:  0.30526
Best ACC:  0.62934, MAE:  0.48432, GPA:  0.31579
improvement in epoch 18



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.60it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63320, MAE:  0.52962, GPA:  0.30526
Best ACC:  0.63320, MAE:  0.48432, GPA:  0.31579




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 116/121 [00:06<00:00, 20.14it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.62420, MAE:  0.50068, GPA:  0.31579
Best ACC:  0.63320, MAE:  0.48432, GPA:  0.31579
improvement in epoch 20



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.87it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.63707, MAE:  0.51371, GPA:  0.31579
Best ACC:  0.63707, MAE:  0.48432, GPA:  0.31579
improvement in epoch 21



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.58it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64350, MAE:  0.51834, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.48432, GPA:  0.31579
improvement in epoch 22



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.59it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.64093, MAE:  0.50379, GPA:  0.31579
Best ACC:  0.64350, MAE:  0.48432, GPA:  0.31579
improvement in epoch 23



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.57it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64994, MAE:  0.51982, GPA:  0.31579
Best ACC:  0.64994, MAE:  0.48432, GPA:  0.31579



  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 116/121 [00:07<00:00, 20.04it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.63964, MAE:  0.49645, GPA:  0.31579
Best ACC:  0.64994, MAE:  0.48432, GPA:  0.31579
improvement in epoch 25


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.63it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
(Testing) Acc:  0.64479, MAE:  0.50120, GPA:  0.31579
Best ACC:  0.64994, MAE:  0.48432, GPA:  0.31579
improvement in epoch 26



  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:05<00:04, 14.71it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.63964, MAE:  0.50047, GPA:  0.31579
Best ACC:  0.64994, MAE:  0.48432, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.64994, MAE:  0.48286, GPA:  0.30526
Best ACC:  0.64994, MAE:  0.48286, GPA:  0.31579
improvement in epoch 28


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.25it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.65251, MAE:  0.47908, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.47908, GPA:  0.31579
improvement in epoch 29




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.66866, MAE:  0.44692, Itv. GPA:  0.80619
(Testing) Acc:  0.65251, MAE:  0.49716, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.47908, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.45it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64479, MAE:  0.50411, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.47908, GPA:  0.31579




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.67851, MAE:  0.44307, Itv. GPA:  0.81006
(Testing) Acc:  0.64221, MAE:  0.45585, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.45585, GPA:  0.31579
improvement in epoch 32



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.42it/s]


(Testing) Acc:  0.64736, MAE:  0.47622, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.45585, GPA:  0.31579
[ Epoch 34 ]


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.36it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64736, MAE:  0.49052, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.45585, GPA:  0.31579




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.67851, MAE:  0.43004, Itv. GPA:  0.80900
(Testing) Acc:  0.64994, MAE:  0.47126, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.45585, GPA:  0.31579



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.61it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
(Testing) Acc:  0.65122, MAE:  0.49197, GPA:  0.31579
Best ACC:  0.65251, MAE:  0.45585, GPA:  0.31579



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.59it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.65508, MAE:  0.49472, GPA:  0.31579
Best ACC:  0.65508, MAE:  0.45585, GPA:  0.31579



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.41it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
(Testing) Acc:  0.65637, MAE:  0.54437, GPA:  0.31579
Best ACC:  0.65637, MAE:  0.45585, GPA:  0.31579



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.25it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.66023, MAE:  0.48993, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 115/121 [00:07<00:00, 20.05it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.64994, MAE:  0.48743, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579
improvement in epoch 40


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                            | 58/121 [00:04<00:04, 14.22it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.65380, MAE:  0.47740, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579
improvement in epoch 41




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.68695, MAE:  0.41841, Itv. GPA:  0.81639
(Testing) Acc:  0.64994, MAE:  0.47644, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579
improvement in epoch 42




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 118/121 [00:06<00:00, 20.56it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.65380, MAE:  0.47713, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                           | 59/121 [00:04<00:04, 14.43it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.65508, MAE:  0.47685, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋          | 115/121 [00:07<00:00, 19.96it/s]

  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Testing) Acc:  0.64994, MAE:  0.48069, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.63it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
(Testing) Acc:  0.64865, MAE:  0.49347, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.69434, MAE:  0.41119, Itv. GPA:  0.81076
(Testing) Acc:  0.65637, MAE:  0.47570, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579
improvement in epoch 47



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                         | 60/121 [00:04<00:04, 14.70it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
(Testing) Acc:  0.65380, MAE:  0.48666, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579


  - (Training)   :  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                       | 61/121 [00:04<00:04, 14.83it/s]


  - (Validation) :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
(Testing) Acc:  0.65637, MAE:  0.47591, GPA:  0.31579
Best ACC:  0.66023, MAE:  0.45585, GPA:  0.31579
improvement in epoch 49




  - (Validation) :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
(Training) Acc:  0.69363, MAE:  0.43547, Itv. GPA:  0.81217
(Testing) Acc:  0.65251, MAE:  0.51550, GPA:  0.31579

