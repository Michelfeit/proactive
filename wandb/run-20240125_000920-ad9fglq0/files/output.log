Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 18.93it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.381932258605957 with time_loss: -2.261512517929077 and type_loss 3.643444776535034



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3585261106491089 with time_loss: -1.819210410118103 and type_loss 3.177736520767212




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:07<00:00, 19.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.04273247718811035 with time_loss: -3.1099579334259033 and type_loss 3.067225456237793
New best found!



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.9858297109603882 with time_loss: -1.0560132265090942 and type_loss 3.0418429374694824



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.5776691436767578 with time_loss: -2.4177184104919434 and type_loss 2.995387554168701




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.16640639305114746 with time_loss: -3.123969793319702 and type_loss 2.9575634002685547
Test loss: 1.733366847038269 with time_loss: -1.1939564943313599 and type_loss 2.927323341369629



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.1312170028686523 with time_loss: -0.8285700082778931 and type_loss 2.959786891937256





Train loss: 0.01857614517211914 with time_loss: -2.945580005645752 and type_loss 2.964156150817871
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.23984050750732422 with time_loss: -2.6442794799804688 and type_loss 2.884119987487793



  - (Training)   :  43%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 52/121 [00:05<00:05, 12.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.6108386516571045 with time_loss: -1.3365516662597656 and type_loss 2.94739031791687



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 1.4802721738815308 with time_loss: -1.4834564924240112 and type_loss 2.963728666305542



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9429831504821777 with time_loss: -1.9233157634735107 and type_loss 2.8662989139556885



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.7657849788665771 with time_loss: -3.5888078212738037 and type_loss 2.8230228424072266
New best found!



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.40it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.17624711990356445 with time_loss: -2.655402183532715 and type_loss 2.8316493034362793



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.010668516159057617 with time_loss: -2.8531041145324707 and type_loss 2.842435598373413



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0129578113555908 with time_loss: -1.8263747692108154 and type_loss 2.8393325805664062



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.9042277336120605 with time_loss: -0.9304576516151428 and type_loss 2.8346853256225586




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8592877388000488 with time_loss: -3.664757251739502 and type_loss 2.805469512939453
Test loss: -0.13189220428466797 with time_loss: -2.939173460006714 and type_loss 2.807281255722046



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.015399694442749 with time_loss: -1.8715322017669678 and type_loss 2.886931896209717




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8104884624481201 with time_loss: -3.6168665885925293 and type_loss 2.806378126144409
Test loss: -0.2784290313720703 with time_loss: -3.1117866039276123 and type_loss 2.833357572555542




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8990777730941772 with time_loss: -0.9459275007247925 and type_loss 2.8450052738189697



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.64it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.9621438980102539 with time_loss: -1.8844892978668213 and type_loss 2.846633195877075



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.6937017440795898 with time_loss: -1.099100112915039 and type_loss 2.792801856994629



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 2.764998197555542 with time_loss: -0.05727720260620117 and type_loss 2.822275400161743



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.1583092212677 with time_loss: 0.3365817070007324 and type_loss 2.8217275142669678



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.622748374938965 with time_loss: 0.7779306173324585 and type_loss 2.844817638397217



  - (Training)   :  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 119/121 [00:07<00:00, 20.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.608928680419922 with time_loss: -0.19486308097839355 and type_loss 2.8037917613983154




  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.4612505435943604 with time_loss: -0.4018568694591522 and type_loss 2.863107442855835



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.7285114526748657 with time_loss: -1.0593560934066772 and type_loss 2.787867546081543



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:04<00:04, 14.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.674548625946045 with time_loss: 0.8768159747123718 and type_loss 2.7977325916290283




  - (Training)   :  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 120/121 [00:07<00:00, 20.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.497620105743408 with time_loss: 0.653702974319458 and type_loss 2.84391713142395



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.6545003652572632 with time_loss: -1.1507309675216675 and type_loss 2.8052313327789307




  - (Training)   :  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 117/121 [00:07<00:00, 20.00it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.571034550666809 with time_loss: -1.2080107927322388 and type_loss 2.779045343399048


  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.6827964782714844 with time_loss: -1.1123754978179932 and type_loss 2.7951719760894775



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.6591272354125977 with time_loss: 0.8782328963279724 and type_loss 2.7808942794799805



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.333873748779297 with time_loss: 0.5624995231628418 and type_loss 2.771374225616455



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 2.849961519241333 with time_loss: 0.07463537901639938 and type_loss 2.7753262519836426



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.36551570892334 with time_loss: 0.554327666759491 and type_loss 2.811187982559204



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.494640827178955 with time_loss: -1.2890279293060303 and type_loss 2.7836687564849854




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3573601245880127 with time_loss: -4.07307243347168 and type_loss 2.715712308883667
Test loss: 2.9154858589172363 with time_loss: 0.12804676592350006 and type_loss 2.7874391078948975



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 2.8566606044769287 with time_loss: 0.06268884986639023 and type_loss 2.7939717769622803



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.68761944770813 with time_loss: 0.9059162139892578 and type_loss 2.781703233718872



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.562380790710449 with time_loss: 0.7880302667617798 and type_loss 2.774350643157959




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.497586727142334 with time_loss: -4.187532424926758 and type_loss 2.689945697784424
Test loss: 3.4628634452819824 with time_loss: 0.6720799207687378 and type_loss 2.790783405303955



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.60it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.7813222408294678 with time_loss: -0.016199052333831787 and type_loss 2.7975213527679443





Train loss: -1.5291261672973633 with time_loss: -4.2245097160339355 and type_loss 2.6953835487365723
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.3140711784362793 with time_loss: 0.5122382640838623 and type_loss 2.801832914352417



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.2369768619537354 with time_loss: 0.45592841506004333 and type_loss 2.781048536300659




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:07<00:00, 20.00it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.6757757663726807 with time_loss: 0.865435779094696 and type_loss 2.81033992767334


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.684591770172119 with time_loss: 0.8964102268218994 and type_loss 2.7881815433502197



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.310389757156372 with time_loss: 0.5423877835273743 and type_loss 2.7680020332336426



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.87it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.343114137649536 with time_loss: 0.5672400593757629 and type_loss 2.775874137878418

