Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'd_model': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 16, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.7883273363113403 with time_loss: -3.311368942260742 and type_loss 1.5230416059494019
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.091464042663574 with time_loss: -3.4571962356567383 and type_loss 1.3657323122024536
New best found!



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.2521631717681885 with time_loss: -3.5757946968078613 and type_loss 1.3236315250396729
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.7863280773162842 with time_loss: -3.0641632080078125 and type_loss 1.2778351306915283



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.193146228790283 with time_loss: -3.4423587322235107 and type_loss 1.2492125034332275



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.95it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.294501781463623 with time_loss: -3.4633336067199707 and type_loss 1.168831706047058
New best found!



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.78it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.6617692708969116 with time_loss: -2.8723673820495605 and type_loss 1.210598111152649



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.97s/it]
Test loss: -2.496483325958252 with time_loss: -3.6646475791931152 and type_loss 1.1681642532348633
New best found!



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:05<00:02, 18.66it/s]


Test loss: -2.43599796295166 with time_loss: -3.6399130821228027 and type_loss 1.2039151191711426
[ Epoch 9 ]


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.713773250579834 with time_loss: -3.8987252712249756 and type_loss 1.184951901435852
New best found!



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.9556790590286255 with time_loss: -3.0582592487335205 and type_loss 1.102580189704895



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.112889051437378 with time_loss: -3.19777774810791 and type_loss 1.0848886966705322



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.153700351715088 with time_loss: -3.2454724311828613 and type_loss 1.0917720794677734



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: -2.2169952392578125 with time_loss: -3.325251340866089 and type_loss 1.108256220817566



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:04<00:02, 17.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.8810362815856934 with time_loss: -2.9864745140075684 and type_loss 1.105438232421875



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.44868803024292 with time_loss: -3.520394802093506 and type_loss 1.0717066526412964



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.47it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.4171113967895508 with time_loss: -2.482743263244629 and type_loss 1.0656318664550781



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.7680566310882568 with time_loss: -2.8181915283203125 and type_loss 1.0501348972320557



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.57it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.3693556785583496 with time_loss: -3.4538886547088623 and type_loss 1.0845330953598022



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -2.2531449794769287 with time_loss: -3.355231761932373 and type_loss 1.1020867824554443



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.5906848907470703 with time_loss: -3.6198015213012695 and type_loss 1.0291166305541992



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.55it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.112782597541809 with time_loss: -2.140192747116089 and type_loss 1.0274101495742798



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.74it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.7817312479019165 with time_loss: -2.814743995666504 and type_loss 1.0330127477645874


  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.242926001548767 with time_loss: -2.2695071697235107 and type_loss 1.0265811681747437


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.40934157371521 with time_loss: -3.4554622173309326 and type_loss 1.0461206436157227



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.475362777709961 with time_loss: -3.5285263061523438 and type_loss 1.0531636476516724



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7499642372131348 with time_loss: -3.7806458473205566 and type_loss 1.0306814908981323
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1177425384521484 with time_loss: -3.1780784130096436 and type_loss 1.0603357553482056



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.9643313884735107 with time_loss: -4.883013725280762 and type_loss 0.9186822772026062
Test loss: -2.187143325805664 with time_loss: -3.225259780883789 and type_loss 1.0381165742874146



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.76it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.164879322052002 with time_loss: -3.2049806118011475 and type_loss 1.040101170539856


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.219740867614746 with time_loss: -3.24711275100708 and type_loss 1.0273717641830444


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9231786727905273 with time_loss: -1.9505934715270996 and type_loss 1.0274147987365723



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.80it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6994467973709106 with time_loss: -2.7259864807128906 and type_loss 1.02653968334198


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.175806045532227 with time_loss: -5.058295726776123 and type_loss 0.8824894428253174
Test loss: -2.1932790279388428 with time_loss: -3.2140257358551025 and type_loss 1.0207467079162598



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.225494861602783 with time_loss: -5.098076820373535 and type_loss 0.8725821375846863
Test loss: -1.017561912536621 with time_loss: -2.0407488346099854 and type_loss 1.0231869220733643


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8907251358032227 with time_loss: -2.9144113063812256 and type_loss 1.023686170578003



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.242503643035889 with time_loss: -5.118202209472656 and type_loss 0.875698447227478
Test loss: -1.7176121473312378 with time_loss: -2.738553047180176 and type_loss 1.020940899848938



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.251597881317139 with time_loss: -5.114948272705078 and type_loss 0.8633503913879395
Test loss: -1.2082935571670532 with time_loss: -2.228107452392578 and type_loss 1.019813895225525



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.74it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.885709762573242 with time_loss: -3.9126739501953125 and type_loss 1.0269641876220703
New best found!


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.52it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6910706758499146 with time_loss: -2.721041679382324 and type_loss 1.0299710035324097


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.69it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.3321682214736938 with time_loss: -2.3475162982940674 and type_loss 1.0153480768203735


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.41it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.988168716430664 with time_loss: -3.0072216987609863 and type_loss 1.0190529823303223


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.47it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.124135971069336 with time_loss: -3.1497700214385986 and type_loss 1.0256341695785522


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.402001857757568 with time_loss: -5.247699737548828 and type_loss 0.8456977009773254
Test loss: -1.3683676719665527 with time_loss: -2.392019271850586 and type_loss 1.0236515998840332



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:05<00:02, 18.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.657633662223816 with time_loss: -2.682474374771118 and type_loss 1.0248407125473022



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.417834281921387 with time_loss: -5.272740364074707 and type_loss 0.8549062609672546
Test loss: -1.525846004486084 with time_loss: -2.549161434173584 and type_loss 1.0233154296875



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.467617511749268 with time_loss: -5.320388317108154 and type_loss 0.8527708649635315
Test loss: -0.8132162094116211 with time_loss: -1.8388211727142334 and type_loss 1.0256049633026123



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2983285188674927 with time_loss: -2.32262921333313 and type_loss 1.0243006944656372



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.44it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.358475923538208 with time_loss: -2.382093667984009 and type_loss 1.0236177444458008


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.82it/s]


Test loss: -2.8452229499816895 with time_loss: -3.8741350173950195 and type_loss 1.0289121866226196
Best loss is: tensor(-2.8857, device='cuda:0')