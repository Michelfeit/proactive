Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 5, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.49it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.7178592681884766 with time_loss: -2.610311985015869 and type_loss 3.3281712532043457


  - (Training)   :  43%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 52/121 [00:05<00:05, 12.38it/s]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.3092055320739746 with time_loss: -2.8446125984191895 and type_loss 3.153818130493164


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.14it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.6715304851531982 with time_loss: -2.30387020111084 and type_loss 2.975400686264038


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:05<00:03, 15.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.23705649375915527 with time_loss: -3.0696399211883545 and type_loss 2.832583427429199
New best found!


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.14466524124145508 with time_loss: -2.9615695476531982 and type_loss 2.816904306411743



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.0116065740585327 with time_loss: -1.7368947267532349 and type_loss 2.7485013008117676



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8435752391815186 with time_loss: -2.0899839401245117 and type_loss 2.9335591793060303




Train loss: -0.23261785507202148 with time_loss: -3.1810553073883057 and type_loss 2.948437452316284

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.010304689407348633 with time_loss: -2.9284462928771973 and type_loss 2.938750982284546



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 16.14it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -0.27474498748779297 with time_loss: -3.34952974319458 and type_loss 3.074784755706787
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.14it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2438521385192871 with time_loss: -2.718979835510254 and type_loss 2.962831974029541



  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.5100202560424805 with time_loss: -2.3682186603546143 and type_loss 2.8782389163970947




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3967249393463135 with time_loss: -2.4608500003814697 and type_loss 2.857574939727783



  - (Training)   :  39%|██████████████████████████████████████████████████████████████████████████▌                                                                                                                     | 47/121 [00:05<00:06, 11.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8350546360015869 with time_loss: -2.0513455867767334 and type_loss 2.8864002227783203



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 11.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.16772127151489258 with time_loss: -2.729731559753418 and type_loss 2.8974528312683105




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.7399072647094727 with time_loss: -2.1456377506256104 and type_loss 2.885545015335083




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8098652362823486 with time_loss: -3.635817766189575 and type_loss 2.8259525299072266
Test loss: 1.3141703605651855 with time_loss: -1.5287206172943115 and type_loss 2.842890977859497



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.357226014137268 with time_loss: -1.4782172441482544 and type_loss 2.8354432582855225




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.40378618240356445 with time_loss: -2.5369091033935547 and type_loss 2.940695285797119




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.52it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.4618861675262451 with time_loss: -2.3754639625549316 and type_loss 2.8373501300811768





  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.57it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2537837028503418 with time_loss: -2.5630109310150146 and type_loss 2.8167946338653564



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1645876169204712 with time_loss: -1.6437760591506958 and type_loss 2.808363676071167




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 2.493417978286743 with time_loss: -0.34561818838119507 and type_loss 2.839036226272583




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.928853988647461 with time_loss: 1.0758497714996338 and type_loss 2.853004217147827




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.140192985534668 with time_loss: -3.9039063453674316 and type_loss 2.7637133598327637
Test loss: 2.5626449584960938 with time_loss: -0.25626763701438904 and type_loss 2.8189125061035156



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.256130337715149 with time_loss: -1.5270432233810425 and type_loss 2.7831735610961914




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.060873508453369 with time_loss: -0.8247925043106079 and type_loss 2.8856661319732666




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.511276960372925 with time_loss: -0.2849538326263428 and type_loss 2.7962307929992676




  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:07<00:01, 17.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.38407826423645 with time_loss: 0.589640200138092 and type_loss 2.794438123703003



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.9323594570159912 with time_loss: -0.8923583030700684 and type_loss 2.8247177600860596



  - (Training)   :  39%|██████████████████████████████████████████████████████████████████████████▌                                                                                                                     | 47/121 [00:05<00:06, 11.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 5.295102119445801 with time_loss: 2.507111072540283 and type_loss 2.7879912853240967




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 2.9525387287139893 with time_loss: 0.14877158403396606 and type_loss 2.803767204284668




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.572524070739746 with time_loss: 0.7780868411064148 and type_loss 2.7944371700286865



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.4151763916015625 with time_loss: 0.5766445398330688 and type_loss 2.838531732559204



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.1487228870391846 with time_loss: -0.6647505164146423 and type_loss 2.8134734630584717




  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:07<00:01, 17.84it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.0523924827575684 with time_loss: 0.23899663984775543 and type_loss 2.8133957386016846



  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.236630439758301 with time_loss: -0.5611042380332947 and type_loss 2.7977347373962402



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 10.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.648648977279663 with time_loss: -0.14368802309036255 and type_loss 2.792336940765381



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.6628618240356445 with time_loss: -0.15364481508731842 and type_loss 2.8165066242218018




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.53it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.68084716796875 with time_loss: -0.12590785324573517 and type_loss 2.8067550659179688



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3947927951812744 with time_loss: -4.123998165130615 and type_loss 2.729205369949341
Test loss: 1.7479991912841797 with time_loss: -1.0452332496643066 and type_loss 2.7932324409484863



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.2616584300994873 with time_loss: 0.4413323402404785 and type_loss 2.820326089859009



  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.1188158988952637 with time_loss: 0.3072368800640106 and type_loss 2.8115789890289307




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.9361448287963867 with time_loss: 0.1369989663362503 and type_loss 2.7991459369659424




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5294017791748047 with time_loss: -4.2287678718566895 and type_loss 2.6993660926818848
Test loss: 3.19301438331604 with time_loss: 0.371165007352829 and type_loss 2.8218493461608887



  - (Training)   :  38%|████████████████████████████████████████████████████████████████████████▉                                                                                                                       | 46/121 [00:05<00:06, 11.02it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.5222411155700684 with time_loss: 0.7400205731391907 and type_loss 2.7822206020355225




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 17.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.4638547897338867 with time_loss: -0.3241082429885864 and type_loss 2.7879629135131836




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.61it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.9279212951660156 with time_loss: 1.1493401527404785 and type_loss 2.778581142425537



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5422706604003906 with time_loss: -4.237049579620361 and type_loss 2.6947789192199707
Test loss: 3.1414849758148193 with time_loss: 0.3469357192516327 and type_loss 2.7945492267608643



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.830662727355957 with time_loss: 0.03178095817565918 and type_loss 2.798881769180298




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 17.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 2.8093864917755127 with time_loss: 0.015813061967492104 and type_loss 2.7935733795166016

