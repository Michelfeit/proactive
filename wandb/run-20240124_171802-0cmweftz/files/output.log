Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 6, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.9431746006011963 with time_loss: -2.2040677070617676 and type_loss 3.147242307662964



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.5972871780395508 with time_loss: -3.501755952835083 and type_loss 2.9044687747955322
New best found!


  - (Training)   :  45%|████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                         | 55/121 [00:05<00:05, 12.71it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:40,  3.24s/it]
Test loss: -0.15538930892944336 with time_loss: -3.037386417388916 and type_loss 2.8819971084594727





Train loss: -0.2779688835144043 with time_loss: -3.174036979675293 and type_loss 2.8960680961608887

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.4298522472381592 with time_loss: -2.6150479316711426 and type_loss 3.0449001789093018



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.603480339050293 with time_loss: -2.373964786529541 and type_loss 2.977445125579834


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                 | 60/121 [00:05<00:04, 14.09it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:37,  3.15s/it]
Test loss: -0.10240459442138672 with time_loss: -3.054739475250244 and type_loss 2.9523348808288574




  - (Training)   :  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 111/121 [00:07<00:00, 18.97it/s]


  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.2537093162536621 with time_loss: -3.1559581756591797 and type_loss 2.9022488594055176



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.13943719863891602 with time_loss: -3.028959274291992 and type_loss 2.889522075653076



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]
Train loss: -0.3415367603302002 with time_loss: -3.2503042221069336 and type_loss 2.9087674617767334
Test loss: -0.0455014705657959 with time_loss: -2.9172234535217285 and type_loss 2.8717219829559326




  - (Training)   :  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:07<00:00, 19.64it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:37,  3.15s/it]
Test loss: -0.3722372055053711 with time_loss: -3.275761842727661 and type_loss 2.90352463722229




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.569052815437317 with time_loss: -1.2625030279159546 and type_loss 2.8315558433532715



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.33501696586608887 with time_loss: -3.188671588897705 and type_loss 2.853654623031616



  - (Training)   :  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                | 111/121 [00:07<00:00, 19.05it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.5447509288787842 with time_loss: -2.3233885765075684 and type_loss 2.8681395053863525




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.30435848236083984 with time_loss: -3.170442581176758 and type_loss 2.866084098815918



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]
Train loss: -0.900609016418457 with time_loss: -3.6990156173706055 and type_loss 2.7984066009521484
Test loss: 0.5352518558502197 with time_loss: -2.2629027366638184 and type_loss 2.798154592514038



  - (Training)   :  43%|███████████████████████████████████████████████████████████████████████████████████▎                                                                                                              | 52/121 [00:05<00:05, 12.49it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.4094812870025635 with time_loss: -3.214554786682129 and type_loss 2.8050734996795654




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.21203136444091797 with time_loss: -3.121539831161499 and type_loss 2.909508466720581



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.5936775207519531 with time_loss: -3.4295051097869873 and type_loss 2.835827589035034



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.19076037406921387 with time_loss: -3.1022469997406006 and type_loss 2.9114866256713867



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.52718186378479 with time_loss: -2.3159525394439697 and type_loss 2.8431344032287598



  - (Training)   :  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋              | 112/121 [00:07<00:00, 19.15it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.3868296146392822 with time_loss: -2.405578851699829 and type_loss 2.7924084663391113




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.09322762489318848 with time_loss: -2.8952906131744385 and type_loss 2.80206298828125



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]
Train loss: -1.1783251762390137 with time_loss: -3.9366302490234375 and type_loss 2.758305072784424
Test loss: 0.06684732437133789 with time_loss: -2.7270774841308594 and type_loss 2.7939248085021973




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.1121408939361572 with time_loss: -1.6977119445800781 and type_loss 2.8098528385162354



  - (Training)   :  89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 108/121 [00:07<00:00, 18.23it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.2788419723510742 with time_loss: -3.104222297668457 and type_loss 2.825380325317383




  - (Training)   :  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 109/121 [00:07<00:00, 17.83it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:38,  3.18s/it]
Test loss: -0.5549206733703613 with time_loss: -3.3390002250671387 and type_loss 2.7840795516967773



  - (Training)   :  46%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                        | 56/121 [00:05<00:04, 13.27it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:36,  3.10s/it]
Test loss: 0.17978405952453613 with time_loss: -2.6251754760742188 and type_loss 2.804959535598755





  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -1.0157415866851807 with time_loss: -3.7990236282348633 and type_loss 2.7832820415496826
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.3950459957122803 with time_loss: -1.4265868663787842 and type_loss 2.8216328620910645


  - (Training)   :  49%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                   | 59/121 [00:05<00:04, 13.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]
Test loss: -0.2351226806640625 with time_loss: -3.043008327484131 and type_loss 2.8078856468200684



  - (Training)   :  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍         | 115/121 [00:07<00:00, 19.87it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:42,  3.31s/it]
Test loss: 0.36066222190856934 with time_loss: -2.4140806198120117 and type_loss 2.774742841720581




  - (Training)   :  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                   | 109/121 [00:07<00:00, 18.35it/s]


  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.2241983413696289 with time_loss: -2.9911582469940186 and type_loss 2.7669599056243896



  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                | 101/121 [00:07<00:01, 16.98it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:35,  3.08s/it]
Test loss: -0.6551182270050049 with time_loss: -3.4300827980041504 and type_loss 2.7749645709991455




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.5757405757904053 with time_loss: -2.1980621814727783 and type_loss 2.7738027572631836



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.7316989898681641 with time_loss: -2.0686159133911133 and type_loss 2.8003149032592773




  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 0.6187019348144531 with time_loss: -2.1515204906463623 and type_loss 2.7702224254608154




  - (Training)   :  82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                   | 99/121 [00:07<00:01, 16.62it/s]


  - (Training)   :   3%|██████▏                                                                                                                                                                                             | 1/32 [00:03<01:37,  3.14s/it]
Test loss: 0.9330635070800781 with time_loss: -1.855027437210083 and type_loss 2.788090944290161





  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.1677846908569336 with time_loss: -2.94034743309021 and type_loss 2.7725627422332764



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: -0.1722707748413086 with time_loss: -2.946777820587158 and type_loss 2.7745070457458496



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.17871475219726562 with time_loss: -2.605753183364868 and type_loss 2.784467935562134



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.0513776540756226 with time_loss: -1.7403641939163208 and type_loss 2.7917418479919434



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.2249462604522705 with time_loss: -1.543407678604126 and type_loss 2.7683539390563965



  - (Training)   :  81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                     | 98/121 [00:07<00:01, 16.74it/s]


  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.1536450386047363 with time_loss: -1.6335272789001465 and type_loss 2.787172317504883



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.38948893547058105 with time_loss: -2.377117395401001 and type_loss 2.766606330871582



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.3768622875213623 with time_loss: -2.410128116607666 and type_loss 2.7869904041290283



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.36094164848327637 with time_loss: -2.4222497940063477 and type_loss 2.783191442489624



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.7133772373199463 with time_loss: -2.077650308609009 and type_loss 2.791027545928955



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 0.4154531955718994 with time_loss: -2.3613474369049072 and type_loss 2.7768006324768066



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                           | 0/121 [00:00<?, ?it/s]
Test loss: 1.4902952909469604 with time_loss: -1.2712324857711792 and type_loss 2.7615277767181396



  - (Training)   :   0%|                                                                                                                                                                                                            | 0/32 [00:00<?, ?it/s]

Test loss: 0.1420292854309082 with time_loss: -2.6391847133636475 and type_loss 2.7812139987945557
Best loss is: tensor(-1.0157, device='cuda:0')