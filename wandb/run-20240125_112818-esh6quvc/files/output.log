
  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 3, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')


  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.08it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9961878061294556 with time_loss: -3.5471043586730957 and type_loss 1.5509165525436401
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9171172380447388 with time_loss: -3.292445182800293 and type_loss 1.3753279447555542


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8228732347488403 with time_loss: -3.1704564094543457 and type_loss 1.3475831747055054



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.641984224319458 with time_loss: -3.879237174987793 and type_loss 1.237252950668335
New best found!



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.35it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.2394156455993652 with time_loss: -3.444244146347046 and type_loss 1.2048286199569702



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.3133106231689453 with time_loss: -3.5141468048095703 and type_loss 1.200836181640625



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.23360538482666 with time_loss: -3.3846347332000732 and type_loss 1.1510294675827026



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1271755695343018 with time_loss: -3.2967910766601562 and type_loss 1.1696155071258545


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8113620281219482 with time_loss: -1.9391272068023682 and type_loss 1.12776517868042


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.021939754486084 with time_loss: -3.1391115188598633 and type_loss 1.1171718835830688



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.4467933177948 with time_loss: -3.53108811378479 and type_loss 1.0842947959899902



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.2330641746520996 with time_loss: -2.3094005584716797 and type_loss 1.07633638381958



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.198131561279297 with time_loss: -3.2972002029418945 and type_loss 1.0990687608718872



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4865037202835083 with time_loss: -2.5447354316711426 and type_loss 1.0582317113876343


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2404441833496094 with time_loss: -3.2848947048187256 and type_loss 1.0444506406784058


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4184706211090088 with time_loss: -2.4633443355560303 and type_loss 1.0448737144470215



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.09it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2017780542373657 with time_loss: -2.2616777420043945 and type_loss 1.0598996877670288



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.05973744392395 with time_loss: -3.1260809898376465 and type_loss 1.0663435459136963



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.596632957458496 with time_loss: -3.672335147857666 and type_loss 1.07570219039917



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.0040054321289062 with time_loss: -3.0831122398376465 and type_loss 1.0791066884994507



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.39it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.206270933151245 with time_loss: -3.252471923828125 and type_loss 1.0462009906768799


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.922041177749634 with time_loss: -4.841676712036133 and type_loss 0.9196354746818542
Test loss: -2.2908403873443604 with time_loss: -3.3433547019958496 and type_loss 1.0525143146514893


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.609581470489502 with time_loss: -3.6444478034973145 and type_loss 1.034866452217102



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.35it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -3.1276683807373047 with time_loss: -4.159483909606934 and type_loss 1.0318154096603394
New best found!



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.5623327493667603 with time_loss: -2.5920026302337646 and type_loss 1.0296698808670044



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -3.2738471031188965 with time_loss: -4.312408447265625 and type_loss 1.038561463356018
New best found!



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.8342368602752686 with time_loss: -2.868802070617676 and type_loss 1.0345652103424072



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.65it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.619842529296875 with time_loss: -3.65811824798584 and type_loss 1.0382758378982544


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.033109188079834 with time_loss: -4.93560266494751 and type_loss 0.9024932980537415
Test loss: -2.743119955062866 with time_loss: -3.774040699005127 and type_loss 1.0309207439422607


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.661566734313965 with time_loss: -3.7078857421875 and type_loss 1.0463188886642456


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3765769004821777 with time_loss: -3.396007537841797 and type_loss 1.0194305181503296



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.076465606689453 with time_loss: -3.0998551845550537 and type_loss 1.023389458656311



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.42it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.058005452156067 with time_loss: -2.0830678939819336 and type_loss 1.0250624418258667


  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.22it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.7920520305633545 with time_loss: -2.8151893615722656 and type_loss 1.0231373310089111



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8208601474761963 with time_loss: -3.8414499759674072 and type_loss 1.020589828491211



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.2698872089385986 with time_loss: -3.286219835281372 and type_loss 1.0163326263427734


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.296220779418945 with time_loss: -5.159944534301758 and type_loss 0.8637235760688782
Test loss: -2.2276344299316406 with time_loss: -3.2550675868988037 and type_loss 1.027433156967163



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5930933952331543 with time_loss: -2.619786024093628 and type_loss 1.0266926288604736



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.2228617668151855 with time_loss: -3.2463643550872803 and type_loss 1.0235025882720947



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.20it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.9218541383743286 with time_loss: -2.948026180267334 and type_loss 1.0261720418930054



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.595943808555603 with time_loss: -2.6187033653259277 and type_loss 1.0227595567703247



  - (Training)   :  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 80/121 [00:04<00:02, 19.65it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5136257410049438 with time_loss: -2.5350334644317627 and type_loss 1.0214077234268188


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.4302849769592285 with time_loss: -5.2802910804748535 and type_loss 0.8500062227249146
Test loss: -1.5415078401565552 with time_loss: -2.5598087310791016 and type_loss 1.0183008909225464



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.466263771057129 with time_loss: -5.312005519866943 and type_loss 0.8457415103912354
Test loss: -1.9225866794586182 with time_loss: -2.944667100906372 and type_loss 1.022080421447754



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.527226448059082 with time_loss: -2.5473666191101074 and type_loss 1.0201401710510254



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.6205695867538452 with time_loss: -2.6393485069274902 and type_loss 1.018778920173645



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.11it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.0999748706817627 with time_loss: -3.124563217163086 and type_loss 1.0245883464813232



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.9867534637451172 with time_loss: -3.0046558380126953 and type_loss 1.0179023742675781



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:04<00:02, 19.39it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.7074863910675049 with time_loss: -2.732426643371582 and type_loss 1.0249402523040771


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.469499111175537 with time_loss: -5.310715675354004 and type_loss 0.8412165641784668
Test loss: -1.3339629173278809 with time_loss: -2.36320424079895 and type_loss 1.0292413234710693

