Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 3, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.5511282682418823 with time_loss: -3.1290836334228516 and type_loss 1.5779553651809692
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.9845654964447021 with time_loss: -3.328009605407715 and type_loss 1.3434441089630127
New best found!



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4268484115600586 with time_loss: -3.6192283630371094 and type_loss 1.1923799514770508
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.5004141330718994 with time_loss: -3.735590934753418 and type_loss 1.2351768016815186
Test loss: -2.009523391723633 with time_loss: -3.2531821727752686 and type_loss 1.2436586618423462



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.36it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -2.6401326656341553 with time_loss: -3.8198866844177246 and type_loss 1.1797540187835693
New best found!



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:04, 13.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9937723875045776 with time_loss: -2.135226249694824 and type_loss 1.1414538621902466



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:04, 13.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2095694541931152 with time_loss: -3.4620256423950195 and type_loss 1.2524560689926147




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:07<00:00, 19.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.838224411010742 with time_loss: -4.102711200714111 and type_loss 1.2644867897033691
New best found!



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1292130947113037 with time_loss: -3.3522744178771973 and type_loss 1.2230613231658936


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.450486183166504 with time_loss: -3.6172401905059814 and type_loss 1.1667540073394775



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:05<00:01, 19.77it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -2.898393154144287 with time_loss: -3.976743459701538 and type_loss 1.078350305557251
New best found!



  - (Training)   :  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 92/121 [00:05<00:01, 22.03it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6305352449417114 with time_loss: -2.713420867919922 and type_loss 1.0828856229782104


  - (Training)   :  43%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 52/121 [00:05<00:05, 12.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.62056827545166 with time_loss: -3.6967122554779053 and type_loss 1.0761439800262451



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.87it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6343493461608887 with time_loss: -3.6811294555664062 and type_loss 1.0467801094055176



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.74it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.215877056121826 with time_loss: -3.3001599311828613 and type_loss 1.0842828750610352




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.77it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.9250540733337402 with time_loss: -3.994184970855713 and type_loss 1.0691310167312622
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.632297992706299 with time_loss: -4.613502502441406 and type_loss 0.9812045097351074
Test loss: -1.6297359466552734 with time_loss: -2.6838362216949463 and type_loss 1.0541002750396729



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9104667901992798 with time_loss: -2.9694130420684814 and type_loss 1.0589462518692017



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.21673321723938 with time_loss: -4.2629876136779785 and type_loss 1.0462543964385986
New best found!



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8363546133041382 with time_loss: -2.885788917541504 and type_loss 1.0494343042373657



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5001699924468994 with time_loss: -3.521667242050171 and type_loss 1.0214972496032715




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:07<00:01, 16.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.6937448978424072 with time_loss: -3.7422966957092285 and type_loss 1.0485517978668213




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:07<00:01, 16.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.9921503067016602 with time_loss: -3.0261008739471436 and type_loss 1.0339505672454834




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.1285243034362793 with time_loss: -3.1682257652282715 and type_loss 1.0397014617919922




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:07<00:01, 16.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.556385040283203 with time_loss: -3.600693464279175 and type_loss 1.0443084239959717




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.344289779663086 with time_loss: -3.381314277648926 and type_loss 1.0370244979858398




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.89it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.671417236328125 with time_loss: -3.6925296783447266 and type_loss 1.0211124420166016



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.6088619232177734 with time_loss: -3.6362645626068115 and type_loss 1.0274025201797485



  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4642953872680664 with time_loss: -2.4915406703948975 and type_loss 1.027245283126831



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5977668762207031 with time_loss: -2.615723133087158 and type_loss 1.017956256866455




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.240048408508301 with time_loss: -5.118175983428955 and type_loss 0.8781277537345886
Test loss: -1.4284660816192627 with time_loss: -2.4527978897094727 and type_loss 1.02433180809021



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.78it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0860390663146973 with time_loss: -3.1037888526916504 and type_loss 1.0177499055862427




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9086248874664307 with time_loss: -3.9231700897216797 and type_loss 1.014545202255249



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.98it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.475803852081299 with time_loss: -3.4973597526550293 and type_loss 1.0215559005737305




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.89it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -2.538738965988159 with time_loss: -3.5624260902404785 and type_loss 1.0236871242523193




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.87it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -2.7329254150390625 with time_loss: -3.7549290657043457 and type_loss 1.0220035314559937




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.95it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.1900415420532227 with time_loss: -3.203360080718994 and type_loss 1.0133185386657715




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.90it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.8968596458435059 with time_loss: -2.924262285232544 and type_loss 1.027402639389038




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.85it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.325529098510742 with time_loss: -3.349795341491699 and type_loss 1.0242663621902466



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.7336318492889404 with time_loss: -1.7543694972991943 and type_loss 1.020737648010254



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.461472988128662 with time_loss: -5.306077480316162 and type_loss 0.8446046113967896
Test loss: -1.6185364723205566 with time_loss: -2.636540174484253 and type_loss 1.0180037021636963



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 12.00it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9810206890106201 with time_loss: -2.997060537338257 and type_loss 1.0160398483276367



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3885412216186523 with time_loss: -3.3989315032958984 and type_loss 1.010390281677246



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8126311302185059 with time_loss: -2.830151319503784 and type_loss 1.0175201892852783



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.002903938293457 with time_loss: -3.019500255584717 and type_loss 1.0165961980819702




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4145851135253906 with time_loss: -3.4307034015655518 and type_loss 1.0161182880401611




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: -1.5886417627334595 with time_loss: -2.610827684402466 and type_loss 1.0221859216690063




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 17.00it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.195244312286377 with time_loss: -3.2153398990631104 and type_loss 1.020095705986023




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:07<00:01, 16.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.9718494415283203 with time_loss: -3.982966423034668 and type_loss 1.011116862297058




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:07<00:01, 16.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.043491840362549 with time_loss: -3.06396746635437 and type_loss 1.0204757452011108

