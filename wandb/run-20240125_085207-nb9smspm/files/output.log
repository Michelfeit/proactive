Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 3, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.42it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.793199062347412 with time_loss: -3.2846810817718506 and type_loss 1.4914820194244385
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5081021785736084 with time_loss: -2.837484836578369 and type_loss 1.3293826580047607


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.4698121547698975 with time_loss: -3.744191884994507 and type_loss 1.2743797302246094
New best found!


  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.3388328552246094 with time_loss: -3.598850965499878 and type_loss 1.260017991065979




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3773720264434814 with time_loss: -3.64524507522583 and type_loss 1.2678730487823486

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5286788940429688 with time_loss: -3.746675491333008 and type_loss 1.217996597290039
New best found!



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.1646151542663574 with time_loss: -3.3674044609069824 and type_loss 1.2027894258499146



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.43it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.39329195022583 with time_loss: -3.597766637802124 and type_loss 1.2044745683670044


  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0708773136138916 with time_loss: -3.2126400470733643 and type_loss 1.1417627334594727


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3624558448791504 with time_loss: -3.5222008228302 and type_loss 1.1597448587417603


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1629509925842285 with time_loss: -3.2838757038116455 and type_loss 1.1209245920181274



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.860220193862915 with time_loss: -3.9609947204589844 and type_loss 1.1007745265960693
New best found!



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.15it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1360886096954346 with time_loss: -3.245805025100708 and type_loss 1.1097164154052734


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5387037992477417 with time_loss: -2.6432859897613525 and type_loss 1.1045821905136108


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6566308736801147 with time_loss: -2.814197301864624 and type_loss 1.1575664281845093


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.89s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.252389907836914 with time_loss: -2.3507070541381836 and type_loss 1.0983171463012695



  - (Training)   :  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 84/121 [00:04<00:01, 20.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.1784350872039795 with time_loss: -3.256279945373535 and type_loss 1.0778448581695557




Train loss: -3.4374678134918213 with time_loss: -4.446831703186035 and type_loss 1.0093638896942139
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8088691234588623 with time_loss: -3.9103286266326904 and type_loss 1.1014595031738281


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.231414794921875 with time_loss: -3.306483745574951 and type_loss 1.0750689506530762



  - (Training)   :  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 84/121 [00:04<00:01, 20.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3987480401992798 with time_loss: -2.4667575359344482 and type_loss 1.0680094957351685



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.6437368392944336 with time_loss: -3.6877779960632324 and type_loss 1.0440411567687988



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.771217107772827 with time_loss: -3.819741725921631 and type_loss 1.0485246181488037


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8267160654067993 with time_loss: -1.8637763261795044 and type_loss 1.037060260772705



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: -2.3057005405426025 with time_loss: -3.326340436935425 and type_loss 1.0206398963928223



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.39it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.6642298698425293 with time_loss: -3.69118070602417 and type_loss 1.0269508361816406


  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5108890533447266 with time_loss: -3.538687229156494 and type_loss 1.0277982950210571



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.852766752243042 with time_loss: -4.787197113037109 and type_loss 0.9344303607940674
Test loss: -2.3766798973083496 with time_loss: -3.4191737174987793 and type_loss 1.0424938201904297


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3575658798217773 with time_loss: -3.406630754470825 and type_loss 1.0490648746490479



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.2046916484832764 with time_loss: -3.2449164390563965 and type_loss 1.0402247905731201



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.1504812240600586 with time_loss: -4.181909084320068 and type_loss 1.0314277410507202
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0374689102172852 with time_loss: -2.0599231719970703 and type_loss 1.0224542617797852


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4011905193328857 with time_loss: -2.4209980964660645 and type_loss 1.0198075771331787



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.312300205230713 with time_loss: -3.3353936672210693 and type_loss 1.023093581199646



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.44it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.8167929649353027 with time_loss: -2.83290696144104 and type_loss 1.0161139965057373


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.138588905334473 with time_loss: -5.028728008270264 and type_loss 0.8901389837265015
Test loss: -2.410951614379883 with time_loss: -3.423336982727051 and type_loss 1.0123854875564575


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6900277137756348 with time_loss: -3.7238597869873047 and type_loss 1.0338321924209595



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.45it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -1.8475160598754883 with time_loss: -2.8654274940490723 and type_loss 1.017911434173584



  - (Training)   :  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 84/121 [00:04<00:01, 20.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5434659719467163 with time_loss: -2.5658962726593018 and type_loss 1.0224303007125854



  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1077466011047363 with time_loss: -3.136740207672119 and type_loss 1.0289936065673828


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3997416496276855 with time_loss: -3.4408249855041504 and type_loss 1.0410834550857544



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.1026926040649414 with time_loss: -3.1264243125915527 and type_loss 1.0237317085266113



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.50it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.640225887298584 with time_loss: -3.6611831188201904 and type_loss 1.020957350730896


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.265840530395508 with time_loss: -5.138845920562744 and type_loss 0.8730053901672363
Test loss: -2.09991192817688 with time_loss: -3.12069034576416 and type_loss 1.0207784175872803


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.89s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.132838249206543 with time_loss: -3.1573004722595215 and type_loss 1.024462103843689



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.621182918548584 with time_loss: -2.641810417175293 and type_loss 1.020627498626709



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.1771302223205566 with time_loss: -3.1923844814300537 and type_loss 1.0152541399002075


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2146074771881104 with time_loss: -2.231858968734741 and type_loss 1.0172514915466309


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4410643577575684 with time_loss: -3.462538957595825 and type_loss 1.0214747190475464



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.881040573120117 with time_loss: -3.901662588119507 and type_loss 1.0206218957901



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.48it/s]


Test loss: -0.9460117816925049 with time_loss: -1.9677300453186035 and type_loss 1.0217182636260986
Best loss is: tensor(-3.1505, device='cuda:0')