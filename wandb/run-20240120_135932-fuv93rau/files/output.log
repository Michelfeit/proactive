Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'd_model': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 8, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.5229612588882446 with time_loss: -3.0175650119781494 and type_loss 1.4946037530899048
New best found!



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.40it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1041994094848633 with time_loss: -3.4556007385253906 and type_loss 1.3514013290405273
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.07it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.324279546737671 with time_loss: -3.5664799213409424 and type_loss 1.2422003746032715
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.174494743347168 with time_loss: -3.4181876182556152 and type_loss 1.2436927556991577


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.775113344192505 with time_loss: -3.9662487506866455 and type_loss 1.1911354064941406
New best found!



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.81it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.955552101135254 with time_loss: -4.151123523712158 and type_loss 1.1955715417861938
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:53,  2.95s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3796913623809814 with time_loss: -3.5823421478271484 and type_loss 1.202650785446167


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6639726161956787 with time_loss: -3.8611440658569336 and type_loss 1.1971714496612549



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.895829439163208 with time_loss: -4.085938453674316 and type_loss 1.1901090145111084



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.399489641189575 with time_loss: -3.589690923690796 and type_loss 1.1902012825012207



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.9771130084991455 with time_loss: -4.06458044052124 and type_loss 1.0874674320220947
New best found!



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.283952236175537 with time_loss: -3.3449816703796387 and type_loss 1.0610295534133911


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:00,  3.00s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9744675159454346 with time_loss: -4.0578389167785645 and type_loss 1.0833714008331299


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.056210517883301 with time_loss: -4.135378837585449 and type_loss 1.0791683197021484
New best found!



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -3.3433375358581543 with time_loss: -4.431204319000244 and type_loss 1.0878667831420898
New best found!



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.7992098331451416 with time_loss: -3.8588078022003174 and type_loss 1.0595979690551758



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -3.079029083251953 with time_loss: -4.136465072631836 and type_loss 1.0574358701705933



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.451219320297241 with time_loss: -4.530611038208008 and type_loss 1.0793917179107666
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6445367336273193 with time_loss: -3.7181849479675293 and type_loss 1.07364821434021


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:57,  2.98s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.2190775871276855 with time_loss: -4.266871452331543 and type_loss 1.047793984413147



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.51it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.066361665725708 with time_loss: -4.10179328918457 and type_loss 1.0354316234588623



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.97s/it]
Test loss: -2.6753721237182617 with time_loss: -3.714665412902832 and type_loss 1.0392934083938599



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -3.215303897857666 with time_loss: -4.24284553527832 and type_loss 1.0275417566299438



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.0940279960632324 with time_loss: -4.13859748840332 and type_loss 1.0445696115493774



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:04<00:03, 16.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.002610206604004 with time_loss: -4.037417888641357 and type_loss 1.034807562828064



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.1871488094329834 with time_loss: -4.223459720611572 and type_loss 1.0363109111785889



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.58it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.4278712272644043 with time_loss: -4.460660457611084 and type_loss 1.0327893495559692


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.59it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.102673053741455 with time_loss: -4.145638465881348 and type_loss 1.042965292930603



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: -2.635680675506592 with time_loss: -3.6737375259399414 and type_loss 1.0380568504333496



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.55it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.4819087982177734 with time_loss: -4.51444673538208 and type_loss 1.0325379371643066
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.0675721168518066 with time_loss: -4.090075492858887 and type_loss 1.0225032567977905



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.240084648132324 with time_loss: -5.116507530212402 and type_loss 0.8764227032661438
Test loss: -3.161402940750122 with time_loss: -4.187211990356445 and type_loss 1.0258090496063232



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -3.075524091720581 with time_loss: -4.09874963760376 and type_loss 1.0232255458831787



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.4975924491882324 with time_loss: -3.515509605407715 and type_loss 1.017917275428772



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.47it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -3.011866331100464 with time_loss: -4.02439546585083 and type_loss 1.0125291347503662



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.55it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8034942150115967 with time_loss: -3.8194830417633057 and type_loss 1.015988826751709


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3960866928100586 with time_loss: -3.4073617458343506 and type_loss 1.0112751722335815



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.315113544464111 with time_loss: -5.185994625091553 and type_loss 0.8708811402320862
Test loss: -3.059478998184204 with time_loss: -4.079497337341309 and type_loss 1.0200183391571045



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.26859974861145 with time_loss: -4.283288955688477 and type_loss 1.0146892070770264



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.76it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.2498698234558105 with time_loss: -4.263582706451416 and type_loss 1.0137128829956055



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.56it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.725639820098877 with time_loss: -3.7326390743255615 and type_loss 1.006999135017395



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.57it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.4486193656921387 with time_loss: -4.454796314239502 and type_loss 1.0061769485473633



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.80it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.831822395324707 with time_loss: -3.8467304706573486 and type_loss 1.014907956123352



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.43420934677124 with time_loss: -5.290462493896484 and type_loss 0.8562531471252441

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.8486666679382324 with time_loss: -3.8577756881713867 and type_loss 1.0091091394424438



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.351804256439209 with time_loss: -3.359684944152832 and type_loss 1.0078805685043335



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.56it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: -2.981186628341675 with time_loss: -3.9875054359436035 and type_loss 1.0063188076019287



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:04<00:03, 16.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.5397863388061523 with time_loss: -4.545355319976807 and type_loss 1.0055688619613647
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.159801959991455 with time_loss: -4.167630195617676 and type_loss 1.0078283548355103



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

Test loss: -2.8507213592529297 with time_loss: -3.8612732887268066 and type_loss 1.0105520486831665
Best loss is: tensor(-3.5398, device='cuda:0')