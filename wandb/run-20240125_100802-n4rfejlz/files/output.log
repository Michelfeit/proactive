Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 6, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.43it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.2846388816833496 with time_loss: -2.812922716140747 and type_loss 2.5282838344573975
New best found!



  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.29876708984375 with time_loss: -2.3794960975646973 and type_loss 2.0807290077209473
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2332597970962524 with time_loss: -3.1677355766296387 and type_loss 1.9344757795333862
New best found!



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.23it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7508885860443115 with time_loss: -2.6672046184539795 and type_loss 1.916316032409668



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.477027177810669 with time_loss: -3.3600082397460938 and type_loss 1.8829810619354248
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3541017770767212 with time_loss: -3.3290274143218994 and type_loss 1.9749256372451782
Test loss: -1.6119005680084229 with time_loss: -3.434774160385132 and type_loss 1.822873592376709
New best found!



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.23it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.3856394290924072 with time_loss: -3.374750852584839 and type_loss 1.9891114234924316



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.25it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1608448028564453 with time_loss: -3.0757594108581543 and type_loss 1.914914608001709



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.3049860000610352 with time_loss: -3.0954172611236572 and type_loss 1.790431261062622



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.08731293678283691 with time_loss: -2.3050153255462646 and type_loss 2.2177023887634277




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:06<00:00, 20.07it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6554864645004272 with time_loss: -3.3675808906555176 and type_loss 1.7120944261550903
New best found!


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0302984714508057 with time_loss: -2.7491517066955566 and type_loss 1.718853235244751



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -0.7827560901641846 with time_loss: -2.4987244606018066 and type_loss 1.715968370437622



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.23it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6126830577850342 with time_loss: -3.269524574279785 and type_loss 1.656841516494751




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.08it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6424176692962646 with time_loss: -3.2924396991729736 and type_loss 1.650022029876709


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.21it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.5963551998138428 with time_loss: -3.4048125743865967 and type_loss 1.808457374572754




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6064823865890503 with time_loss: -3.3439111709594727 and type_loss 1.7374287843704224



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -1.525942087173462 with time_loss: -3.2227656841278076 and type_loss 1.6968235969543457



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.22it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.273036241531372 with time_loss: -3.010622501373291 and type_loss 1.737586259841919



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.8945403099060059 with time_loss: -3.5835297107696533 and type_loss 1.6889894008636475
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.4479384422302246 with time_loss: -4.10783576965332 and type_loss 1.6598973274230957
Test loss: -1.1723885536193848 with time_loss: -2.853132724761963 and type_loss 1.6807441711425781



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.22it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.421307921409607 with time_loss: -3.1029484272003174 and type_loss 1.6816405057907104



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3473474979400635 with time_loss: -4.022054195404053 and type_loss 1.6747066974639893
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.148653030395508 with time_loss: -3.784459352493286 and type_loss 1.6358064413070679



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9126306772232056 with time_loss: -3.532194137573242 and type_loss 1.6195634603500366



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.21it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.5979833602905273 with time_loss: -3.2342731952667236 and type_loss 1.6362898349761963



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.24it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2468650341033936 with time_loss: -3.8591740131378174 and type_loss 1.6123089790344238




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:06<00:00, 20.07it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0786429643630981 with time_loss: -2.6832897663116455 and type_loss 1.6046468019485474



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.84883451461792 with time_loss: -3.4470715522766113 and type_loss 1.5982370376586914




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.6756645441055298 with time_loss: -2.2718276977539062 and type_loss 1.5961631536483765


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3214675188064575 with time_loss: -2.903634786605835 and type_loss 1.5821672677993774




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.26it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2138615846633911 with time_loss: -2.7901031970977783 and type_loss 1.5762416124343872



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.6500123739242554 with time_loss: -3.235152244567871 and type_loss 1.5851398706436157



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2278521060943604 with time_loss: -2.803581714630127 and type_loss 1.5757296085357666



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.510030746459961 with time_loss: -3.090409278869629 and type_loss 1.580378532409668




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.786532402038574 with time_loss: -4.354258060455322 and type_loss 1.5677257776260376
Test loss: -1.712146520614624 with time_loss: -3.2919933795928955 and type_loss 1.5798468589782715



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.14it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.7477627992630005 with time_loss: -3.314366102218628 and type_loss 1.5666033029556274



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.38it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4248765707015991 with time_loss: -3.0036275386810303 and type_loss 1.5787509679794312



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.5337425470352173 with time_loss: -3.0983994007110596 and type_loss 1.5646568536758423



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9306501150131226 with time_loss: -2.492465019226074 and type_loss 1.5618149042129517



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.4888253211975098 with time_loss: -3.058884382247925 and type_loss 1.570059061050415



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6933406591415405 with time_loss: -3.2582895755767822 and type_loss 1.5649489164352417




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:06<00:00, 20.04it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.3545573949813843 with time_loss: -2.9118142127990723 and type_loss 1.557256817817688


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.25it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.7427302598953247 with time_loss: -3.300755500793457 and type_loss 1.5580252408981323




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.7466288805007935 with time_loss: -3.302399158477783 and type_loss 1.5557702779769897


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: -1.6643437147140503 with time_loss: -3.2185657024383545 and type_loss 1.5542219877243042




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.9425361156463623 with time_loss: -4.479168891906738 and type_loss 1.536632776260376
Test loss: -1.2974159717559814 with time_loss: -2.855189323425293 and type_loss 1.5577733516693115



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.21it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -1.3859622478485107 with time_loss: -2.943445920944214 and type_loss 1.5574836730957031




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.9635353088378906 with time_loss: -4.505733013153076 and type_loss 1.542197823524475
Test loss: -1.5973342657089233 with time_loss: -3.15433669090271 and type_loss 1.5570024251937866




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.22it/s]


Test loss: -1.2815704345703125 with time_loss: -2.834589958190918 and type_loss 1.5530195236206055
Best loss is: tensor(-2.3473, device='cuda:0')