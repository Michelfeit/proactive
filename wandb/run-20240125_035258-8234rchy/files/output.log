Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.15it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.881540298461914 with time_loss: -1.5560336112976074 and type_loss 3.4375739097595215



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.5390362739562988 with time_loss: -2.6601240634918213 and type_loss 3.19916033744812



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.57it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6324570178985596 with time_loss: -2.667916774749756 and type_loss 3.3003737926483154



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.99it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.10285329818725586 with time_loss: -3.2219362258911133 and type_loss 3.1190829277038574
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.14729905128479004 with time_loss: -2.8597984313964844 and type_loss 3.0070974826812744



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.08662033081054688 with time_loss: -2.864654541015625 and type_loss 2.951274871826172




  - (Training)   :  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 120/121 [00:07<00:00, 20.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.008768081665039 with time_loss: -2.100614070892334 and type_loss 3.109382152557373



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: -0.0053899288177490234 with time_loss: -2.974595546722412 and type_loss 2.969205617904663



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.39707255363464355 with time_loss: -2.480398416519165 and type_loss 2.8774709701538086



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7223217487335205 with time_loss: -2.2111990451812744 and type_loss 2.933520793914795



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.14it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.22422528266906738 with time_loss: -2.6623003482818604 and type_loss 2.8865256309509277



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.40it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5264136791229248 with time_loss: -3.4004299640655518 and type_loss 2.874016284942627
New best found!



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:04, 14.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.7245259284973145 with time_loss: -1.1471803188323975 and type_loss 2.871706247329712



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.613553762435913 with time_loss: -0.24340035021305084 and type_loss 2.8569540977478027



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.23876261711120605 with time_loss: -2.596951723098755 and type_loss 2.835714340209961




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 18.30it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.1032602787017822 with time_loss: -0.7327835559844971 and type_loss 2.8360438346862793



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3579220771789551 with time_loss: -2.5154082775115967 and type_loss 2.8733303546905518



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.04286026954650879 with time_loss: -2.805023193359375 and type_loss 2.847883462905884



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 2.1128242015838623 with time_loss: -0.7251901030540466 and type_loss 2.8380143642425537




  - (Training)   :  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 117/121 [00:07<00:00, 19.99it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.2062054872512817 with time_loss: -1.6522215604782104 and type_loss 2.858427047729492


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:04<00:04, 14.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: 2.104081869125366 with time_loss: -0.7171785235404968 and type_loss 2.821260452270508




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:07<00:00, 18.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.4681417942047119 with time_loss: -2.346494436264038 and type_loss 2.81463623046875



  - (Training)   :  42%|████████████████████████████████████████████████████████████████████████████████▉                                                                                                               | 51/121 [00:05<00:05, 12.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.2146975994110107 with time_loss: -0.5816023945808411 and type_loss 2.796299934387207



  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:07<00:00, 20.06it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.1161293983459473 with time_loss: -1.7020087242126465 and type_loss 2.8181381225585938




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.1062753200531006 with time_loss: -3.861570358276367 and type_loss 2.7552950382232666
Test loss: 3.105942964553833 with time_loss: 0.2927761673927307 and type_loss 2.813166856765747



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 3.544121026992798 with time_loss: 0.6861916184425354 and type_loss 2.8579294681549072




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.1512782573699951 with time_loss: -3.90606951713562 and type_loss 2.754791259765625
Test loss: 2.109438180923462 with time_loss: -0.7798979878425598 and type_loss 2.889336109161377



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.31it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.7451493740081787 with time_loss: -0.0651351809501648 and type_loss 2.8102846145629883




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 18.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 2.7249393463134766 with time_loss: -0.1276221126317978 and type_loss 2.8525614738464355



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.73it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.3225839138031006 with time_loss: -0.5213114619255066 and type_loss 2.843895435333252



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.89it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 2.898977518081665 with time_loss: 0.10351362824440002 and type_loss 2.795463800430298




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3008549213409424 with time_loss: -4.020975589752197 and type_loss 2.720120668411255
Test loss: 2.9729113578796387 with time_loss: 0.17514586448669434 and type_loss 2.7977654933929443



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 3.0575785636901855 with time_loss: 0.2602227032184601 and type_loss 2.797355890274048




  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 18.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.4150867462158203 with time_loss: -0.41001543402671814 and type_loss 2.8251020908355713



  - (Training)   :  43%|██████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 52/121 [00:05<00:05, 12.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.819758415222168 with time_loss: 0.025578802451491356 and type_loss 2.794179677963257



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 3.6901824474334717 with time_loss: 0.865567147731781 and type_loss 2.824615240097046




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3557541370391846 with time_loss: -4.067216873168945 and type_loss 2.7114627361297607
Test loss: 3.240849018096924 with time_loss: 0.4473113417625427 and type_loss 2.7935376167297363



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.2684075832366943 with time_loss: 0.47054317593574524 and type_loss 2.7978644371032715




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3132812976837158 with time_loss: -4.02725076675415 and type_loss 2.7139694690704346
Test loss: 2.4948983192443848 with time_loss: -0.3675633668899536 and type_loss 2.862461566925049



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.829035997390747 with time_loss: 0.025458430871367455 and type_loss 2.8035776615142822




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 18.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 3.2220959663391113 with time_loss: 0.4236205220222473 and type_loss 2.798475503921509




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.41756010055542 with time_loss: -4.121560096740723 and type_loss 2.7039999961853027
Test loss: 3.091740846633911 with time_loss: 0.3001777231693268 and type_loss 2.791563034057617



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.2049307823181152 with time_loss: 0.4106980860233307 and type_loss 2.7942326068878174



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.60it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.880993127822876 with time_loss: 0.09642719477415085 and type_loss 2.7845659255981445


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.7081785202026367 with time_loss: 0.8863040208816528 and type_loss 2.8218743801116943




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 18.75it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.0737552642822266 with time_loss: 0.2894550859928131 and type_loss 2.7843000888824463



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4631526470184326 with time_loss: -4.158586502075195 and type_loss 2.6954338550567627
Test loss: 3.153801441192627 with time_loss: 0.3670232892036438 and type_loss 2.786778211593628



  - (Training)   :  42%|████████████████████████████████████████████████████████████████████████████████▉                                                                                                               | 51/121 [00:05<00:05, 12.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.077859401702881 with time_loss: 0.29830968379974365 and type_loss 2.7795495986938477



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.290614366531372 with time_loss: 0.48254480957984924 and type_loss 2.8080694675445557



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 3.345137596130371 with time_loss: 0.5543057918548584 and type_loss 2.7908318042755127

