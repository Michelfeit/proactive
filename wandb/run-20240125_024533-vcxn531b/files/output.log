Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 6, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.45057153701782227 with time_loss: -2.8100602626800537 and type_loss 2.3594887256622314
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.1819441318511963 with time_loss: -3.2013840675354004 and type_loss 2.019439935684204
New best found!


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 15.13it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3664324283599854 with time_loss: -3.3928298950195312 and type_loss 2.026397466659546
New best found!




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 118/121 [00:07<00:00, 20.13it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2310655117034912 with time_loss: -3.1806869506835938 and type_loss 1.9496214389801025



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3501662015914917 with time_loss: -3.3145508766174316 and type_loss 1.96438467502594
Test loss: -1.450559139251709 with time_loss: -3.3896286487579346 and type_loss 1.9390695095062256
New best found!



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.06376159191131592 with time_loss: -1.779189109802246 and type_loss 1.842950701713562





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4144872426986694 with time_loss: -3.358682870864868 and type_loss 1.9441956281661987
Test loss: -0.8042833805084229 with time_loss: -2.830077886581421 and type_loss 2.025794506072998



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4426579475402832 with time_loss: -3.186129093170166 and type_loss 2.743471145629883





Train loss: -0.3912081718444824 with time_loss: -3.148249626159668 and type_loss 2.7570414543151855

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.23949933052062988 with time_loss: -2.935985803604126 and type_loss 2.696486473083496


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.22314119338989258 with time_loss: -2.601330041885376 and type_loss 2.3781888484954834



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.09it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -0.6810438632965088 with time_loss: -2.9686036109924316 and type_loss 2.287559747695923



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4902677536010742 with time_loss: -2.731653928756714 and type_loss 2.2413861751556396



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.88it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.17670106887817383 with time_loss: -2.044133186340332 and type_loss 2.220834255218506


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2014286518096924 with time_loss: -3.3789193630218506 and type_loss 2.177490711212158



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 0.23433303833007812 with time_loss: -1.9213523864746094 and type_loss 2.1556854248046875



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4624197483062744 with time_loss: -3.504284143447876 and type_loss 2.0418643951416016
New best found!



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -0.9615194797515869 with time_loss: -2.997319221496582 and type_loss 2.035799741744995



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4026374816894531 with time_loss: -2.489225387573242 and type_loss 2.086587905883789



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2524217367172241 with time_loss: -3.239495038986206 and type_loss 1.987073302268982




  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:07<00:00, 18.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3789701461791992 with time_loss: -3.3374319076538086 and type_loss 1.9584617614746094




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.2798115015029907 with time_loss: -2.2320303916931152 and type_loss 1.9522188901901245



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:04, 13.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.42597687244415283 with time_loss: -2.352841854095459 and type_loss 1.9268649816513062



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3671858310699463 with time_loss: -2.2595973014831543 and type_loss 1.892411470413208




  - (Training)   :  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 120/121 [00:07<00:00, 20.56it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.4790850877761841 with time_loss: -2.3708887100219727 and type_loss 1.8918036222457886


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 15.04it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1607686281204224 with time_loss: -3.0424845218658447 and type_loss 1.8817158937454224



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 14.99it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.37935543060302734 with time_loss: -2.2769112586975098 and type_loss 1.8975558280944824



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8102729320526123 with time_loss: -3.6918773651123047 and type_loss 1.8816044330596924
New best found!



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: -1.3116687536239624 with time_loss: -3.1910197734832764 and type_loss 1.879351019859314



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.36309587955474854 with time_loss: -1.501044750213623 and type_loss 1.8641406297683716



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 15.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: -1.6060982942581177 with time_loss: -3.4830989837646484 and type_loss 1.8770006895065308



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2320266962051392 with time_loss: -3.101393461227417 and type_loss 1.8693667650222778



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.389148235321045 with time_loss: -3.234663963317871 and type_loss 1.8455157279968262



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.9528427124023438 with time_loss: -2.81181001663208 and type_loss 1.8589673042297363




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2134125232696533 with time_loss: -3.0519473552703857 and type_loss 1.8385348320007324


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0020068883895874 with time_loss: -2.8134827613830566 and type_loss 1.8114758729934692



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6421809196472168 with time_loss: -2.4872324466705322 and type_loss 1.8450515270233154



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1312869787216187 with time_loss: -2.9416470527648926 and type_loss 1.810360074043274




  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 18.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.6536593437194824 with time_loss: -3.462049961090088 and type_loss 1.8083906173706055




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.3223471641540527 with time_loss: -4.1663007736206055 and type_loss 1.8439537286758423
Test loss: -1.346916675567627 with time_loss: -3.1490180492401123 and type_loss 1.8021013736724854



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -1.6274158954620361 with time_loss: -3.4235806465148926 and type_loss 1.7961647510528564



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.492383599281311 with time_loss: -3.281574010848999 and type_loss 1.789190411567688



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1822378635406494 with time_loss: -2.966977834701538 and type_loss 1.7847399711608887



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.1390076875686646 with time_loss: -2.9196367263793945 and type_loss 1.78062903881073



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.41it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5356454849243164 with time_loss: -3.3256685733795166 and type_loss 1.7900230884552002



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.11it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.6997545957565308 with time_loss: -2.495856523513794 and type_loss 1.7961019277572632




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.6437913179397583 with time_loss: -2.428372859954834 and type_loss 1.7845815420150757


  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.78it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.2626433372497559 with time_loss: -3.044602632522583 and type_loss 1.7819592952728271




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.8233298063278198 with time_loss: -2.596289873123169 and type_loss 1.7729600667953491


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1643975973129272 with time_loss: -2.9458694458007812 and type_loss 1.781471848487854



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.64it/s]


Test loss: -0.8314634561538696 with time_loss: -2.6119887828826904 and type_loss 1.7805253267288208
Best loss is: tensor(-1.8103, device='cuda:0')