Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'd_model': 256, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 35, 'learning_rate': 7.112752691632066e-05, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 16, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -0.43096065521240234 with time_loss: -12.135676383972168 and type_loss 11.704715728759766
New best found!


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:05<00:02, 16.63it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:03<01:37,  3.15s/it]
Test loss: -4.668392181396484 with time_loss: -13.472365379333496 and type_loss 8.803973197937012
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Train loss: -4.499678611755371 with time_loss: -13.361275672912598 and type_loss 8.861597061157227
Test loss: -5.51344108581543 with time_loss: -13.797679901123047 and type_loss 8.284238815307617
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 0.43045902252197266 with time_loss: -8.86915397644043 and type_loss 9.299612998962402


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 0.9957742691040039 with time_loss: -8.58165168762207 and type_loss 9.577425956726074


  - (Training)   :  61%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                 | 74/121 [00:05<00:02, 17.53it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 1.2841877937316895 with time_loss: -6.560822010040283 and type_loss 7.845009803771973


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:05<00:02, 17.30it/s]



  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:03<06:08,  3.07s/it]
Test loss: -3.3206005096435547 with time_loss: -11.875072479248047 and type_loss 8.554471969604492

  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:05<00:02, 17.42it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -6.6875200271606445 with time_loss: -14.613218307495117 and type_loss 7.925698280334473
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:04<00:02, 17.79it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -5.608641624450684 with time_loss: -14.201151847839355 and type_loss 8.592510223388672




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Train loss: -6.873950481414795 with time_loss: -14.831603050231934 and type_loss 7.957652568817139
Test loss: -5.651410102844238 with time_loss: -13.89856243133545 and type_loss 8.247152328491211




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Train loss: -8.389388084411621 with time_loss: -15.74713134765625 and type_loss 7.357743263244629
Test loss: -8.142498016357422 with time_loss: -15.335246086120605 and type_loss 7.192747592926025
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 2.6991729736328125 with time_loss: -4.3014817237854 and type_loss 7.000654697418213



  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -1.291172981262207 with time_loss: -8.973052024841309 and type_loss 7.681879043579102


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -8.117111206054688 with time_loss: -15.466132164001465 and type_loss 7.349020481109619


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 3.496488571166992 with time_loss: -3.601778507232666 and type_loss 7.098267078399658



  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Train loss: -9.775416374206543 with time_loss: -16.46034049987793 and type_loss 6.684924125671387
Test loss: -5.034620761871338 with time_loss: -12.280851364135742 and type_loss 7.246230602264404




  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 2.655898094177246 with time_loss: -4.535206317901611 and type_loss 7.191104412078857



  - (Training)   :  62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 75/121 [00:04<00:02, 18.45it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -6.273391246795654 with time_loss: -13.357990264892578 and type_loss 7.084599018096924



  - (Training)   :  63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 76/121 [00:04<00:02, 18.66it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -7.336158752441406 with time_loss: -14.367266654968262 and type_loss 7.0311079025268555


  - (Training)   :  63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 76/121 [00:04<00:02, 18.69it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -8.953292846679688 with time_loss: -16.001861572265625 and type_loss 7.048569202423096
New best found!



  - (Training)   :  63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 76/121 [00:04<00:02, 18.63it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -5.237894058227539 with time_loss: -11.94079875946045 and type_loss 6.70290470123291


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -0.6140041351318359 with time_loss: -7.404713153839111 and type_loss 6.790709018707275


  - (Training)   :  62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 75/121 [00:04<00:02, 18.43it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 1.8183646202087402 with time_loss: -4.852027893066406 and type_loss 6.6703925132751465


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -4.358142852783203 with time_loss: -11.159597396850586 and type_loss 6.801454544067383



  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 0.9995365142822266 with time_loss: -5.603188514709473 and type_loss 6.602725028991699


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -3.4800782203674316 with time_loss: -10.110586166381836 and type_loss 6.630507946014404


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -4.093357563018799 with time_loss: -10.715879440307617 and type_loss 6.622521877288818


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -6.361304759979248 with time_loss: -12.924921035766602 and type_loss 6.5636162757873535


  - (Training)   :  62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 75/121 [00:04<00:02, 18.25it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -0.5555777549743652 with time_loss: -7.237260341644287 and type_loss 6.681682586669922


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 0.2327132225036621 with time_loss: -6.38584566116333 and type_loss 6.618558883666992


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 0.9395661354064941 with time_loss: -5.684237003326416 and type_loss 6.62380313873291



  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -2.774634838104248 with time_loss: -9.278695106506348 and type_loss 6.5040602684021


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: 2.322596549987793 with time_loss: -4.3078389167785645 and type_loss 6.630435466766357


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -3.4600629806518555 with time_loss: -9.959817886352539 and type_loss 6.499754905700684


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]

Test loss: -2.7763118743896484 with time_loss: -9.305030822753906 and type_loss 6.528718948364258
Best loss is: tensor(-8.9533, device='cuda:0')