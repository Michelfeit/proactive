Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'd_model': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 35, 'learning_rate': 7.488039722647997e-05, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 16, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:05<00:02, 18.50it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.7636165618896484 with time_loss: -12.53635025024414 and type_loss 10.772733688354492
New best found!



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -6.185388565063477 with time_loss: -14.610916137695312 and type_loss 8.425527572631836
New best found!


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:03<06:00,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -4.445179462432861 with time_loss: -12.300427436828613 and type_loss 7.855247974395752



  - (Training)   :  62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 75/121 [00:04<00:02, 18.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -6.548051834106445 with time_loss: -14.153449058532715 and type_loss 7.6053972244262695
New best found!



  - (Training)   :  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                    | 72/121 [00:05<00:02, 16.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -6.953721046447754 with time_loss: -14.515344619750977 and type_loss 7.561623573303223
New best found!


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:03<06:57,  3.48s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -5.3916449546813965 with time_loss: -12.47997760772705 and type_loss 7.088332653045654


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -1.8483457565307617 with time_loss: -8.878660202026367 and type_loss 7.0303144454956055


  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -7.2206950187683105 with time_loss: -14.307960510253906 and type_loss 7.087265491485596
New best found!



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.94it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -7.16982364654541 with time_loss: -14.188294410705566 and type_loss 7.018470764160156



  - (Training)   :  63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 76/121 [00:04<00:02, 18.69it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -9.102155685424805 with time_loss: -16.26759147644043 and type_loss 7.165435314178467
New best found!



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.97it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -7.838107109069824 with time_loss: -14.451236724853516 and type_loss 6.613129615783691


  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -9.266100883483887 with time_loss: -15.86914348602295 and type_loss 6.6030426025390625
New best found!



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.93it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -8.56138801574707 with time_loss: -15.19292163848877 and type_loss 6.631534099578857


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -9.037839889526367 with time_loss: -15.562787055969238 and type_loss 6.524947643280029



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -8.645709991455078 with time_loss: -15.078116416931152 and type_loss 6.432405948638916



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -6.9380950927734375 with time_loss: -13.48737621307373 and type_loss 6.549281120300293



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.96it/s]
Train loss: -11.99848747253418 with time_loss: -18.010326385498047 and type_loss 6.011838436126709
Test loss: -9.595390319824219 with time_loss: -16.01823616027832 and type_loss 6.422845840454102
New best found!



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -9.856983184814453 with time_loss: -16.452449798583984 and type_loss 6.595466136932373
New best found!




  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.98it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -10.545689582824707 with time_loss: -16.875812530517578 and type_loss 6.330122947692871
New best found!


  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Train loss: -12.405340194702148 with time_loss: -18.2846736907959 and type_loss 5.879333972930908
Test loss: -11.156558990478516 with time_loss: -17.564550399780273 and type_loss 6.4079909324646
New best found!


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -8.380531311035156 with time_loss: -14.6566743850708 and type_loss 6.276143550872803


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -8.108461380004883 with time_loss: -14.318814277648926 and type_loss 6.210352420806885



  - (Training)   :  63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 76/121 [00:04<00:02, 18.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -10.415436744689941 with time_loss: -16.66769027709961 and type_loss 6.252253532409668



  - (Training)   :  64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 77/121 [00:04<00:02, 18.93it/s]


  - (Training)   :   3%|██████▌                                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -7.783276081085205 with time_loss: -13.950237274169922 and type_loss 6.166961193084717


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:03<06:59,  3.50s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -4.759983539581299 with time_loss: -10.973438262939453 and type_loss 6.213454723358154


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:53,  2.95s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -10.013116836547852 with time_loss: -16.23701286315918 and type_loss 6.223896026611328


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -7.967634201049805 with time_loss: -14.100852966308594 and type_loss 6.133218765258789


  - (Training)   :   1%|█▋                                                                                                                                                                                                                | 1/121 [00:02<05:52,  2.94s/it]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -9.009260177612305 with time_loss: -15.27574634552002 and type_loss 6.266486167907715



  - (Training)   :  59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 71/121 [00:04<00:02, 17.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -10.3764009475708 with time_loss: -16.585298538208008 and type_loss 6.208897590637207



  - (Training)   :  59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                      | 71/121 [00:04<00:02, 17.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -10.391983032226562 with time_loss: -16.555885314941406 and type_loss 6.163902759552002



  - (Training)   :  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                    | 72/121 [00:04<00:02, 17.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -10.751943588256836 with time_loss: -16.8924503326416 and type_loss 6.140506744384766




  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:04<00:02, 17.86it/s]


  - (Training)   :   0%|                                                                                                                                                                                                                          | 0/121 [00:00<?, ?it/s]
Test loss: -9.393695831298828 with time_loss: -15.508681297302246 and type_loss 6.11498498916626


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:04<00:02, 17.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -9.54000473022461 with time_loss: -15.640754699707031 and type_loss 6.100749492645264



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                   | 73/121 [00:04<00:02, 17.81it/s]

  - (Training)   :   0%|                                                                                                                                                                                                                           | 0/32 [00:00<?, ?it/s]
Test loss: -11.768763542175293 with time_loss: -17.935354232788086 and type_loss 6.166590690612793
New best found!




  - (Training)   :  60%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                    | 72/121 [00:04<00:02, 17.67it/s]


Test loss: -9.95063304901123 with time_loss: -16.057546615600586 and type_loss 6.1069135665893555
Best loss is: tensor(-11.7688, device='cuda:0')