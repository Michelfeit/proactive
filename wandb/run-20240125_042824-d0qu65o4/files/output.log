Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:07<00:01, 16.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8647522926330566 with time_loss: -2.4813735485076904 and type_loss 3.346125841140747




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 0.7482271194458008 with time_loss: -2.498349666595459 and type_loss 3.2465767860412598
Test loss: 1.0435528755187988 with time_loss: -2.106470823287964 and type_loss 3.1500236988067627



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.9340033531188965 with time_loss: -2.1166224479675293 and type_loss 3.050625801086426



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.15250420570373535 with time_loss: -3.0361437797546387 and type_loss 2.8836395740509033
New best found!



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9280989170074463 with time_loss: -2.116013526916504 and type_loss 3.04411244392395



  - (Training)   :  41%|███████████████████████████████████████████████████████████████████████████████▎                                                                                                                | 50/121 [00:05<00:05, 11.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.28549695014953613 with time_loss: -2.529385805130005 and type_loss 2.814882755279541



  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 0.49131202697753906 with time_loss: -2.2916550636291504 and type_loss 2.7829670906066895



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.21224403381347656 with time_loss: -2.9939186573028564 and type_loss 2.78167462348938
New best found!



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.30870985984802246 with time_loss: -3.0676212310791016 and type_loss 2.758911371231079
New best found!




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:07<00:00, 19.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -0.4158518314361572 with time_loss: -3.176349639892578 and type_loss 2.760497808456421
New best found!




  - (Training)   :  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 105/121 [00:07<00:00, 17.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5894644260406494 with time_loss: -2.115292549133301 and type_loss 2.70475697517395




  - (Training)   :  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 92/121 [00:07<00:01, 15.86it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2157607078552246 with time_loss: -2.493831157684326 and type_loss 2.709591865539551



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.4863548278808594 with time_loss: -2.2396883964538574 and type_loss 2.726043224334717



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:04<00:03, 15.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9969584941864014 with time_loss: -3.7017369270324707 and type_loss 2.7047784328460693
New best found!



  - (Training)   :  36%|████████████████████████████████████████████████████████████████████▏                                                                                                                           | 43/121 [00:05<00:07, 10.25it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.40842294692993164 with time_loss: -3.1259686946868896 and type_loss 2.717545747756958




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 19.25it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.2464735507965088 with time_loss: -2.4489567279815674 and type_loss 2.695430278778076



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6422364711761475 with time_loss: -2.055042266845703 and type_loss 2.6972787380218506



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 15.07it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8469151258468628 with time_loss: -0.8863505125045776 and type_loss 2.7332656383514404



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.7859208583831787 with time_loss: -1.901982307434082 and type_loss 2.6879031658172607



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.34119534492492676 with time_loss: -2.380542755126953 and type_loss 2.72173810005188



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6973850727081299 with time_loss: -2.0018460750579834 and type_loss 2.6992311477661133



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.595015287399292 with time_loss: -2.088731288909912 and type_loss 2.683746576309204



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.515733242034912 with time_loss: -1.1638917922973633 and type_loss 2.6796250343322754



  - (Training)   :  36%|████████████████████████████████████████████████████████████████████▏                                                                                                                           | 43/121 [00:05<00:07, 10.26it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.30864691734313965 with time_loss: -2.360447406768799 and type_loss 2.6690943241119385




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 19.26it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.307990312576294 with time_loss: -1.3673408031463623 and type_loss 2.6753311157226562


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.14it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3919868469238281 with time_loss: -3.0834474563598633 and type_loss 2.691460609436035



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.95it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 3.0508904457092285 with time_loss: 0.37000608444213867 and type_loss 2.68088436126709



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.9641423225402832 with time_loss: -0.7184655070304871 and type_loss 2.682607889175415





Train loss: -1.388517141342163 with time_loss: -4.023838043212891 and type_loss 2.6353209018707275
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2059309482574463 with time_loss: -1.4783573150634766 and type_loss 2.684288263320923



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.43158483505249023 with time_loss: -2.238973379135132 and type_loss 2.670558214187622




  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:07<00:01, 16.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5178267955780029 with time_loss: -2.1340019702911377 and type_loss 2.6518287658691406



  - (Training)   :  37%|███████████████████████████████████████████████████████████████████████▍                                                                                                                        | 45/121 [00:05<00:07, 10.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.7800384759902954 with time_loss: -0.870808482170105 and type_loss 2.6508469581604004



  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.971821665763855 with time_loss: -1.6743484735488892 and type_loss 2.646170139312744




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 19.33it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.6766152381896973 with time_loss: -1.9747192859649658 and type_loss 2.651334524154663



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.17377948760986328 with time_loss: -2.820082187652588 and type_loss 2.6463027000427246



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.90it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.3328419923782349 with time_loss: -1.3101409673690796 and type_loss 2.6429829597473145




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.08s/it]
Test loss: 1.490208625793457 with time_loss: -1.1562352180480957 and type_loss 2.6464438438415527




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6366500854492188 with time_loss: -4.234296798706055 and type_loss 2.597646713256836
Test loss: -0.7937002182006836 with time_loss: -3.444676637649536 and type_loss 2.6509764194488525



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.118186593055725 with time_loss: -1.530523419380188 and type_loss 2.648710012435913




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 16.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.12988972663879395 with time_loss: -2.5090737342834473 and type_loss 2.638963460922241




  - (Training)   :  69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 84/121 [00:07<00:02, 14.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.2501952648162842 with time_loss: -2.8941898345947266 and type_loss 2.6439945697784424



  - (Training)   :  36%|████████████████████████████████████████████████████████████████████▏                                                                                                                           | 43/121 [00:05<00:07, 10.22it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.5033369064331055 with time_loss: -1.1407053470611572 and type_loss 2.6440422534942627




  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 19.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8873554468154907 with time_loss: -1.7592304944992065 and type_loss 2.6465859413146973



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.10it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 1.3582899570465088 with time_loss: -1.2830524444580078 and type_loss 2.6413424015045166



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.0507028102874756 with time_loss: -1.59096097946167 and type_loss 2.6416637897491455



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 1.4157191514968872 with time_loss: -1.2388590574264526 and type_loss 2.65457820892334



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.1895580291748047 with time_loss: -2.4531304836273193 and type_loss 2.642688512802124



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.00136137008667 with time_loss: -0.6388798952102661 and type_loss 2.6402413845062256




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.47979021072387695 with time_loss: -2.158750057220459 and type_loss 2.638540267944336





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.7838134765625 with time_loss: -4.369771957397461 and type_loss 2.585958480834961
Test loss: 1.9842181205749512 with time_loss: -0.6517729759216309 and type_loss 2.635991096496582

