
  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')


  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

New best found!
[ Epoch 1 ]

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.541649580001831 with time_loss: -3.0912461280822754 and type_loss 1.5495965480804443
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:06,  3.06s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2297377586364746 with time_loss: -2.6041860580444336 and type_loss 1.374448299407959


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.158784866333008 with time_loss: -3.5012741088867188 and type_loss 1.3424893617630005
New best found!



  - (Training)   :  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 91/121 [00:05<00:01, 21.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.295405864715576 with time_loss: -3.616511583328247 and type_loss 1.3211055994033813
New best found!



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.597872257232666 with time_loss: -3.0029356479644775 and type_loss 1.4050633907318115



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.29it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.38529670238494873 with time_loss: -1.6115801334381104 and type_loss 1.2262834310531616



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.7306535243988037 with time_loss: -3.003652334213257 and type_loss 1.2729988098144531



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.74it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.346923351287842 with time_loss: -3.6915457248687744 and type_loss 1.3446223735809326
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:08,  3.07s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.613461971282959 with time_loss: -3.8361175060272217 and type_loss 1.2226554155349731
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5436445474624634 with time_loss: -2.66981840133667 and type_loss 1.1261738538742065


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0014739036560059 with time_loss: -2.146716594696045 and type_loss 1.145242691040039



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.10it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.62337064743042 with time_loss: -2.737196683883667 and type_loss 1.113826036453247


  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -1.1316579580307007 with time_loss: -2.227144718170166 and type_loss 1.0954867601394653



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -1.9636234045028687 with time_loss: -3.084402084350586 and type_loss 1.1207786798477173



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:05<00:02, 18.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.6634347438812256 with time_loss: -2.7844858169555664 and type_loss 1.1210510730743408



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.22it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1475768089294434 with time_loss: -3.2792463302612305 and type_loss 1.131669521331787


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.05s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8306128978729248 with time_loss: -1.9230867624282837 and type_loss 1.0924738645553589


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:11,  3.10s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.746088743209839 with time_loss: -3.863816022872925 and type_loss 1.117727279663086
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:07,  3.06s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5759199857711792 with time_loss: -1.6572182178497314 and type_loss 1.0812982320785522


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:09,  3.08s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.702735185623169 with time_loss: -3.7803258895874023 and type_loss 1.0775907039642334



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -1.2165037393569946 with time_loss: -2.2964115142822266 and type_loss 1.079907774925232



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:05<00:01, 20.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -1.9191769361495972 with time_loss: -2.9891440868377686 and type_loss 1.0699671506881714



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:05<00:01, 21.00it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.6659270524978638 with time_loss: -1.7348333597183228 and type_loss 1.068906307220459

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7115970849990845 with time_loss: -2.8228254318237305 and type_loss 1.111228346824646



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.6325366497039795 with time_loss: -4.6013712882995605 and type_loss 0.9688345789909363
Test loss: -2.3932571411132812 with time_loss: -3.4658474922180176 and type_loss 1.0725903511047363


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.483263611793518 with time_loss: -2.577591896057129 and type_loss 1.0943282842636108


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7414273023605347 with time_loss: -2.8007559776306152 and type_loss 1.0593286752700806


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.03s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -1.3660975694656372 with time_loss: -2.4705023765563965 and type_loss 1.1044048070907593



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.21it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -1.37940514087677 with time_loss: -2.463151693344116 and type_loss 1.0837465524673462



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:05<00:02, 19.00it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.757799506187439 with time_loss: -2.8175883293151855 and type_loss 1.0597888231277466



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.961827278137207 with time_loss: -4.862273216247559 and type_loss 0.9004459381103516
Test loss: -2.2553248405456543 with time_loss: -3.3060739040374756 and type_loss 1.0507491827011108



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.9353294372558594 with time_loss: -4.838355541229248 and type_loss 0.9030261039733887
Test loss: -0.740950345993042 with time_loss: -1.7908668518066406 and type_loss 1.0499165058135986


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6495102643966675 with time_loss: -2.69411563873291 and type_loss 1.0446053743362427


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.377243161201477 with time_loss: -2.4292001724243164 and type_loss 1.0519570112228394



  - (Training)   :  65%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 79/121 [00:05<00:02, 19.06it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5749099254608154 with time_loss: -1.6354999542236328 and type_loss 1.0605900287628174



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:05<00:01, 20.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.063997507095337 with time_loss: -2.129438638687134 and type_loss 1.0654411315917969



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.33it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.5440624952316284 with time_loss: -1.619766116142273 and type_loss 1.0757036209106445


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.072418689727783 with time_loss: -4.964527606964111 and type_loss 0.8921089172363281
Test loss: -0.7611156702041626 with time_loss: -1.8143798112869263 and type_loss 1.0532641410827637



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.09332799911499 with time_loss: -4.984101295471191 and type_loss 0.8907734155654907
Test loss: -0.6598514318466187 with time_loss: -1.732297420501709 and type_loss 1.0724459886550903


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2801021337509155 with time_loss: -2.3440933227539062 and type_loss 1.0639911890029907


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.646521806716919 with time_loss: -1.7081503868103027 and type_loss 1.0616285800933838



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:05<00:01, 20.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -1.094077229499817 with time_loss: -2.158493995666504 and type_loss 1.064416766166687



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.041771411895752 with time_loss: -3.114269256591797 and type_loss 1.0724979639053345



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.230844974517822 with time_loss: -5.089414596557617 and type_loss 0.8585697412490845
Test loss: -1.7487528324127197 with time_loss: -2.818295478820801 and type_loss 1.069542646408081


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:06,  3.05s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6685045957565308 with time_loss: -1.7325900793075562 and type_loss 1.0640854835510254


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5911914110183716 with time_loss: -1.6484323740005493 and type_loss 1.0572409629821777



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -0.8173859119415283 with time_loss: -1.8861545324325562 and type_loss 1.0687686204910278



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.25it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -0.5813069343566895 with time_loss: -1.6512130498886108 and type_loss 1.0699061155319214



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.61it/s]


Test loss: -0.8887670040130615 with time_loss: -1.9555115699768066 and type_loss 1.0667445659637451
Best loss is: tensor(-2.7461, device='cuda:0')