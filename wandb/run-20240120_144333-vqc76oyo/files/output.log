Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'd_model': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 2.5e-05, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 8, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.684064507484436 with time_loss: -3.3589251041412354 and type_loss 1.6748605966567993
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.8847236633300781 with time_loss: -3.4053306579589844 and type_loss 1.5206069946289062
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.23it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1711721420288086 with time_loss: -3.509249687194824 and type_loss 1.338077425956726
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6688047647476196 with time_loss: -2.994462251663208 and type_loss 1.3256574869155884



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.604956865310669 with time_loss: -3.884711503982544 and type_loss 1.279754638671875
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2471671104431152 with time_loss: -3.5492360591888428 and type_loss 1.3020689487457275


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:59,  2.99s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6716468334198 with time_loss: -3.96832013130188 and type_loss 1.29667329788208
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9875737428665161 with time_loss: -2.19576096534729 and type_loss 1.208187222480774



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.18it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.685616970062256 with time_loss: -3.884483814239502 and type_loss 1.198866844177246
New best found!



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.80it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.0987415313720703 with time_loss: -3.285026788711548 and type_loss 1.186285138130188



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.75015926361084 with time_loss: -3.8552048206329346 and type_loss 1.1050455570220947
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.31it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -2.0868542194366455 with time_loss: -3.190913438796997 and type_loss 1.1040592193603516



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.473900556564331 with time_loss: -3.6034388542175293 and type_loss 1.1295382976531982


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5856618881225586 with time_loss: -3.7134571075439453 and type_loss 1.1277951002120972


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6557426452636719 with time_loss: -1.750172734260559 and type_loss 1.0944300889968872



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.613317608833313 with time_loss: -1.7058898210525513 and type_loss 1.0925722122192383



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3641223907470703 with time_loss: -3.453148365020752 and type_loss 1.089025855064392


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.31it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.9204180240631104 with time_loss: -2.9950942993164062 and type_loss 1.074676275253296


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -1.8516491651535034 with time_loss: -2.9628894329071045 and type_loss 1.111240267753601



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -2.88236141204834 with time_loss: -3.962200164794922 and type_loss 1.079838752746582
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8850090503692627 with time_loss: -2.9582929611206055 and type_loss 1.0732839107513428



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.01it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.70987868309021 with time_loss: -3.7798123359680176 and type_loss 1.0699336528778076



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.704322338104248 with time_loss: -4.676260948181152 and type_loss 0.9719385504722595
Test loss: -2.4558472633361816 with time_loss: -3.5202927589416504 and type_loss 1.0644453763961792



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.711137533187866 with time_loss: -4.682682037353516 and type_loss 0.9715444445610046
Test loss: -2.683600664138794 with time_loss: -3.7391724586486816 and type_loss 1.0555717945098877



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.0593886375427246 with time_loss: -4.114961624145508 and type_loss 1.0555728673934937
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.07it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -1.8735365867614746 with time_loss: -2.925936460494995 and type_loss 1.0523998737335205



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.6605721712112427 with time_loss: -2.7176084518432617 and type_loss 1.057036280632019



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.78it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.9089393615722656 with time_loss: -2.954240560531616 and type_loss 1.0453011989593506



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.29it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4669065475463867 with time_loss: -3.530573606491089 and type_loss 1.0636669397354126



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.05it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3796424865722656 with time_loss: -2.4403889179229736 and type_loss 1.060746431350708



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.87it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.909715175628662 with time_loss: -2.9572463035583496 and type_loss 1.0475311279296875


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1927576065063477 with time_loss: -2.2388648986816406 and type_loss 1.046107292175293



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.031325340270996 with time_loss: -4.947996139526367 and type_loss 0.9166706204414368
Test loss: -2.1103034019470215 with time_loss: -3.1564853191375732 and type_loss 1.0461819171905518



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.6511173248291016 with time_loss: -3.6997880935668945 and type_loss 1.0486708879470825


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3950390815734863 with time_loss: -3.436058521270752 and type_loss 1.041019320487976


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.10909366607666 with time_loss: -3.1480696201324463 and type_loss 1.0389759540557861



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.05it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.539407730102539 with time_loss: -3.5936877727508545 and type_loss 1.054280161857605



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.511861801147461 with time_loss: -3.5553176403045654 and type_loss 1.043455719947815



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3828916549682617 with time_loss: -3.426819324493408 and type_loss 1.0439276695251465



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0933265686035156 with time_loss: -3.136362075805664 and type_loss 1.043035626411438



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.227126598358154 with time_loss: -5.106066703796387 and type_loss 0.8789399266242981
Test loss: -1.7361223697662354 with time_loss: -2.771557092666626 and type_loss 1.0354347229003906



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.251302719116211 with time_loss: -5.124362468719482 and type_loss 0.8730595111846924
Test loss: -1.7494739294052124 with time_loss: -2.7872958183288574 and type_loss 1.037821888923645



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.928239345550537 with time_loss: -2.968997001647949 and type_loss 1.040757656097412


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.32it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3916139602661133 with time_loss: -3.436393976211548 and type_loss 1.044779896736145



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.205291748046875 with time_loss: -3.250587224960327 and type_loss 1.0452955961227417



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.00it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.185098648071289 with time_loss: -3.2279648780822754 and type_loss 1.0428662300109863



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4834582805633545 with time_loss: -3.527150869369507 and type_loss 1.0436925888061523



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.10it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4008431434631348 with time_loss: -2.4443726539611816 and type_loss 1.0435295104980469



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.196115732192993 with time_loss: -3.23565411567688 and type_loss 1.0395383834838867





Train loss: -4.3049235343933105 with time_loss: -5.178401947021484 and type_loss 0.8734782338142395
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5841854810714722 with time_loss: -2.624772548675537 and type_loss 1.040587067604065

