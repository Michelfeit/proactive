Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 6, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:04<00:04, 13.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.36876416206359863 with time_loss: -2.694533348083496 and type_loss 3.0632975101470947





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 0.05308079719543457 with time_loss: -2.9399068355560303 and type_loss 2.992987632751465
Test loss: -0.4425475597381592 with time_loss: -3.2630646228790283 and type_loss 2.820517063140869
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.5987038612365723 with time_loss: -2.3773751258850098 and type_loss 2.976078987121582




  - (Training)   :  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 117/121 [00:07<00:00, 20.24it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7864320278167725 with time_loss: -2.219763994216919 and type_loss 3.0061960220336914



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.37094759941101074 with time_loss: -2.5750892162323 and type_loss 2.9460368156433105



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8774313926696777 with time_loss: -2.1173813343048096 and type_loss 2.9948127269744873



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.005653858184814453 with time_loss: -2.9706690311431885 and type_loss 2.976322889328003



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7691004276275635 with time_loss: -2.215474843978882 and type_loss 2.9845752716064453




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.13it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.1916828155517578 with time_loss: -2.7010250091552734 and type_loss 2.8927078247070312




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.25375843048095703 with time_loss: -2.6127984523773193 and type_loss 2.8665568828582764



  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 118/121 [00:06<00:00, 20.48it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.32250285148620605 with time_loss: -3.1805694103240967 and type_loss 2.8580665588378906


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.42it/s]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.900004506111145 with time_loss: -1.946550726890564 and type_loss 2.846555233001709


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.45078182220458984 with time_loss: -2.412435293197632 and type_loss 2.8632171154022217



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:04<00:04, 13.99it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.6935231685638428 with time_loss: -2.1373674869537354 and type_loss 2.830890655517578



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.183911681175232 with time_loss: -1.6789485216140747 and type_loss 2.8628602027893066



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -0.30042004585266113 with time_loss: -3.1393957138061523 and type_loss 2.838975667953491



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.001877784729004 with time_loss: -1.8680622577667236 and type_loss 2.8699400424957275




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.15it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9658889770507812 with time_loss: -1.9138638973236084 and type_loss 2.8797528743743896



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -0.4998748302459717 with time_loss: -3.317234516143799 and type_loss 2.817359685897827
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.43it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8462421894073486 with time_loss: -3.675701379776001 and type_loss 2.8294591903686523
New best found!



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.035396575927734375 with time_loss: -2.758071184158325 and type_loss 2.7934677600860596



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6988229751586914 with time_loss: -2.116286039352417 and type_loss 2.8151090145111084



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.35it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.30539608001708984 with time_loss: -2.4901812076568604 and type_loss 2.79557728767395



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.282219409942627 with time_loss: -0.5278244614601135 and type_loss 2.8100438117980957




  - (Training)   :  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 117/121 [00:06<00:00, 20.31it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3570113182067871 with time_loss: -3.1757943630218506 and type_loss 2.8187830448150635




  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2838120460510254 with time_loss: -1.4970223903656006 and type_loss 2.780834436416626




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1453754901885986 with time_loss: -1.6430599689483643 and type_loss 2.788435459136963



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: 0.17076945304870605 with time_loss: -2.6499006748199463 and type_loss 2.8206701278686523



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.36it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3897206783294678 with time_loss: -3.186596632003784 and type_loss 2.7968759536743164



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.3232429027557373 with time_loss: -2.449786424636841 and type_loss 2.773029327392578



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2632322311401367 with time_loss: -2.5047473907470703 and type_loss 2.767979621887207




  - (Training)   :  95%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 115/121 [00:06<00:00, 20.11it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.28443455696105957 with time_loss: -2.4963533878326416 and type_loss 2.780787944793701


  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.3351168632507324 with time_loss: -1.464691400527954 and type_loss 2.7998082637786865




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3838987350463867 with time_loss: -4.099745273590088 and type_loss 2.715846538543701
Test loss: 0.10504531860351562 with time_loss: -2.6902036666870117 and type_loss 2.7952489852905273



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.3266582489013672 with time_loss: -1.4506053924560547 and type_loss 2.777263641357422




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3800504207611084 with time_loss: -4.091038703918457 and type_loss 2.7109882831573486
Test loss: -0.12126469612121582 with time_loss: -2.8988912105560303 and type_loss 2.7776265144348145



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.21715140342712402 with time_loss: -2.5521230697631836 and type_loss 2.7692744731903076



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0144023895263672 with time_loss: -1.7728095054626465 and type_loss 2.7872118949890137



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.22it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.629194974899292 with time_loss: -2.1784045696258545 and type_loss 2.8075995445251465



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1437313556671143 with time_loss: -1.6498746871948242 and type_loss 2.7936060428619385




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 118/121 [00:06<00:00, 20.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.580808162689209 with time_loss: -2.197972536087036 and type_loss 2.778780698776245



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: 1.3018015623092651 with time_loss: -1.4933704137802124 and type_loss 2.7951719760894775



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9350688457489014 with time_loss: -1.8480017185211182 and type_loss 2.7830705642700195



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.1073013544082642 with time_loss: -1.6872164011001587 and type_loss 2.794517755508423



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4170997142791748 with time_loss: -1.3702032566070557 and type_loss 2.7873029708862305



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:04<00:04, 14.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.46532297134399414 with time_loss: -2.3216309547424316 and type_loss 2.786953926086426



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.41it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9907644987106323 with time_loss: -1.7837282419204712 and type_loss 2.7744927406311035





Train loss: -1.484510898590088 with time_loss: -4.1910529136657715 and type_loss 2.7065420150756836
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2552694082260132 with time_loss: -1.534169316291809 and type_loss 2.7894387245178223



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:04<00:04, 14.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0309704542160034 with time_loss: -1.7400442361831665 and type_loss 2.77101469039917




  - (Training)   :  96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████        | 116/121 [00:06<00:00, 20.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3742544651031494 with time_loss: -1.4043006896972656 and type_loss 2.778555154800415

