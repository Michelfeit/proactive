Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 4, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.00it/s]



  - (Training)   :  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                | 24/32 [00:05<00:01,  5.68it/s]
Test loss: 1.631901502609253 with time_loss: -2.077864646911621 and type_loss 3.709766149520874





  - (Training)   :  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊   | 119/121 [00:09<00:00, 18.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3482961654663086 with time_loss: -2.7775766849517822 and type_loss 3.125872850418091







  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:13<00:03,  8.33it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.4679315090179443 with time_loss: -1.5623672008514404 and type_loss 3.0302987098693848








  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:15<00:00,  8.56it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.287112832069397 with time_loss: -1.7168532609939575 and type_loss 3.0039660930633545







  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:15<00:00,  8.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.30672669410705566 with time_loss: -3.31577730178833 and type_loss 3.0090506076812744
New best found!







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:03,  8.33it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.07320570945739746 with time_loss: -2.8684587478637695 and type_loss 2.941664457321167








  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:15<00:01,  8.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.7100675106048584 with time_loss: -2.2589316368103027 and type_loss 2.968999147415161







  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:13<00:03,  8.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3074172735214233 with time_loss: -1.659157395362854 and type_loss 2.9665746688842773







  - (Training)   :  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 93/121 [00:13<00:03,  8.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5667023658752441 with time_loss: -2.325084686279297 and type_loss 2.891787052154541







  - (Training)   :  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 94/121 [00:13<00:03,  8.36it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.021183252334594727 with time_loss: -2.917393684387207 and type_loss 2.8962104320526123








  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:15<00:01,  8.51it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.5761163234710693 with time_loss: -2.2550320625305176 and type_loss 2.831148386001587







  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:15<00:00,  8.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 1.2781908512115479 with time_loss: -1.5514554977416992 and type_loss 2.829646348953247








  - (Training)   :  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 113/121 [00:15<00:00,  8.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.13468599319458 with time_loss: -0.7070486545562744 and type_loss 2.8417346477508545








  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:15<00:00,  8.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 0.2131052017211914 with time_loss: -2.605193614959717 and type_loss 2.818298816680908







  - (Training)   :  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 94/121 [00:13<00:03,  8.32it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.373936414718628 with time_loss: -1.506251573562622 and type_loss 2.88018798828125







  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:13<00:03,  8.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4857308864593506 with time_loss: -3.337449312210083 and type_loss 2.8517184257507324
New best found!







  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:13<00:03,  8.32it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.30159878730773926 with time_loss: -3.1485695838928223 and type_loss 2.846970796585083








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.0726171731948853 with time_loss: -1.7728384733200073 and type_loss 2.8454556465148926







  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:15<00:01,  8.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.14541387557983398 with time_loss: -3.030120372772217 and type_loss 2.884706497192383








  - (Training)   :  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 113/121 [00:15<00:00,  8.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.1984522342681885 with time_loss: -1.6623210906982422 and type_loss 2.8607733249664307



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.745015263557434 with time_loss: -1.0628269910812378 and type_loss 2.807842254638672



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.82it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.210403919219971 with time_loss: 1.4054688215255737 and type_loss 2.8049352169036865


  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.93it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.611483097076416 with time_loss: -2.1916515827178955 and type_loss 2.8031346797943115




  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.15it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.9707576036453247 with time_loss: -0.8383680582046509 and type_loss 2.8091256618499756



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.1698236465454102 with time_loss: -3.9309799671173096 and type_loss 2.7611563205718994
Test loss: 1.833759069442749 with time_loss: -0.9443328976631165 and type_loss 2.7780919075012207


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.5174129009246826 with time_loss: -0.31061819195747375 and type_loss 2.828031063079834



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 2.111481189727783 with time_loss: -0.6866039037704468 and type_loss 2.7980849742889404



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.16998982429504395 with time_loss: -2.9764466285705566 and type_loss 2.8064568042755127



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 19.01it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 0.13825035095214844 with time_loss: -2.7100117206573486 and type_loss 2.848262071609497



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.87it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 3.1786088943481445 with time_loss: 0.3628576993942261 and type_loss 2.815751075744629



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.93it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.1798009872436523 with time_loss: -0.6088904142379761 and type_loss 2.788691520690918


  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.8087728023529053 with time_loss: 0.0030403356067836285 and type_loss 2.805732488632202



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.448699951171875 with time_loss: -4.168401718139648 and type_loss 2.7197017669677734
Test loss: 2.901420831680298 with time_loss: 0.09373792260885239 and type_loss 2.807682991027832



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4214282035827637 with time_loss: -4.139639377593994 and type_loss 2.7182111740112305
Test loss: 2.6727843284606934 with time_loss: -0.15131676197052002 and type_loss 2.824100971221924



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.7257583141326904 with time_loss: -0.061965495347976685 and type_loss 2.7877237796783447


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.9430091381073 with time_loss: 0.130289688706398 and type_loss 2.8127193450927734



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 2.929926872253418 with time_loss: 0.11332499980926514 and type_loss 2.8166017532348633



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:04<00:02, 18.05it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 3.1342241764068604 with time_loss: 0.3444988429546356 and type_loss 2.7897253036499023



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 3.2225794792175293 with time_loss: 0.4238399267196655 and type_loss 2.798739433288574



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.86it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.244422197341919 with time_loss: 0.3761231601238251 and type_loss 2.8682990074157715


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4996802806854248 with time_loss: -4.207434177398682 and type_loss 2.707753896713257
Test loss: 2.521495819091797 with time_loss: -0.2728222608566284 and type_loss 2.794318199157715



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.3637821674346924 with time_loss: -0.44156473875045776 and type_loss 2.805346965789795



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.529198408126831 with time_loss: -4.2233991622924805 and type_loss 2.6942007541656494
Test loss: 2.585662841796875 with time_loss: -0.1922709196805954 and type_loss 2.7779338359832764



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5618557929992676 with time_loss: -4.261582851409912 and type_loss 2.6997270584106445
Test loss: 3.033996105194092 with time_loss: 0.2558823823928833 and type_loss 2.778113603591919



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.201395034790039 with time_loss: 0.3915978670120239 and type_loss 2.8097972869873047



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 3.014003038406372 with time_loss: 0.2334183007478714 and type_loss 2.7805848121643066



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 3.1254544258117676 with time_loss: 0.335392028093338 and type_loss 2.790062427520752



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:04<00:03, 16.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 2.704554319381714 with time_loss: -0.07325197756290436 and type_loss 2.777806282043457



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.87it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.7665250301361084 with time_loss: -0.038123663514852524 and type_loss 2.8046486377716064


  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.09it/s]


Test loss: 2.6501011848449707 with time_loss: -0.13770879805088043 and type_loss 2.7878100872039795
Best loss is: tensor(-0.4857, device='cuda:0')