Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'd_model': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 32, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:03, 16.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.97s/it]
Test loss: -1.6794167757034302 with time_loss: -3.4716765880584717 and type_loss 1.7922598123550415
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.07it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.9918241500854492 with time_loss: -3.460562229156494 and type_loss 1.468738079071045
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.25it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0831313133239746 with time_loss: -3.419740915298462 and type_loss 1.3366094827651978
New best found!



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1937625408172607 with time_loss: -3.4572484493255615 and type_loss 1.2634859085083008
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7699992656707764 with time_loss: -3.0618159770965576 and type_loss 1.2918167114257812



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.09it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0041236877441406 with time_loss: -3.2207326889038086 and type_loss 1.2166091203689575



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.564368963241577 with time_loss: -3.853473424911499 and type_loss 1.2891044616699219
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.30it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4300574064254761 with time_loss: -1.6791431903839111 and type_loss 1.249085783958435



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -2.008378505706787 with time_loss: -3.226717710494995 and type_loss 1.2183390855789185



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.8214722871780396 with time_loss: -3.0785396099090576 and type_loss 1.257067322731018



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -0.2772630453109741 with time_loss: -1.405959129333496 and type_loss 1.128696084022522



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.0839905738830566 with time_loss: -3.221376657485962 and type_loss 1.1373859643936157



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.05it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.320108652114868 with time_loss: -3.4254791736602783 and type_loss 1.1053705215454102



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.06it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.340733528137207 with time_loss: -3.454643964767456 and type_loss 1.113910436630249




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.2264275550842285 with time_loss: -4.302667140960693 and type_loss 1.0762397050857544
Test loss: -1.6702687740325928 with time_loss: -2.787583351135254 and type_loss 1.1173145771026611



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.2413291931152344 with time_loss: -4.301827430725098 and type_loss 1.0604983568191528
Test loss: -1.7187753915786743 with time_loss: -2.8167724609375 and type_loss 1.0979970693588257



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.03it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5027107000350952 with time_loss: -2.6321983337402344 and type_loss 1.1294876337051392


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.00it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3861002922058105 with time_loss: -3.515390157699585 and type_loss 1.129289984703064


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -2.715794324874878 with time_loss: -3.794349193572998 and type_loss 1.0785548686981201
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.29it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.686547040939331 with time_loss: -2.7692883014678955 and type_loss 1.0827412605285645



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0167267322540283 with time_loss: -3.0971882343292236 and type_loss 1.0804615020751953




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.5665106773376465 with time_loss: -4.549957275390625 and type_loss 0.983446478843689
Test loss: -1.7707610130310059 with time_loss: -2.851022481918335 and type_loss 1.080261468887329



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.6499404907226562 with time_loss: -4.629772663116455 and type_loss 0.9798322916030884
Test loss: -2.015972137451172 with time_loss: -3.0731401443481445 and type_loss 1.057167887687683



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.9739502668380737 with time_loss: -3.0473477840423584 and type_loss 1.0733975172042847


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.2019290924072266 with time_loss: -3.25992488861084 and type_loss 1.0579957962036133



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.35it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.220676898956299 with time_loss: -3.287257432937622 and type_loss 1.0665805339813232



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.339761257171631 with time_loss: -3.399610996246338 and type_loss 1.0598498582839966



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.8334827423095703 with time_loss: -3.876746654510498 and type_loss 1.0432639122009277
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.09it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6736679077148438 with time_loss: -3.7243332862854004 and type_loss 1.050665259361267



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.04it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6365559101104736 with time_loss: -2.6860885620117188 and type_loss 1.0495326519012451




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.8968851566314697 with time_loss: -4.817420959472656 and type_loss 0.9205357432365417
Test loss: -1.4262926578521729 with time_loss: -2.473324775695801 and type_loss 1.047032117843628




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.9348950386047363 with time_loss: -4.857738494873047 and type_loss 0.9228435754776001
Test loss: -1.7121336460113525 with time_loss: -2.7510507106781006 and type_loss 1.038917064666748




Train loss: -3.9712412357330322 with time_loss: -4.882028579711914 and type_loss 0.9107873439788818

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.141159772872925 with time_loss: -3.176574230194092 and type_loss 1.035414457321167


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.786083698272705 with time_loss: -2.821829080581665 and type_loss 1.03574538230896



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.06it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -1.8535139560699463 with time_loss: -2.8875248432159424 and type_loss 1.034010887145996



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.5613092184066772 with time_loss: -2.605349540710449 and type_loss 1.044040322303772



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.78it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.743456482887268 with time_loss: -2.7750329971313477 and type_loss 1.0315765142440796



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.09it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5216870307922363 with time_loss: -3.559061050415039 and type_loss 1.0373739004135132




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.066308498382568 with time_loss: -4.971246719360352 and type_loss 0.9049382209777832
Test loss: -1.6244502067565918 with time_loss: -2.6522586345672607 and type_loss 1.027808427810669




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.080052375793457 with time_loss: -4.985664367675781 and type_loss 0.9056118130683899
Test loss: -2.4654979705810547 with time_loss: -3.497500419616699 and type_loss 1.0320024490356445



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.128133296966553 with time_loss: -5.015636444091797 and type_loss 0.8875033259391785
Test loss: -2.3603553771972656 with time_loss: -3.3828587532043457 and type_loss 1.0225034952163696



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.8426539897918701 with time_loss: -2.874061346054077 and type_loss 1.031407356262207


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.055737853050232 with time_loss: -2.0949912071228027 and type_loss 1.0392533540725708



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.02it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.1821787357330322 with time_loss: -3.215468168258667 and type_loss 1.0332894325256348



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.5106778144836426 with time_loss: -2.5370736122131348 and type_loss 1.0263957977294922



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8600587844848633 with time_loss: -2.8961336612701416 and type_loss 1.0360748767852783



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.29it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8306279182434082 with time_loss: -2.8534440994262695 and type_loss 1.0228161811828613




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.243231773376465 with time_loss: -5.126636028289795 and type_loss 0.8834040760993958
Test loss: -1.9531103372573853 with time_loss: -2.974386692047119 and type_loss 1.0212763547897339



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.2535271644592285 with time_loss: -5.131325721740723 and type_loss 0.8777983784675598
Test loss: -1.9946597814559937 with time_loss: -3.0243632793426514 and type_loss 1.0297034978866577



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.235442161560059 with time_loss: -5.101902484893799 and type_loss 0.8664604425430298
Test loss: -1.2328890562057495 with time_loss: -2.2658793926239014 and type_loss 1.0329903364181519

