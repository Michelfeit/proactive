Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.86it/s]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2101801633834839 with time_loss: -2.8014893531799316 and type_loss 1.5913091897964478
New best found!


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.50it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6915171146392822 with time_loss: -3.043485403060913 and type_loss 1.3519682884216309
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:09,  3.08s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3274579048156738 with time_loss: -2.6500277519226074 and type_loss 1.3225698471069336


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:08,  3.07s/it]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.711436152458191 with time_loss: -3.0150957107543945 and type_loss 1.3036595582962036
New best found!


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.11it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.11s/it]
Test loss: -1.8233712911605835 with time_loss: -3.1141979694366455 and type_loss 1.290826678276062
New best found!



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4211807250976562 with time_loss: -3.624854564666748 and type_loss 1.2036737203598022
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:14,  3.12s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7099868059158325 with time_loss: -2.9217121601104736 and type_loss 1.2117253541946411




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: -2.713249683380127 with time_loss: -3.9378206729888916 and type_loss 1.2245711088180542
New best found!



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.25it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.034785747528076 with time_loss: -4.217825412750244 and type_loss 1.1830397844314575
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:14,  3.12s/it]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.309203624725342 with time_loss: -3.5616462230682373 and type_loss 1.252442717552185


  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.42it/s]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5555096864700317 with time_loss: -2.661334991455078 and type_loss 1.1058253049850464


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.08s/it]
Test loss: -2.5067806243896484 with time_loss: -3.589127540588379 and type_loss 1.082346796989441


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:13,  3.12s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8899208307266235 with time_loss: -2.9746992588043213 and type_loss 1.0847784280776978



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.07s/it]
Test loss: -2.0219995975494385 with time_loss: -3.1208527088165283 and type_loss 1.0988531112670898



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.01it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.10s/it]
Test loss: -2.710702896118164 with time_loss: -3.8138654232025146 and type_loss 1.1031626462936401



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7949206829071045 with time_loss: -3.884805679321289 and type_loss 1.0898849964141846


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:18,  3.15s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4707040786743164 with time_loss: -3.5507829189300537 and type_loss 1.0800788402557373



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 15.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.5180583000183105 with time_loss: -3.5790107250213623 and type_loss 1.0609525442123413



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:04, 14.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -1.8015605211257935 with time_loss: -2.866035223007202 and type_loss 1.0644747018814087



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3306360244750977 with time_loss: -3.4325971603393555 and type_loss 1.1019611358642578



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: -2.2988715171813965 with time_loss: -3.3378589153289795 and type_loss 1.0389875173568726



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.13it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3202576637268066 with time_loss: -3.35382342338562 and type_loss 1.0335657596588135



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.548898458480835 with time_loss: -1.5619158744812012 and type_loss 1.0130174160003662



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7795462608337402 with time_loss: -3.7982254028320312 and type_loss 1.0186790227890015



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -2.3216300010681152 with time_loss: -3.343787431716919 and type_loss 1.0221573114395142



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.073239803314209 with time_loss: -4.094504356384277 and type_loss 1.0212645530700684
New best found!



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.073484420776367 with time_loss: -3.0983903408050537 and type_loss 1.0249059200286865



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.81it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7128159999847412 with time_loss: -2.71850848197937 and type_loss 1.005692481994629



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9341881275177002 with time_loss: -2.948894500732422 and type_loss 1.0147063732147217



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:37,  3.14s/it]
Test loss: -2.4501898288726807 with time_loss: -3.4651050567626953 and type_loss 1.0149152278900146



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.12s/it]
Test loss: -2.0256190299987793 with time_loss: -3.01853084564209 and type_loss 0.9929119348526001





Train loss: -4.168204307556152 with time_loss: -5.041937828063965 and type_loss 0.8737336993217468
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4045283794403076 with time_loss: -3.3929359912872314 and type_loss 0.9884076714515686



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -1.4822919368743896 with time_loss: -2.473207473754883 and type_loss 0.9909155368804932



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.3829445838928223 with time_loss: -4.384908199310303 and type_loss 1.00196373462677
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.224415302276611 with time_loss: -5.097417831420898 and type_loss 0.8730024099349976
Test loss: -2.396742343902588 with time_loss: -3.387239933013916 and type_loss 0.9904975891113281



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.573075771331787 with time_loss: -2.557992935180664 and type_loss 0.984917163848877



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:05<00:03, 15.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.174832344055176 with time_loss: -3.161761522293091 and type_loss 0.9869291186332703



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:05<00:03, 15.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4603536128997803 with time_loss: -2.4498000144958496 and type_loss 0.9894463419914246



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.87it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7157559394836426 with time_loss: -3.7076237201690674 and type_loss 0.9918676614761353



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3999040126800537 with time_loss: -2.389589548110962 and type_loss 0.9896854758262634



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4390368461608887 with time_loss: -3.4262917041778564 and type_loss 0.9872547388076782



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4749071598052979 with time_loss: -2.4576120376586914 and type_loss 0.9827048182487488



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.923174500465393 with time_loss: -2.907504081726074 and type_loss 0.9843295812606812



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0403616428375244 with time_loss: -3.025947093963623 and type_loss 0.9855855107307434



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.434985637664795 with time_loss: -5.282524108886719 and type_loss 0.8475385904312134
Test loss: -1.9112894535064697 with time_loss: -2.908820152282715 and type_loss 0.9975306987762451



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.9320075511932373 with time_loss: -2.917173385620117 and type_loss 0.9851658940315247



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6580469608306885 with time_loss: -3.6423070430755615 and type_loss 0.984260082244873




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3256211280822754 with time_loss: -3.3152718544006348 and type_loss 0.9896507263183594


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.16it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.726452112197876 with time_loss: -2.7088611125946045 and type_loss 0.9824090600013733


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.319206714630127 with time_loss: -3.297776699066162 and type_loss 0.9785698652267456

