Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 1.5002937316894531 with time_loss: -2.034259796142578 and type_loss 3.5345535278320312
Test loss: 0.45734477043151855 with time_loss: -2.645369291305542 and type_loss 3.1027140617370605



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.9081687927246094 with time_loss: -2.0781633853912354 and type_loss 2.9863321781158447



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.57it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.08395171165466309 with time_loss: -2.8243472576141357 and type_loss 2.908298969268799



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.07s/it]
Test loss: 0.5489842891693115 with time_loss: -2.514025926589966 and type_loss 3.0630102157592773



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.016649723052978516 with time_loss: -3.052615165710449 and type_loss 3.0692648887634277



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 13.02it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.21355628967285156 with time_loss: -2.6989967823028564 and type_loss 2.912553071975708



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -0.1475825309753418 with time_loss: -3.104921817779541 and type_loss 2.957339286804199
New best found!



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.06411528587341309 with time_loss: -2.810696840286255 and type_loss 2.874812126159668




  - (Training)   : 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 121/121 [00:07<00:00, 20.87it/s]


Test loss: -0.0943753719329834 with time_loss: -2.9913198947906494 and type_loss 2.896944522857666
[ Epoch 9 ]


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7060849666595459 with time_loss: -2.2697362899780273 and type_loss 2.9758212566375732



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.314162015914917 with time_loss: -2.5495383739471436 and type_loss 2.8637003898620605




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.9269833564758301 with time_loss: -3.729292631149292 and type_loss 2.802309274673462
Test loss: 0.6718671321868896 with time_loss: -2.2001874446868896 and type_loss 2.8720545768737793



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: -0.6764826774597168 with time_loss: -3.5228984355926514 and type_loss 2.8464157581329346
New best found!



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.05920052528381348 with time_loss: -2.7688186168670654 and type_loss 2.828019142150879



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:04, 14.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.602424144744873 with time_loss: -2.2946057319641113 and type_loss 2.8970298767089844



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5586036443710327 with time_loss: -1.61404287815094 and type_loss 3.1726465225219727



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2790207862854004 with time_loss: -2.605748414993286 and type_loss 2.8847692012786865




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:07<00:00, 19.06it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.5879391431808472 with time_loss: -1.278744101524353 and type_loss 2.8666832447052


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5324134826660156 with time_loss: -2.3771140575408936 and type_loss 2.909527540206909



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.5215996503829956 with time_loss: -1.3755568265914917 and type_loss 2.8971564769744873



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:04, 14.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.4545788764953613 with time_loss: -0.3781315088272095 and type_loss 2.8327105045318604



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.51it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.93800687789917 with time_loss: -0.9755309224128723 and type_loss 2.9135377407073975




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3133432865142822 with time_loss: -4.045163154602051 and type_loss 2.7318198680877686
Test loss: 0.8925108909606934 with time_loss: -1.9461171627044678 and type_loss 2.838628053665161



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.80it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.210799217224121 with time_loss: -0.6386804580688477 and type_loss 2.8494796752929688




  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:07<00:00, 19.15it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.13066911697387695 with time_loss: -2.7031657695770264 and type_loss 2.8338348865509033


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.16it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8632800579071045 with time_loss: -2.0116641521453857 and type_loss 2.8749442100524902



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 0.015018939971923828 with time_loss: -2.8279666900634766 and type_loss 2.8429856300354004



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:05<00:03, 14.86it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.9595763683319092 with time_loss: -1.0906672477722168 and type_loss 3.050243616104126



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 1.0297999382019043 with time_loss: -1.7998600006103516 and type_loss 2.829659938812256




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3508601188659668 with time_loss: -4.079743385314941 and type_loss 2.7288832664489746
Test loss: 0.9006946086883545 with time_loss: -1.9009742736816406 and type_loss 2.801668882369995



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.271663784980774 with time_loss: -1.578926682472229 and type_loss 2.850590467453003




  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:07<00:00, 19.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2137726545333862 with time_loss: -1.735449194908142 and type_loss 2.9492218494415283



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.679409980773926 with time_loss: -0.20434242486953735 and type_loss 2.8837523460388184




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5563092231750488 with time_loss: -4.263930797576904 and type_loss 2.7076215744018555
Test loss: 1.4460831880569458 with time_loss: -1.4103790521621704 and type_loss 2.856462240219116



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.563719391822815 with time_loss: -1.2469605207443237 and type_loss 2.8106799125671387



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.50it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.0943840742111206 with time_loss: -1.739059329032898 and type_loss 2.8334434032440186


  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.0903968811035156 with time_loss: -0.8166066408157349 and type_loss 2.907003402709961



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 2.344900131225586 with time_loss: -0.5117610692977905 and type_loss 2.856661319732666



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.97it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.015634775161743 with time_loss: 0.08721773326396942 and type_loss 2.9284169673919678



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.0348867177963257 with time_loss: -1.821262240409851 and type_loss 2.8561489582061768




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.6170477867126465 with time_loss: -0.2814970314502716 and type_loss 2.8985447883605957


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 1.3533873558044434 with time_loss: -1.5012154579162598 and type_loss 2.854602813720703




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.733626127243042 with time_loss: -4.416336536407471 and type_loss 2.6827104091644287
Test loss: 2.474695920944214 with time_loss: -0.4037482738494873 and type_loss 2.878444194793701



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:04<00:04, 14.84it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.2308114767074585 with time_loss: -1.657340407371521 and type_loss 2.8881518840789795



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.43it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.172029733657837 with time_loss: -0.6979827284812927 and type_loss 2.8700125217437744


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 14.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.109523892402649 with time_loss: -1.7454496622085571 and type_loss 2.854973554611206




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.7797062397003174 with time_loss: -4.457552909851074 and type_loss 2.677846670150757
Test loss: 2.8521108627319336 with time_loss: -0.02622496336698532 and type_loss 2.87833571434021



  - (Training)   :  50%|████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                               | 61/121 [00:05<00:04, 14.60it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5879966020584106 with time_loss: -1.2287181615829468 and type_loss 2.8167147636413574




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 18.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.193169593811035 with time_loss: -0.6770603656768799 and type_loss 2.870229959487915



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3901214599609375 with time_loss: -1.4559156894683838 and type_loss 2.8460371494293213

