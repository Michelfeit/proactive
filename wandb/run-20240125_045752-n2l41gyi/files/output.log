
  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 6, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 1.3855860233306885 with time_loss: -2.1608290672302246 and type_loss 3.546415090560913
Test loss: 0.013911724090576172 with time_loss: -2.9977591037750244 and type_loss 3.0116708278656006





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.37220311164855957 with time_loss: -2.5671958923339844 and type_loss 2.939399003982544




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.06656169891357422 with time_loss: -3.0094990730285645 and type_loss 3.0760607719421387




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.08017635345458984 with time_loss: -3.067641019821167 and type_loss 2.987464666366577
New best found!




  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:07<00:02, 15.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.34062933921813965 with time_loss: -3.233086109161377 and type_loss 2.8924567699432373
New best found!




  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:07<00:02, 15.08it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.22359657287597656 with time_loss: -2.7477807998657227 and type_loss 2.971377372741699




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3211236000061035 with time_loss: -3.2450318336486816 and type_loss 2.923908233642578




  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:07<00:02, 14.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6140668392181396 with time_loss: -2.306705951690674 and type_loss 2.9207727909088135



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:04<00:03, 15.12it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.746741533279419 with time_loss: -2.1807260513305664 and type_loss 2.9274675846099854



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:04<00:04, 14.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.6048448085784912 with time_loss: -3.4723732471466064 and type_loss 2.8675284385681152
New best found!





  - (Training)   :  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 104/121 [00:09<00:01, 14.77it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 1.740899920463562 with time_loss: -1.0847736597061157 and type_loss 2.8256735801696777




  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:07<00:06,  9.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2555811405181885 with time_loss: -2.5546352863311768 and type_loss 2.8102164268493652




  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:07<00:06,  9.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8637535572052002 with time_loss: -1.9751627445220947 and type_loss 2.838916301727295





  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:09<00:00, 15.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -0.5232717990875244 with time_loss: -3.3729188442230225 and type_loss 2.849647045135498





  - (Training)   :  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 103/121 [00:09<00:01, 14.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.37363481521606445 with time_loss: -3.2084474563598633 and type_loss 2.834812641143799





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.953153133392334 with time_loss: -3.7459216117858887 and type_loss 2.7927684783935547
Test loss: -0.2691776752471924 with time_loss: -3.1200132369995117 and type_loss 2.8508355617523193




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:07<00:07,  9.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.24688720703125 with time_loss: -2.627521276473999 and type_loss 2.874408483505249




  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:07<00:07,  9.29it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.04722118377685547 with time_loss: -2.761906147003174 and type_loss 2.8091273307800293





  - (Training)   :  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 106/121 [00:09<00:01, 14.97it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.0352905988693237 with time_loss: -1.8929754495620728 and type_loss 2.9282660484313965



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:07<00:07,  9.29it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3568878173828125 with time_loss: -2.4756298065185547 and type_loss 2.832517623901367




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:07<00:06,  9.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9663305282592773 with time_loss: -1.8468575477600098 and type_loss 2.813188076019287




  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:07<00:06,  9.89it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.2126917839050293 with time_loss: -2.577784299850464 and type_loss 2.790476083755493





  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:09<00:01, 14.31it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.027952194213867 with time_loss: -0.7913123965263367 and type_loss 2.8192646503448486





  - (Training)   :  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 106/121 [00:09<00:01, 14.97it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.829319953918457 with time_loss: -1.9870455265045166 and type_loss 2.8163654804229736




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.2620103359222412 with time_loss: -4.009148597717285 and type_loss 2.747138261795044
Test loss: 0.48187994956970215 with time_loss: -2.3278017044067383 and type_loss 2.8096816539764404




  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:07<00:06,  9.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9174621105194092 with time_loss: -1.8962359428405762 and type_loss 2.8136980533599854





  - (Training)   :  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 103/121 [00:09<00:01, 14.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.2536289691925049 with time_loss: -3.0318496227264404 and type_loss 2.7782206535339355





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3630449771881104 with time_loss: -4.105626583099365 and type_loss 2.742581605911255
Test loss: 1.5114234685897827 with time_loss: -1.2891076803207397 and type_loss 2.8005311489105225




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:07<00:07,  9.34it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.22341012954711914 with time_loss: -2.568838119506836 and type_loss 2.792248249053955




  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:07<00:07,  9.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7215147018432617 with time_loss: -2.117816209793091 and type_loss 2.8393309116363525





  - (Training)   :  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 104/121 [00:09<00:01, 14.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.13886809349060059 with time_loss: -2.63450288772583 and type_loss 2.7733709812164307





  - (Training)   :  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 106/121 [00:09<00:00, 15.20it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.5902862548828125 with time_loss: -1.2140347957611084 and type_loss 2.804321050643921





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.494312047958374 with time_loss: -4.206096649169922 and type_loss 2.711784601211548
Test loss: 0.31347203254699707 with time_loss: -2.477273941040039 and type_loss 2.790745973587036




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:07<00:07,  9.26it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.2927687168121338 with time_loss: -2.483124256134033 and type_loss 2.775892972946167



  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:09<00:00, 15.20it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.5810246467590332 with time_loss: -2.2308285236358643 and type_loss 2.8118531703948975





  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:09<00:01, 14.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.20173978805541992 with time_loss: -2.591231107711792 and type_loss 2.792970895767212





  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:09<00:01, 14.64it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.6366608142852783 with time_loss: -2.1724865436553955 and type_loss 2.809147357940674



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:07<00:07,  9.19it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2744532823562622 with time_loss: -1.5644100904464722 and type_loss 2.8388633728027344




  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:07<00:06,  9.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.9313892126083374 with time_loss: -0.8823848962783813 and type_loss 2.8137741088867188




  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:07<00:07,  9.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 1.9386792182922363 with time_loss: -0.8529095649719238 and type_loss 2.79158878326416





  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:09<00:00, 15.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1407055854797363 with time_loss: -1.6647911071777344 and type_loss 2.8054966926574707





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6171526908874512 with time_loss: -4.316433906555176 and type_loss 2.6992812156677246
Test loss: -0.2859797477722168 with time_loss: -3.068814754486084 and type_loss 2.782835006713867




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:07<00:06,  9.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.7661631107330322 with time_loss: -1.0086321830749512 and type_loss 2.7747952938079834





  - (Training)   :  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 103/121 [00:09<00:01, 14.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.738705635070801 with time_loss: -0.09432969987392426 and type_loss 2.8330352306365967





  - (Training)   :  86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                          | 104/121 [00:09<00:01, 14.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 0.3243238925933838 with time_loss: -2.4681169986724854 and type_loss 2.792440891265869





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.7642300128936768 with time_loss: -2.072099447250366 and type_loss 2.836329460144043



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:07<00:07,  9.09it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9410572052001953 with time_loss: -1.8601698875427246 and type_loss 2.80122709274292




  - (Training)   :  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 105/121 [00:09<00:01, 15.06it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 0.629431962966919 with time_loss: -2.17111873626709 and type_loss 2.800550699234009





  - (Training)   :  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                         | 105/121 [00:09<00:01, 15.03it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.3947763442993164 with time_loss: -2.4017653465270996 and type_loss 2.796541690826416





Train loss: -1.6977505683898926 with time_loss: -4.385860919952393 and type_loss 2.6881103515625

Test loss: 2.4142794609069824 with time_loss: -0.3997255563735962 and type_loss 2.814005136489868
Best loss is: tensor(-0.6048, device='cuda:0')