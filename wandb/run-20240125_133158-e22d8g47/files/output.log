Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 4, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.561887264251709 with time_loss: -3.184877872467041 and type_loss 1.622990608215332
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.038123607635498 with time_loss: -3.4758028984069824 and type_loss 1.437679409980774
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.2191343307495117 with time_loss: -3.5913569927215576 and type_loss 1.372222661972046
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.188486099243164 with time_loss: -3.50726056098938 and type_loss 1.3187744617462158



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.411673069000244 with time_loss: -3.703187942504883 and type_loss 1.2915147542953491
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.656386375427246 with time_loss: -3.895331859588623 and type_loss 1.2389456033706665
New best found!



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.0097618103027344 with time_loss: -3.2212655544281006 and type_loss 1.2115038633346558



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.823133945465088 with time_loss: -3.0968751907348633 and type_loss 1.2737412452697754



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7434871196746826 with time_loss: -3.9240124225616455 and type_loss 1.180525302886963
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.9317535161972046 with time_loss: -3.083466053009033 and type_loss 1.1517125368118286



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.6638054847717285 with time_loss: -3.786454916000366 and type_loss 1.1226493120193481



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.551583766937256 with time_loss: -3.6670947074890137 and type_loss 1.1155109405517578



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.4511550664901733 with time_loss: -2.594400405883789 and type_loss 1.1432453393936157



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.733488917350769 with time_loss: -2.8323469161987305 and type_loss 1.0988579988479614



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5035518407821655 with time_loss: -2.6053154468536377 and type_loss 1.1017636060714722



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5407252311706543 with time_loss: -3.654412031173706 and type_loss 1.1136868000030518



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7522455453872681 with time_loss: -0.3582852780818939 and type_loss 1.1105308532714844




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.3917412757873535 with time_loss: -4.436854362487793 and type_loss 1.045113205909729
Test loss: -0.31685376167297363 with time_loss: -1.406657338142395 and type_loss 1.0898035764694214




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.4566380977630615 with time_loss: -4.501522064208984 and type_loss 1.0448839664459229
Test loss: -2.3921117782592773 with time_loss: -3.504889726638794 and type_loss 1.1127779483795166


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7656127214431763 with time_loss: -2.882359504699707 and type_loss 1.1167467832565308


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2394495010375977 with time_loss: -3.298732042312622 and type_loss 1.0592824220657349


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4373388290405273 with time_loss: -2.496044158935547 and type_loss 1.0587053298950195



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.7734107971191406 with time_loss: -4.74841833114624 and type_loss 0.9750076532363892
Test loss: -2.239091157913208 with time_loss: -3.307685375213623 and type_loss 1.068594217300415



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.3051657676696777 with time_loss: -4.364675045013428 and type_loss 1.05950927734375
New best found!


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.0665411949157715 with time_loss: -3.1211233139038086 and type_loss 1.054582118988037


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.378176212310791 with time_loss: -3.4308013916015625 and type_loss 1.0526251792907715



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.44it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.8733606338500977 with time_loss: -2.943091869354248 and type_loss 1.0697312355041504


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.56it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.8005870580673218 with time_loss: -2.8750240802764893 and type_loss 1.0744370222091675


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.64it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.0994091033935547 with time_loss: -3.1659862995147705 and type_loss 1.0665771961212158


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.430915117263794 with time_loss: -3.481578826904297 and type_loss 1.050663709640503



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.523371696472168 with time_loss: -3.566216468811035 and type_loss 1.0428446531295776



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.31770920753479 with time_loss: -3.3576180934906006 and type_loss 1.0399088859558105



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.8197568655014038 with time_loss: -2.868525743484497 and type_loss 1.0487688779830933



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.724307894706726 with time_loss: -2.75445818901062 and type_loss 1.030150294303894



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -1.6378867626190186 with time_loss: -2.6761069297790527 and type_loss 1.0382201671600342



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5654411315917969 with time_loss: -2.607762336730957 and type_loss 1.0423212051391602



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0319160223007202 with time_loss: -2.065875768661499 and type_loss 1.0339597463607788



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6527581214904785 with time_loss: -2.685149669647217 and type_loss 1.0323915481567383



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.468032121658325 with time_loss: -3.4844377040863037 and type_loss 1.0164055824279785



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.64it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.4381349086761475 with time_loss: -2.4937920570373535 and type_loss 1.055657148361206



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.6160143613815308 with time_loss: -2.6525583267211914 and type_loss 1.0365439653396606



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -1.588573694229126 with time_loss: -2.6255388259887695 and type_loss 1.0369651317596436



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7060418128967285 with time_loss: -3.747082233428955 and type_loss 1.0410404205322266


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.918248176574707 with time_loss: -2.9549098014831543 and type_loss 1.0366616249084473


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5653281211853027 with time_loss: -3.6042087078094482 and type_loss 1.038880705833435




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.317577362060547 with time_loss: -5.20122766494751 and type_loss 0.8836504817008972
Test loss: -1.0579559803009033 with time_loss: -2.0965397357940674 and type_loss 1.038583755493164




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.331532955169678 with time_loss: -5.206475257873535 and type_loss 0.8749424815177917
Test loss: -2.3453736305236816 with time_loss: -3.3788557052612305 and type_loss 1.0334821939468384




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.332862377166748 with time_loss: -5.21799373626709 and type_loss 0.8851313591003418
Test loss: -1.8349461555480957 with time_loss: -2.8723185062408447 and type_loss 1.037372350692749



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.342897891998291 with time_loss: -5.221278667449951 and type_loss 0.8783808946609497
Test loss: -2.096574544906616 with time_loss: -3.129232883453369 and type_loss 1.032658338546753



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.346640586853027 with time_loss: -5.225621223449707 and type_loss 0.8789805173873901
Test loss: -1.4034969806671143 with time_loss: -2.4357404708862305 and type_loss 1.0322434902191162

