Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 5, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.9420509338378906 with time_loss: -2.9980475902557373 and type_loss 2.0559966564178467
New best found!


  - (Training)   :  36%|████████████████████████████████████████████████████████████████████▏                                                                                                                           | 43/121 [00:05<00:07, 10.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.284468412399292 with time_loss: -3.0458624362945557 and type_loss 1.7613940238952637
New best found!





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5457227230072021 with time_loss: -3.1704583168029785 and type_loss 1.6247355937957764
New best found!



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:07<00:02, 15.22it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6886509656906128 with time_loss: -3.2895898818969727 and type_loss 1.6009389162063599
New best found!




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.60it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2076404094696045 with time_loss: -2.781315326690674 and type_loss 1.5736749172210693





  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -1.9248212575912476 with time_loss: -3.386481761932373 and type_loss 1.4616605043411255
New best found!




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3367782831192017 with time_loss: -2.7852790355682373 and type_loss 1.4485007524490356




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5269774198532104 with time_loss: -3.214871644973755 and type_loss 1.6878942251205444




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.960105299949646 with time_loss: -2.4512643814086914 and type_loss 1.4911590814590454




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.57it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -2.346825122833252 with time_loss: -3.7143568992614746 and type_loss 1.3675318956375122
New best found!




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2570533752441406 with time_loss: -3.553989887237549 and type_loss 1.2969366312026978



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:04<00:02, 17.13it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6446908712387085 with time_loss: -1.9487918615341187 and type_loss 1.3041009902954102



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:04<00:03, 16.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2238208055496216 with time_loss: -2.544344425201416 and type_loss 1.3205236196517944




  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:09<00:01, 13.55it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0269534587860107 with time_loss: -2.309340000152588 and type_loss 1.2823865413665771





  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:09<00:01, 13.00it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.13949453830719 with time_loss: -2.428244113922119 and type_loss 1.2887495756149292





  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:09<00:01, 12.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.9719988107681274 with time_loss: -2.243504047393799 and type_loss 1.2715052366256714





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.380906581878662 with time_loss: -3.645055055618286 and type_loss 1.264148473739624
New best found!





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8103896379470825 with time_loss: -2.0655534267425537 and type_loss 1.2551637887954712





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.857142925262451 with time_loss: -4.132199764251709 and type_loss 1.2750568389892578
Test loss: -1.3112192153930664 with time_loss: -2.5999486446380615 and type_loss 1.2887294292449951






Train loss: -2.873566150665283 with time_loss: -4.126140117645264 and type_loss 1.2525739669799805
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.85698401927948 with time_loss: -2.1125926971435547 and type_loss 1.2556086778640747





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.553975224494934 with time_loss: -2.760929584503174 and type_loss 1.2069543600082397





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.3127477169036865 with time_loss: -2.527859687805176 and type_loss 1.2151119709014893





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.95it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.5976998805999756 with time_loss: -2.8118560314178467 and type_loss 1.214156150817871





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.158381223678589 with time_loss: -4.344930648803711 and type_loss 1.186549425125122
Test loss: -1.3918657302856445 with time_loss: -2.5980446338653564 and type_loss 1.206178903579712





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.1592020988464355 with time_loss: -4.342501163482666 and type_loss 1.1832990646362305
Test loss: -1.2784560918807983 with time_loss: -2.4774694442749023 and type_loss 1.199013352394104





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.2021946907043457 with time_loss: -3.3806815147399902 and type_loss 1.178486704826355





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -1.4071282148361206 with time_loss: -2.618429183959961 and type_loss 1.2113009691238403





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.76it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -2.40608811378479 with time_loss: -3.6105074882507324 and type_loss 1.2044193744659424
New best found!





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9765424728393555 with time_loss: -3.1768925189971924 and type_loss 1.200350046157837




  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:07<00:05, 11.10it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.289818286895752 with time_loss: -3.480121612548828 and type_loss 1.1903032064437866





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.86it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5518543720245361 with time_loss: -2.7288479804992676 and type_loss 1.1769936084747314




  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:09<00:01, 12.70it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.621747612953186 with time_loss: -2.787405014038086 and type_loss 1.1656574010849




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.3321852684020996 with time_loss: -2.5074799060821533 and type_loss 1.1752946376800537





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3427742719650269 with time_loss: -2.504566192626953 and type_loss 1.1617919206619263





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.518039345741272 with time_loss: -2.697355031967163 and type_loss 1.1793156862258911





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.462752342224121 with time_loss: -4.594807147979736 and type_loss 1.1320549249649048
Test loss: -1.076033353805542 with time_loss: -2.246190309524536 and type_loss 1.1701569557189941





  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:09<00:01, 12.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.5724056959152222 with time_loss: -2.7371132373809814 and type_loss 1.1647075414657593





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.2145302295684814 with time_loss: -3.364469528198242 and type_loss 1.1499392986297607





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.80it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.3494434356689453 with time_loss: -3.4963929653167725 and type_loss 1.1469496488571167




  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:07<00:05, 11.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8188579082489014 with time_loss: -2.9655983448028564 and type_loss 1.146740436553955




  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:07<00:04, 11.20it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.1227900981903076 with time_loss: -2.2680084705352783 and type_loss 1.1452183723449707




  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.85it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.3530280590057373 with time_loss: -2.4896528720855713 and type_loss 1.136624813079834




  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.3990989923477173 with time_loss: -2.532822608947754 and type_loss 1.1337236166000366





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.87it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -1.088431715965271 with time_loss: -2.2227375507354736 and type_loss 1.1343058347702026





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.4895387887954712 with time_loss: -2.61688232421875 and type_loss 1.1273435354232788





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.618117332458496 with time_loss: -4.692092418670654 and type_loss 1.0739752054214478
Test loss: -1.049211859703064 with time_loss: -2.174750328063965 and type_loss 1.1255384683609009





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.90it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.7464121580123901 with time_loss: -1.8703871965408325 and type_loss 1.1239750385284424




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:09<00:01, 13.02it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.1362965106964111 with time_loss: -2.2549638748168945 and type_loss 1.1186673641204834





  - (Training)   :  80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                      | 97/121 [00:09<00:01, 12.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7059727907180786 with time_loss: -2.825692892074585 and type_loss 1.1197201013565063





  - (Training)   :  81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 98/121 [00:09<00:01, 12.90it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1454662084579468 with time_loss: -2.2602503299713135 and type_loss 1.1147841215133667

