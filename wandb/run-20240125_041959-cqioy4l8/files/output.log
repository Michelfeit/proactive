Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.2671337127685547 with time_loss: -2.488511085510254 and type_loss 2.221377372741699
New best found!



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6283292770385742 with time_loss: -2.7242233753204346 and type_loss 2.0958940982818604
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.7678859233856201 with time_loss: -2.8623390197753906 and type_loss 2.0944530963897705
Test loss: -0.4635941982269287 with time_loss: -2.690187931060791 and type_loss 2.2265937328338623



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.0124884843826294 with time_loss: -2.8811686038970947 and type_loss 1.8686801195144653
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.8016021251678467 with time_loss: -3.0148026943206787 and type_loss 2.213200569152832
Test loss: -0.7331745624542236 with time_loss: -2.9225430488586426 and type_loss 2.189368486404419




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.9633204936981201 with time_loss: -3.077660083770752 and type_loss 2.114339590072632



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.124072551727295 with time_loss: -0.9728426933288574 and type_loss 2.0969152450561523


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.07270538806915283 with time_loss: -1.715659737586975 and type_loss 1.788365125656128


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2266043424606323 with time_loss: -3.0708048343658447 and type_loss 1.8442004919052124
New best found!



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8617758750915527 with time_loss: -2.642198085784912 and type_loss 1.7804222106933594



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.4460204839706421 with time_loss: -1.2218475341796875 and type_loss 1.6678680181503296



  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 16.15it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 1.184638500213623 with time_loss: -0.4521673321723938 and type_loss 1.636805772781372



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 16.00it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.4660189151763916 with time_loss: -1.1582756042480469 and type_loss 1.6242945194244385



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:05<00:03, 15.36it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6861616373062134 with time_loss: -2.3301961421966553 and type_loss 1.644034504890442


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -0.4271681308746338 with time_loss: -2.067323923110962 and type_loss 1.6401557922363281



  - (Training)   :  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 91/121 [00:05<00:01, 21.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.40239715576171875 with time_loss: -2.0375986099243164 and type_loss 1.6352014541625977



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.16it/s]


Test loss: 1.6001018285751343 with time_loss: -0.09045763313770294 and type_loss 1.6905595064163208
[ Epoch 17 ]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2161781787872314 with time_loss: -2.794595241546631 and type_loss 1.5784170627593994


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.1789673566818237 with time_loss: -2.795689582824707 and type_loss 1.6167222261428833


  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.4874112606048584 with time_loss: -0.08162793517112732 and type_loss 1.569039225578308



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.54it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 1.176159381866455 with time_loss: -0.34233853220939636 and type_loss 1.5184979438781738



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.3672146797180176 with time_loss: -3.85154390335083 and type_loss 1.484329342842102
Test loss: 0.4766134023666382 with time_loss: -1.0365217924118042 and type_loss 1.5131351947784424


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.2140136957168579 with time_loss: -1.293126106262207 and type_loss 1.507139801979065

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3183647394180298 with time_loss: -0.1931820809841156 and type_loss 1.5115468502044678


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8310860395431519 with time_loss: -2.3249425888061523 and type_loss 1.4938565492630005


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 1.4535443782806396 with time_loss: -0.04270930960774422 and type_loss 1.4962537288665771



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.7755146622657776 with time_loss: -0.7526721358299255 and type_loss 1.5281867980957031



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.3915334939956665 with time_loss: -1.8648346662521362 and type_loss 1.4733011722564697


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.4582085609436035 with time_loss: -3.9368255138397217 and type_loss 1.4786169528961182
Test loss: 0.2750835418701172 with time_loss: -1.2109283208847046 and type_loss 1.4860118627548218


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.036655068397522 with time_loss: -0.43040964007377625 and type_loss 1.4670647382736206


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:59,  3.00s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3417848348617554 with time_loss: -0.10511065274477005 and type_loss 1.4468954801559448



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.3828998804092407 with time_loss: -0.06999921798706055 and type_loss 1.4528990983963013



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.31it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.506122350692749 with time_loss: 0.055432964116334915 and type_loss 1.450689435005188



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.666250228881836 with time_loss: -4.057210445404053 and type_loss 1.3909600973129272
Test loss: 1.3818271160125732 with time_loss: -0.088680699467659 and type_loss 1.4705078601837158


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.6025910377502441 with time_loss: -0.8480303287506104 and type_loss 1.4506213665008545


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.01s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.485175371170044 with time_loss: 0.051389068365097046 and type_loss 1.4337862730026245


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:59,  3.00s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 1.5608752965927124 with time_loss: 0.12295284122228622 and type_loss 1.437922477722168



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.314639687538147 with time_loss: -0.118490070104599 and type_loss 1.4331297874450684



  - (Training)   :  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 91/121 [00:05<00:01, 21.94it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.3237065076828003 with time_loss: -0.0916443020105362 and type_loss 1.4153507947921753

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4852694272994995 with time_loss: 0.026828395202755928 and type_loss 1.4584410190582275


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:03,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1945880651474 with time_loss: -0.2237103283405304 and type_loss 1.418298363685608


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:01,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4312268495559692 with time_loss: 0.01909281685948372 and type_loss 1.412134051322937



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:05<00:01, 21.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 1.315970778465271 with time_loss: -0.07868853956460953 and type_loss 1.3946592807769775



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.67it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.4928423166275024 with time_loss: 0.10599279403686523 and type_loss 1.3868495225906372


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.791459798812866 with time_loss: -4.1440205574035645 and type_loss 1.3525607585906982
Test loss: 1.3461639881134033 with time_loss: -0.05423732101917267 and type_loss 1.4004013538360596


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4697117805480957 with time_loss: 0.06010536104440689 and type_loss 1.4096064567565918


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5686662197113037 with time_loss: 0.16348512470722198 and type_loss 1.4051810503005981



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:05<00:01, 21.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 1.5653622150421143 with time_loss: 0.17295457422733307 and type_loss 1.3924076557159424



  - (Training)   :  75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                               | 91/121 [00:05<00:01, 22.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.3442511558532715 with time_loss: -0.03949699550867081 and type_loss 1.383748173713684



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

Test loss: 0.4446806311607361 with time_loss: -0.9419731497764587 and type_loss 1.3866537809371948
Best loss is: tensor(-1.2266, device='cuda:0')