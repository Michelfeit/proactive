Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 3, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:05<00:01, 21.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7351511716842651 with time_loss: -3.2636983394622803 and type_loss 1.5285471677780151
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.03s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.054957389831543 with time_loss: -3.3521907329559326 and type_loss 1.2972333431243896
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.245835304260254 with time_loss: -3.4800338745117188 and type_loss 1.2341986894607544
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:00,  3.01s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.273967742919922 with time_loss: -3.5121495723724365 and type_loss 1.2381819486618042
New best found!



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:05<00:02, 18.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -2.867396831512451 with time_loss: -4.083268165588379 and type_loss 1.2158713340759277
New best found!



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 18.03it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.76361083984375 with time_loss: -3.8933706283569336 and type_loss 1.1297597885131836



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -2.864302635192871 with time_loss: -3.9982645511627197 and type_loss 1.1339619159698486



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.7069180011749268 with time_loss: -3.8429324626922607 and type_loss 1.136014461517334



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.06it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.50498628616333 with time_loss: -3.6697821617126465 and type_loss 1.164795994758606



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.357174873352051 with time_loss: -3.434816598892212 and type_loss 1.0776418447494507



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.9984426498413086 with time_loss: -4.0891547203063965 and type_loss 1.0907119512557983
New best found!


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 16.99it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.5634419918060303 with time_loss: -3.6337192058563232 and type_loss 1.070277214050293


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.81it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6664915084838867 with time_loss: -3.7311506271362305 and type_loss 1.0646589994430542



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.14it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9250550270080566 with time_loss: -3.991185426712036 and type_loss 1.06613028049469



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.11it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.259247303009033 with time_loss: -4.315107345581055 and type_loss 1.0558600425720215
New best found!


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -3.0841422080993652 with time_loss: -4.153966903686523 and type_loss 1.0698245763778687



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.64it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -3.2360103130340576 with time_loss: -4.290985107421875 and type_loss 1.0549747943878174



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.87it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.9475222826004028 with time_loss: -3.0011043548583984 and type_loss 1.0535820722579956


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.32it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.0731639862060547 with time_loss: -4.139650821685791 and type_loss 1.0664867162704468


  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 18.07it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -3.034872531890869 with time_loss: -4.07927131652832 and type_loss 1.0443986654281616



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -3.0173861980438232 with time_loss: -4.0638933181762695 and type_loss 1.0465071201324463



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -2.498854637145996 with time_loss: -3.5383970737457275 and type_loss 1.039542317390442



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.458078384399414 with time_loss: -3.488866090774536 and type_loss 1.0307878255844116



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.993743896484375 with time_loss: -4.037078380584717 and type_loss 1.0433344841003418



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.79it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8558578491210938 with time_loss: -3.8921854496002197 and type_loss 1.036327600479126



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.446244716644287 with time_loss: -3.487675905227661 and type_loss 1.0414310693740845



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.74it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.566497802734375 with time_loss: -3.609772205352783 and type_loss 1.0432744026184082



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -2.5646920204162598 with time_loss: -3.59218692779541 and type_loss 1.02749502658844


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:05,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.30953311920166 with time_loss: -4.340938568115234 and type_loss 1.0314053297042847
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8900437355041504 with time_loss: -3.9170327186584473 and type_loss 1.0269889831542969


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:02,  3.02s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.403595209121704 with time_loss: -3.4328417778015137 and type_loss 1.0292465686798096


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.83it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.597748279571533 with time_loss: -3.6263046264648438 and type_loss 1.0285563468933105




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.030359268188477 with time_loss: -4.949468612670898 and type_loss 0.9191094040870667
Test loss: -2.393216133117676 with time_loss: -3.4174587726593018 and type_loss 1.024242639541626




Train loss: -4.038983345031738 with time_loss: -4.959212779998779 and type_loss 0.9202295541763306
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9029148817062378 with time_loss: -2.9260430335998535 and type_loss 1.0231281518936157




Train loss: -4.0198073387146 with time_loss: -4.9420013427734375 and type_loss 0.9221940636634827
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.179989814758301 with time_loss: -3.2128982543945312 and type_loss 1.03290855884552


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5588538646698 with time_loss: -3.5830612182617188 and type_loss 1.024207353591919



  - (Training)   :  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                              | 92/121 [00:05<00:01, 22.30it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.1436541080474854 with time_loss: -3.177215337753296 and type_loss 1.0335612297058105


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.91494083404541 with time_loss: -3.9372029304504395 and type_loss 1.0222619771957397


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.110138893127441 with time_loss: -5.018577575683594 and type_loss 0.9084388017654419
Test loss: -2.4062161445617676 with time_loss: -3.436199426651001 and type_loss 1.0299832820892334



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.134767532348633 with time_loss: -5.0351128578186035 and type_loss 0.9003454446792603
Test loss: -1.9869022369384766 with time_loss: -3.0121805667877197 and type_loss 1.0252783298492432



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.162254810333252 with time_loss: -5.061994552612305 and type_loss 0.8997398018836975
Test loss: -2.620236396789551 with time_loss: -3.647190570831299 and type_loss 1.026954174041748



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.145694255828857 with time_loss: -5.041145324707031 and type_loss 0.8954512476921082
Test loss: -2.4130349159240723 with time_loss: -3.4402408599853516 and type_loss 1.0272059440612793



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.37it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.282433032989502 with time_loss: -3.307346820831299 and type_loss 1.0249136686325073


  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.6853671073913574 with time_loss: -3.710507392883301 and type_loss 1.0251401662826538



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.74it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6420178413391113 with time_loss: -3.6653964519500732 and type_loss 1.0233784914016724




Train loss: -4.1858086585998535 with time_loss: -5.0803070068359375 and type_loss 0.8944982886314392
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5516088008880615 with time_loss: -3.575214147567749 and type_loss 1.0236053466796875



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.39it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.833749532699585 with time_loss: -3.8555288314819336 and type_loss 1.0217792987823486


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.83it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.949923038482666 with time_loss: -3.975264072418213 and type_loss 1.0253410339355469


  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 18.14it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -3.0216972827911377 with time_loss: -4.047580242156982 and type_loss 1.0258829593658447

