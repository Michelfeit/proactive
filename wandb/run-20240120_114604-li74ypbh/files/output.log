Training hawkes transformer...
{'batch_size': 4, 'd_k': 128, 'd_model': 512, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 70, 'learning_rate': 0.0005483905559376557, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 32, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.84it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.97s/it]
Test loss: 13.402200698852539 with time_loss: -7.966495037078857 and type_loss 21.368696212768555



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 11.1256103515625 with time_loss: -8.855978012084961 and type_loss 19.98158836364746



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 16.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 7.792449951171875 with time_loss: -10.55976676940918 and type_loss 18.352216720581055



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.08it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 4.733264923095703 with time_loss: -13.226736068725586 and type_loss 17.96000099182129


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:09,  3.08s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 9.187753677368164 with time_loss: -9.993972778320312 and type_loss 19.181726455688477



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 7.083218574523926 with time_loss: -11.502436637878418 and type_loss 18.585655212402344



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 7.882776260375977 with time_loss: -9.702722549438477 and type_loss 17.585498809814453



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 4.460441589355469 with time_loss: -13.483573913574219 and type_loss 17.944015502929688



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.05it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.578442573547363 with time_loss: -6.449185371398926 and type_loss 18.02762794494629



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 14.871542930603027 with time_loss: -3.8001108169555664 and type_loss 18.671653747558594



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.33it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: 5.011923789978027 with time_loss: -12.528130531311035 and type_loss 17.540054321289062



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.647783279418945 with time_loss: -5.748234272003174 and type_loss 17.39601707458496


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:04,  3.04s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 8.745732307434082 with time_loss: -8.797280311584473 and type_loss 17.543012619018555



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 2.3415918350219727 with time_loss: -14.259055137634277 and type_loss 16.60064697265625
Test loss: 13.743478775024414 with time_loss: -3.7513160705566406 and type_loss 17.494794845581055



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 14.403715133666992 with time_loss: -2.8936729431152344 and type_loss 17.297388076782227




  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 6.68168830871582 with time_loss: -10.581880569458008 and type_loss 17.263568878173828


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 16.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 9.12150764465332 with time_loss: -8.033395767211914 and type_loss 17.154903411865234



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.883173942565918 with time_loss: -5.0702009201049805 and type_loss 16.9533748626709



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.08it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.345766067504883 with time_loss: -5.537123203277588 and type_loss 16.882888793945312



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 13.2857084274292 with time_loss: -4.065243721008301 and type_loss 17.3509521484375


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:58,  2.99s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 8.1770658493042 with time_loss: -8.724804878234863 and type_loss 16.901870727539062


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 13.706099510192871 with time_loss: -3.6769797801971436 and type_loss 17.383079528808594



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 0.6106777191162109 with time_loss: -15.550369262695312 and type_loss 16.161046981811523
Test loss: 9.790124893188477 with time_loss: -7.217617511749268 and type_loss 17.007741928100586



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 8.09131908416748 with time_loss: -8.81997013092041 and type_loss 16.91128921508789



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.73it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 8.497132301330566 with time_loss: -8.369187355041504 and type_loss 16.86631965637207


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:04<00:02, 18.02it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.42250919342041 with time_loss: -6.6309709548950195 and type_loss 17.05348014831543



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 10.623260498046875 with time_loss: -6.152004241943359 and type_loss 16.775264739990234



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 11.04763412475586 with time_loss: -5.786184310913086 and type_loss 16.833818435668945



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:37,  3.16s/it]
Test loss: 9.669659614562988 with time_loss: -7.123568534851074 and type_loss 16.793228149414062



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 10.799422264099121 with time_loss: -6.280755043029785 and type_loss 17.080177307128906



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.809741973876953 with time_loss: -5.894687175750732 and type_loss 16.704429626464844



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.830739974975586 with time_loss: -5.835404872894287 and type_loss 16.66614532470703



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.418655395507812 with time_loss: -6.326906204223633 and type_loss 16.745561599731445



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.467458724975586 with time_loss: -5.2801289558410645 and type_loss 16.747587203979492




Train loss: -0.4200925827026367 with time_loss: -16.224924087524414 and type_loss 15.804831504821777

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 11.655839920043945 with time_loss: -5.120672702789307 and type_loss 16.776512145996094


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.72it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 10.202062606811523 with time_loss: -6.529191493988037 and type_loss 16.73125457763672


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: 10.763280868530273 with time_loss: -5.997795581817627 and type_loss 16.761075973510742



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.98s/it]
Test loss: 10.525630950927734 with time_loss: -6.153210163116455 and type_loss 16.67884063720703



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: 11.905431747436523 with time_loss: -4.895679473876953 and type_loss 16.801111221313477



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.883474349975586 with time_loss: -5.821588039398193 and type_loss 16.705062866210938



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.18it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.582210540771484 with time_loss: -6.078090190887451 and type_loss 16.660301208496094



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.52it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.50822639465332 with time_loss: -6.140228748321533 and type_loss 16.648454666137695



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.9243316650390625 with time_loss: -16.623638153076172 and type_loss 15.69930648803711
Test loss: 10.847762107849121 with time_loss: -5.824389457702637 and type_loss 16.672151565551758



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 11.44861888885498 with time_loss: -5.189129829406738 and type_loss 16.63774871826172


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.873138427734375 with time_loss: -5.74393892288208 and type_loss 16.617076873779297



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.56it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 12.035561561584473 with time_loss: -4.689511299133301 and type_loss 16.725072860717773



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.29it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.11s/it]
Test loss: 11.800870895385742 with time_loss: -4.828609466552734 and type_loss 16.629480361938477



Traceback (most recent call last):
  File "C:\Users\mich0003\Repos\BachelorPP\proactive\strategies\architecture\wandb\gmm_training_wandb.py", line 68, in train
    time_loss, type_loss = train_epoch(model, trainloader, optimizer, pred_loss_func, pred_loss_goal, config, event_data)
  File "C:\Users\mich0003\Repos\BachelorPP\proactive\strategies\architecture\wandb\gmm_training_wandb.py", line 98, in train_epoch
    optimizer.zero_grad()
  File "C:\Users\mich0003\AppData\Local\anaconda3\envs\proactive\lib\site-packages\torch\optim\optimizer.py", line 172, in zero_grad
    p.grad.zero_()
Exception