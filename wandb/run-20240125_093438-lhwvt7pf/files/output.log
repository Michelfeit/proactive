Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.37it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 1.7274466753005981 with time_loss: -1.7055495977401733 and type_loss 3.4329962730407715


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:52,  2.93s/it]


Train loss: 0.562446117401123 with time_loss: -2.552682876586914 and type_loss 3.115128993988037
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5845022201538086 with time_loss: -2.3306026458740234 and type_loss 2.915104866027832


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.06306219100952148 with time_loss: -2.4861953258514404 and type_loss 2.423133134841919
New best found!



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6040709018707275 with time_loss: -2.977241039276123 and type_loss 2.3731701374053955
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:52,  2.94s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.13060522079467773 with time_loss: -2.190446615219116 and type_loss 2.0598413944244385


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -0.8412456512451172 with time_loss: -3.0959408283233643 and type_loss 2.254695177078247
New best found!



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -0.7090537548065186 with time_loss: -2.933704376220703 and type_loss 2.2246506214141846



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.60it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.1045947074890137 with time_loss: 1.0956604480743408 and type_loss 2.008934259414673


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.9602342844009399 with time_loss: -2.8711373805999756 and type_loss 1.9109030961990356
New best found!



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.18372058868408203 with time_loss: -2.1417813301086426 and type_loss 2.3255019187927246



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.16923892498016357 with time_loss: -2.0580265522003174 and type_loss 1.8887876272201538


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.9962154626846313 with time_loss: 0.21592171490192413 and type_loss 1.7802937030792236


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3017538785934448 with time_loss: -0.41776540875434875 and type_loss 1.7195192575454712



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.91it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.1797248125076294 with time_loss: -2.996781826019287 and type_loss 1.8170570135116577
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.16019320487976074 with time_loss: -1.8821024894714355 and type_loss 1.7219092845916748


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -0.9473949670791626 with time_loss: -2.6554250717163086 and type_loss 1.708030104637146



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.14it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2321292161941528 with time_loss: -2.9449100494384766 and type_loss 1.7127808332443237
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0783920288085938 with time_loss: -2.720503568649292 and type_loss 1.6421115398406982


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -0.2523467540740967 with time_loss: -1.9177436828613281 and type_loss 1.6653969287872314



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.96it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.31872570514678955 with time_loss: -1.9557058811187744 and type_loss 1.6369801759719849

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.881566286087036 with time_loss: 1.2793363332748413 and type_loss 1.6022299528121948


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.496895432472229 with time_loss: -0.07360585033893585 and type_loss 1.5705013275146484



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.4177374839782715 with time_loss: -1.1397441625595093 and type_loss 1.5574816465377808

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.89s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.1263935565948486 with time_loss: -0.42655426263809204 and type_loss 1.5529478788375854



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.89it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 2.0402894020080566 with time_loss: 0.4378434717655182 and type_loss 1.6024459600448608



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.93it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.6039857864379883 with time_loss: 1.0564342737197876 and type_loss 1.5475516319274902


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.3287906646728516 with time_loss: -3.879136323928833 and type_loss 1.550345540046692
Test loss: 1.555501103401184 with time_loss: 0.0009326785802841187 and type_loss 1.5545684099197388


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 5.177124500274658 with time_loss: 3.663822650909424 and type_loss 1.5133017301559448



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -0.10469377040863037 with time_loss: -1.632418155670166 and type_loss 1.5277243852615356


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8638296127319336 with time_loss: 0.34845811128616333 and type_loss 1.5153714418411255


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.2768194675445557 with time_loss: -0.1980176717042923 and type_loss 1.4748371839523315



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.05it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.173579454421997 with time_loss: 0.6946306228637695 and type_loss 1.4789488315582275

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.8423783779144287 with time_loss: 1.3506948947906494 and type_loss 1.4916834831237793


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.90s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 0.5474465489387512 with time_loss: -0.9227809309959412 and type_loss 1.4702274799346924



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:04<00:01, 20.89it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.9403806924819946 with time_loss: 0.4615972936153412 and type_loss 1.478783369064331

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8325090408325195 with time_loss: 0.36942383646965027 and type_loss 1.4630851745605469



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:04<00:01, 21.47it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 2.154634475708008 with time_loss: 0.6824313998222351 and type_loss 1.472203016281128



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.4599149227142334 with time_loss: 1.9903059005737305 and type_loss 1.469609022140503



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.5861105918884277 with time_loss: -4.066405773162842 and type_loss 1.480295181274414
Test loss: 2.489917278289795 with time_loss: 0.996349036693573 and type_loss 1.4935681819915771


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.24385595321655273 with time_loss: -1.226202130317688 and type_loss 1.4700580835342407



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.70it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.196100234985352 with time_loss: 2.75283145904541 and type_loss 1.4432687759399414

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.066432476043701 with time_loss: 1.6304571628570557 and type_loss 1.435975193977356



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 4.545377731323242 with time_loss: 3.1104660034179688 and type_loss 1.4349116086959839



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.73it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 7.238811492919922 with time_loss: 5.803595542907715 and type_loss 1.435215711593628


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:04<00:02, 18.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.0543935298919678 with time_loss: 0.6233863830566406 and type_loss 1.4310071468353271


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.121906280517578 with time_loss: 1.6979676485061646 and type_loss 1.4239387512207031



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 3.2118916511535645 with time_loss: 1.791511058807373 and type_loss 1.4203804731369019



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.721752882003784 with time_loss: -4.147769451141357 and type_loss 1.4260165691375732
Test loss: 3.9778971672058105 with time_loss: 2.5644540786743164 and type_loss 1.4134432077407837


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 4.096912384033203 with time_loss: 2.6800107955932617 and type_loss 1.4169015884399414



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 4.307493686676025 with time_loss: 2.8884830474853516 and type_loss 1.4190105199813843

