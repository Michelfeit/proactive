Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 1.3333916664123535 with time_loss: -2.277900218963623 and type_loss 3.6112918853759766
Test loss: 0.4676809310913086 with time_loss: -2.456514596939087 and type_loss 2.9241955280303955



  - (Training)   :  40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 48/121 [00:05<00:06, 11.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.622925877571106 with time_loss: -1.9816244840621948 and type_loss 2.604550361633301



  - (Training)   :  40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 48/121 [00:05<00:06, 11.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.01183009147644043 with time_loss: -2.354557991027832 and type_loss 2.3427278995513916
New best found!



  - (Training)   :  40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 48/121 [00:05<00:06, 11.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8448853492736816 with time_loss: -3.1287729740142822 and type_loss 2.2838876247406006
New best found!




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.1479618549346924 with time_loss: -3.032900810241699 and type_loss 1.8849389553070068
New best found!




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.4102708101272583 with time_loss: -1.7170459032058716 and type_loss 2.12731671333313




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.27it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.6042463779449463 with time_loss: -2.800647258758545 and type_loss 2.1964008808135986




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.24it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.1896207332611084 with time_loss: -2.4314064979553223 and type_loss 2.241785764694214




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.24it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0866729021072388 with time_loss: -1.26592218875885 and type_loss 2.352595090866089




  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:07<00:01, 16.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.022094249725341797 with time_loss: -2.3131165504455566 and type_loss 2.291022300720215




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3919471502304077 with time_loss: -3.34238862991333 and type_loss 1.9504414796829224
Test loss: -0.7399042844772339 with time_loss: -2.529346227645874 and type_loss 1.7894419431686401


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:53,  2.94s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.0722415447235107 with time_loss: 0.29635828733444214 and type_loss 1.7758833169937134




  - (Training)   :  83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 100/121 [00:07<00:01, 17.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.37981319427490234 with time_loss: -2.1240415573120117 and type_loss 1.7442283630371094




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.23567914962768555 with time_loss: -1.8900845050811768 and type_loss 1.6544053554534912




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.3914092779159546 with time_loss: -1.2921785116195679 and type_loss 1.6835877895355225




  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:07<00:02, 14.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3841437101364136 with time_loss: -0.3049861490726471 and type_loss 1.6891298294067383




  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:07<00:02, 14.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7688175439834595 with time_loss: -2.4134998321533203 and type_loss 1.6446822881698608



  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.118103265762329 with time_loss: -2.8340461254119873 and type_loss 1.7159428596496582




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 0.19721364974975586 with time_loss: -1.4788447618484497 and type_loss 1.6760584115982056




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.21712219715118408 with time_loss: -1.3741704225540161 and type_loss 1.5912926197052002




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.02851545810699463 with time_loss: -1.48850417137146 and type_loss 1.5170196294784546




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.64it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.0661288499832153 with time_loss: -2.6251790523529053 and type_loss 1.55905020236969



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.1071739196777344 with time_loss: 1.5657577514648438 and type_loss 1.5414162874221802




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.982420802116394 with time_loss: -2.600843667984009 and type_loss 1.6184228658676147




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.3431798219680786 with time_loss: -1.1863943338394165 and type_loss 1.5295741558074951



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 4.179060935974121 with time_loss: 2.63114857673645 and type_loss 1.5479121208190918




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.262824058532715 with time_loss: 1.7332109212875366 and type_loss 1.5296132564544678




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.76it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 2.5939173698425293 with time_loss: 1.095385193824768 and type_loss 1.4985321760177612




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.16104507446289062 with time_loss: -1.3284803628921509 and type_loss 1.4895254373550415




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.797785997390747 with time_loss: 0.291034996509552 and type_loss 1.5067509412765503




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.56it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.101822853088379 with time_loss: 0.6152230501174927 and type_loss 1.4865999221801758



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.164156436920166 with time_loss: 1.6858433485031128 and type_loss 1.4783130884170532




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.22217440605163574 with time_loss: -1.2637524604797363 and type_loss 1.485926866531372




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.64it/s]
Train loss: -2.4251718521118164 with time_loss: -3.912675380706787 and type_loss 1.4875034093856812
Test loss: 0.7930649518966675 with time_loss: -0.6520947217941284 and type_loss 1.445159673690796




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.1245123147964478 with time_loss: -0.3471950590610504 and type_loss 1.4717073440551758




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.157148838043213 with time_loss: 0.722893476486206 and type_loss 1.4342554807662964



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.8790700435638428 with time_loss: 1.4318712949752808 and type_loss 1.447198748588562




  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.69it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.040963053703308 with time_loss: -0.41061344742774963 and type_loss 1.4515764713287354



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.650118827819824 with time_loss: 2.2174618244171143 and type_loss 1.4326571226119995




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.500141143798828 with time_loss: -3.967944383621216 and type_loss 1.4678031206130981
Test loss: 2.399557590484619 with time_loss: 0.9276219606399536 and type_loss 1.471935510635376




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 4.163458824157715 with time_loss: 2.727071762084961 and type_loss 1.4363869428634644




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.59it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 4.67177152633667 with time_loss: 3.242638349533081 and type_loss 1.4291330575942993




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.4954257011413574 with time_loss: 2.0447070598602295 and type_loss 1.4507187604904175




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 4.130748271942139 with time_loss: 2.701343536376953 and type_loss 1.429404854774475




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.846773624420166 with time_loss: 2.4234137535095215 and type_loss 1.423359990119934




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.7306982278823853 with time_loss: 0.3018413484096527 and type_loss 1.4288568496704102




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.66it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.2845287322998047 with time_loss: 1.8454272747039795 and type_loss 1.4391015768051147



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 5.779462814331055 with time_loss: 4.367831230163574 and type_loss 1.4116318225860596





  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.622103214263916 with time_loss: -4.036734580993652 and type_loss 1.4146314859390259
Test loss: 3.745096206665039 with time_loss: 2.3295586109161377 and type_loss 1.415537714958191




  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:07<00:02, 14.63it/s]


Test loss: 2.945404052734375 with time_loss: 1.525273323059082 and type_loss 1.4201308488845825
Best loss is: tensor(-1.1480, device='cuda:0')