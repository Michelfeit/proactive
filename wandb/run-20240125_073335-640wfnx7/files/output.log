Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 4, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.11s/it]
Test loss: 1.3617782592773438 with time_loss: -2.1606249809265137 and type_loss 3.5224032402038574




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.97458815574646 with time_loss: -2.3639872074127197 and type_loss 3.3385753631591797



  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:07<00:05, 10.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.20891332626342773 with time_loss: -2.9385762214660645 and type_loss 3.147489547729492





  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:09<00:04, 10.04it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 0.3370344638824463 with time_loss: -2.829296588897705 and type_loss 3.1663310527801514






  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:11<00:01, 10.81it/s]



  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.34288763999938965 with time_loss: -2.6839094161987305 and type_loss 3.02679705619812






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.37180447578430176 with time_loss: -2.639272451400757 and type_loss 3.0110769271850586






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.3117790222167969 with time_loss: -2.738192558288574 and type_loss 3.049971580505371





  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:11<00:02, 10.28it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 1.0666569471359253 with time_loss: -1.9131649732589722 and type_loss 2.9798219203948975







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.3297605514526367 with time_loss: -3.263953685760498 and type_loss 2.9341931343078613
Test loss: 0.17104291915893555 with time_loss: -2.7264328002929688 and type_loss 2.8974757194519043






  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:11<00:01, 10.90it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.4744892120361328 with time_loss: -3.356689691543579 and type_loss 2.8822004795074463
New best found!






  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:11<00:01, 10.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7601475715637207 with time_loss: -2.099622964859009 and type_loss 2.8597705364227295






  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:11<00:01, 10.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.3898787498474121 with time_loss: -2.4705262184143066 and type_loss 2.8604049682617188






  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:11<00:01, 10.84it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.40465402603149414 with time_loss: -3.2660295963287354 and type_loss 2.861375570297241






  - (Training)   :  84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 102/121 [00:11<00:01, 10.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.16930794715881348 with time_loss: -2.6892898082733154 and type_loss 2.858597755432129






  - (Training)   :  83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                               | 101/121 [00:11<00:01, 10.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.47247862815856934 with time_loss: -3.3098926544189453 and type_loss 2.837414026260376


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.33759284019470215 with time_loss: -2.5815606117248535 and type_loss 2.9191534519195557



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:04<00:02, 18.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.977391242980957 with time_loss: -3.8268134593963623 and type_loss 2.8494222164154053
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 0.04190993309020996 with time_loss: -2.79960036277771 and type_loss 2.84151029586792



  - (Training)   :  19%|████████████████████████████████████▍                                                                                                                                                           | 23/121 [00:05<00:18,  5.42it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.10175085067749023 with time_loss: -2.9717533588409424 and type_loss 2.870002508163452

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Train loss: -0.9551961421966553 with time_loss: -3.7627768516540527 and type_loss 2.8075807094573975
Test loss: 0.38360118865966797 with time_loss: -2.522312879562378 and type_loss 2.905914068222046
[ Epoch 20 ]
Train loss: -1.0850894451141357 with time_loss: -3.845767021179199 and type_loss 2.7606775760650635
Test loss: 1.052665114402771 with time_loss: -1.7771199941635132 and type_loss 2.829785108566284





  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:11<00:03,  9.25it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.187117576599121 with time_loss: -1.6599783897399902 and type_loss 2.8470959663391113






  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7745709419250488 with time_loss: -2.1245577335357666 and type_loss 2.8991286754608154







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.58it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.5424530506134033 with time_loss: -0.31865283846855164 and type_loss 2.8611059188842773







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 1.83925199508667 with time_loss: -0.9969070553779602 and type_loss 2.8361589908599854







  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:13<00:01,  9.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.7744052410125732 with time_loss: -0.024144815281033516 and type_loss 2.7985501289367676







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.59it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.267648935317993 with time_loss: 0.4160518944263458 and type_loss 2.8515970706939697






  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:11<00:03,  9.23it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.0293102264404297 with time_loss: 0.19170214235782623 and type_loss 2.8376080989837646







  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.537116765975952 with time_loss: -0.3303193151950836 and type_loss 2.867436170578003







  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.933992385864258 with time_loss: 1.0738033056259155 and type_loss 2.860189199447632







  - (Training)   :  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 106/121 [00:13<00:01,  9.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.8455162048339844 with time_loss: 1.044059157371521 and type_loss 2.801456928253174








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3772251605987549 with time_loss: -4.104282855987549 and type_loss 2.727057695388794
Test loss: 3.242974042892456 with time_loss: 0.4394053816795349 and type_loss 2.8035686016082764







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.7121524810791016 with time_loss: 0.9058502912521362 and type_loss 2.806302309036255






  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 3.582426071166992 with time_loss: 0.7578765749931335 and type_loss 2.824549436569214







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.59it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.7268595695495605 with time_loss: -0.07345393300056458 and type_loss 2.8003134727478027







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.9111108779907227 with time_loss: 1.1252285242080688 and type_loss 2.7858824729919434






  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:11<00:03,  9.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.6330795288085938 with time_loss: 0.8017468452453613 and type_loss 2.8313326835632324







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.2061328887939453 with time_loss: -0.5775810480117798 and type_loss 2.7837140560150146






  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.61it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 3.599461555480957 with time_loss: 0.7797082662582397 and type_loss 2.8197531700134277







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.61it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.3291471004486084 with time_loss: 0.5120206475257874 and type_loss 2.817126512527466








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.5081160068511963 with time_loss: -4.206918239593506 and type_loss 2.6988022327423096
Test loss: 3.4882571697235107 with time_loss: 0.6970714926719666 and type_loss 2.7911856174468994







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.3069071769714355 with time_loss: 0.5012148022651672 and type_loss 2.805692434310913






  - (Training)   :  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 106/121 [00:13<00:01,  9.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 3.621027708053589 with time_loss: 0.8156881928443909 and type_loss 2.8053395748138428







  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 3.067232608795166 with time_loss: 0.25093555450439453 and type_loss 2.8162970542907715







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 3.792086124420166 with time_loss: 1.0039418935775757 and type_loss 2.78814435005188







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.517759084701538 with time_loss: -4.226646900177002 and type_loss 2.708887815475464
Test loss: 4.4049224853515625 with time_loss: 1.6142991781234741 and type_loss 2.790623426437378







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.5219497680664062 with time_loss: 0.7179487943649292 and type_loss 2.8040010929107666






  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:13<00:01,  9.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 3.308128833770752 with time_loss: 0.5075738430023193 and type_loss 2.8005549907684326







  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:13<00:01,  9.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 1.7974159717559814 with time_loss: -1.0196526050567627 and type_loss 2.817068576812744








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6158266067504883 with time_loss: -4.306420803070068 and type_loss 2.69059419631958
Test loss: 3.3709704875946045 with time_loss: 0.5841739773750305 and type_loss 2.7867965698242188

