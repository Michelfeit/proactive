Training hawkes transformer...
{'batch_size': 4, 'd_k': 128, 'd_model': 256, 'd_rnn': 0, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 35, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 8, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 6.121668815612793 with time_loss: -11.578478813171387 and type_loss 17.70014762878418


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 15.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.12s/it]
Test loss: 6.297362327575684 with time_loss: -10.70217227935791 and type_loss 16.999534606933594




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.9852027893066406 with time_loss: -10.953356742858887 and type_loss 13.938559532165527


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.944429397583008 with time_loss: -10.919439315795898 and type_loss 15.863868713378906


  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 8.924149513244629 with time_loss: -11.052657127380371 and type_loss 19.976806640625




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 5.714474678039551 with time_loss: -11.687275886535645 and type_loss 17.401750564575195
Test loss: 8.354265213012695 with time_loss: -8.60366439819336 and type_loss 16.957929611206055




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 3.8545312881469727 with time_loss: -12.422026634216309 and type_loss 16.27655792236328
Test loss: 7.1645307540893555 with time_loss: -8.981566429138184 and type_loss 16.14609718322754




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 7.042229175567627 with time_loss: -7.5076117515563965 and type_loss 14.549840927124023


  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:40,  3.23s/it]
Test loss: 1.792886734008789 with time_loss: -12.774734497070312 and type_loss 14.567621231079102




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 1.7623271942138672 with time_loss: -13.146809577941895 and type_loss 14.909136772155762
Test loss: 8.953027725219727 with time_loss: -9.047704696655273 and type_loss 18.000732421875




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.151670455932617 with time_loss: -10.619871139526367 and type_loss 14.771541595458984


  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 15.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.10s/it]
Test loss: 4.913962364196777 with time_loss: -9.609323501586914 and type_loss 14.523285865783691




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 8.56129264831543 with time_loss: -5.8053083419799805 and type_loss 14.36660099029541


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 14.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:40,  3.24s/it]
Test loss: 5.2017669677734375 with time_loss: -9.045677185058594 and type_loss 14.247444152832031




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.2351255416870117 with time_loss: -12.95163631439209 and type_loss 14.186761856079102


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:05<00:03, 15.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.260419845581055 with time_loss: -9.474872589111328 and type_loss 13.735292434692383


  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 16.13it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.7580957412719727 with time_loss: -12.66236686706543 and type_loss 13.420462608337402



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 11.48686695098877 with time_loss: -1.8753503561019897 and type_loss 13.36221694946289




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.006641387939453 with time_loss: -11.49484634399414 and type_loss 13.501487731933594


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.18it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.393482208251953 with time_loss: -10.622785568237305 and type_loss 13.016267776489258



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.013820648193359 with time_loss: -8.587905883789062 and type_loss 12.601726531982422



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.4654731750488281 with time_loss: -12.958499908447266 and type_loss 12.493026733398438
New best found!


  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 13.526108741760254 with time_loss: 1.1433616876602173 and type_loss 12.382746696472168


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 9.72562026977539 with time_loss: -2.3801631927490234 and type_loss 12.105783462524414




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.971847057342529 with time_loss: -7.413517475128174 and type_loss 12.385364532470703


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 9.388772964477539 with time_loss: -2.7542049884796143 and type_loss 12.142977714538574


  - (Training)   :  50%|███████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                | 60/121 [00:05<00:04, 13.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:36,  3.12s/it]
Test loss: 3.4722471237182617 with time_loss: -8.59524917602539 and type_loss 12.067496299743652




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 0.2200469970703125 with time_loss: -12.006752014160156 and type_loss 12.226799011230469




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.4650745391845703 with time_loss: -8.197948455810547 and type_loss 11.663022994995117


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.4469966888427734 with time_loss: -13.222063064575195 and type_loss 11.775066375732422
New best found!


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 4.028825759887695 with time_loss: -7.497827529907227 and type_loss 11.526653289794922


  - (Training)   :  55%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                     | 67/121 [00:05<00:03, 15.99it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 6.768486022949219 with time_loss: -4.738962173461914 and type_loss 11.507448196411133




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 4.452965259552002 with time_loss: -7.1721625328063965 and type_loss 11.625127792358398




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 2.712639808654785 with time_loss: -8.615242958068848 and type_loss 11.327882766723633




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -5.728074073791504 with time_loss: -16.87086296081543 and type_loss 11.142788887023926
Test loss: 6.106215000152588 with time_loss: -5.081231594085693 and type_loss 11.187446594238281

