Training hawkes transformer...
{'batch_size': 4, 'd_k': 128, 'd_model': 512, 'd_rnn': 0, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 35, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 8, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 13.770183563232422 with time_loss: -7.936332702636719 and type_loss 21.70651626586914



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 18.18it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 14.195430755615234 with time_loss: -7.333657741546631 and type_loss 21.529088973999023




  - (Training)   :  98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 118/121 [00:07<00:00, 19.96it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 9.431305885314941 with time_loss: -10.003535270690918 and type_loss 19.43484115600586



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.10it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 9.461054801940918 with time_loss: -9.493767738342285 and type_loss 18.954822540283203



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.01it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: 9.088631629943848 with time_loss: -9.06033992767334 and type_loss 18.148971557617188




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 6.868752479553223 with time_loss: -11.347670555114746 and type_loss 18.21642303466797


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 5.05799674987793 with time_loss: -12.675712585449219 and type_loss 17.73370933532715



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.86it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.861725807189941 with time_loss: -5.889260292053223 and type_loss 17.750986099243164



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.16833209991455 with time_loss: -7.391623497009277 and type_loss 17.559955596923828



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:05, 12.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 9.185047149658203 with time_loss: -8.398550033569336 and type_loss 17.58359718322754



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 6.125722885131836 with time_loss: -11.395498275756836 and type_loss 17.521221160888672



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.41it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 7.595529556274414 with time_loss: -10.081716537475586 and type_loss 17.67724609375



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:05<00:05, 12.47it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:39,  3.20s/it]
Test loss: 3.7954015731811523 with time_loss: -13.594975471496582 and type_loss 17.390377044677734



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.03it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 7.909113883972168 with time_loss: -9.836716651916504 and type_loss 17.745830535888672




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 17.86486053466797 with time_loss: 0.5063416361808777 and type_loss 17.358518600463867


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 14.80it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: 17.2872257232666 with time_loss: 0.08792770653963089 and type_loss 17.199298858642578



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: 9.458061218261719 with time_loss: -7.936558246612549 and type_loss 17.39461898803711



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:05<00:03, 15.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.26986312866211 with time_loss: -7.0552978515625 and type_loss 17.32516098022461



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 2.111689567565918 with time_loss: -14.508105278015137 and type_loss 16.619794845581055
Test loss: 11.928564071655273 with time_loss: -5.311002731323242 and type_loss 17.239566802978516



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:05<00:03, 14.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.08s/it]
Test loss: 10.071061134338379 with time_loss: -6.9342546463012695 and type_loss 17.00531578063965



  - (Training)   :  57%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                  | 69/121 [00:05<00:03, 16.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 16.28550910949707 with time_loss: -1.0400755405426025 and type_loss 17.325584411621094



  - (Training)   :  56%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 68/121 [00:05<00:03, 16.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 11.120899200439453 with time_loss: -6.150083065032959 and type_loss 17.27098274230957



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.31it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 9.650799751281738 with time_loss: -7.439822196960449 and type_loss 17.090621948242188



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: 0.5198554992675781 with time_loss: -15.685073852539062 and type_loss 16.20492935180664
Test loss: 7.227628707885742 with time_loss: -9.765037536621094 and type_loss 16.992666244506836



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:03, 16.64it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.09s/it]
Test loss: 13.985518455505371 with time_loss: -3.434117317199707 and type_loss 17.419635772705078



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: 13.8509521484375 with time_loss: -3.327526569366455 and type_loss 17.178478240966797



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:05<00:02, 17.54it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: 7.310085296630859 with time_loss: -9.756595611572266 and type_loss 17.066680908203125



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:05<00:03, 15.41it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 10.114916801452637 with time_loss: -7.1715593338012695 and type_loss 17.286476135253906



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 15.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 21.55144500732422 with time_loss: 4.52513313293457 and type_loss 17.02631187438965



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.07s/it]
Test loss: 14.071924209594727 with time_loss: -2.9181160926818848 and type_loss 16.990039825439453



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.26it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 15.646589279174805 with time_loss: -1.3349194526672363 and type_loss 16.981508255004883



  - (Training)   :  58%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                 | 70/121 [00:05<00:03, 16.76it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: 14.445353507995605 with time_loss: -2.4811809062957764 and type_loss 16.92653465270996



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:05<00:02, 17.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:35,  3.08s/it]
Test loss: 18.765920639038086 with time_loss: 1.8354060649871826 and type_loss 16.93051528930664



  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:05<00:02, 17.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 11.21251392364502 with time_loss: -5.70571231842041 and type_loss 16.91822624206543



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

Test loss: 15.141770362854004 with time_loss: -1.7642924785614014 and type_loss 16.906063079833984
Best loss is: 0