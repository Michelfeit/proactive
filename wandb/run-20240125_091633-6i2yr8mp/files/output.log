Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 5, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8229823112487793 with time_loss: -2.403939723968506 and type_loss 3.226922035217285



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7223279476165771 with time_loss: -2.4037585258483887 and type_loss 3.126086473464966



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.016225814819335938 with time_loss: -2.8283040523529053 and type_loss 2.844529867172241



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.04436016082763672 with time_loss: -2.8014211654663086 and type_loss 2.757061004638672
New best found!



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 0.8434493541717529 with time_loss: -2.1179535388946533 and type_loss 2.9614028930664062



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:04<00:03, 16.10it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.3834042549133301 with time_loss: -3.318118095397949 and type_loss 2.934713840484619
New best found!



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5056228637695312 with time_loss: -1.631744146347046 and type_loss 3.137367010116577


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.011604070663452 with time_loss: -0.9482622742652893 and type_loss 2.9598662853240967



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.01822686195373535 with time_loss: -2.8909659385681152 and type_loss 2.87273907661438



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.79it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 2.612668514251709 with time_loss: -0.288763165473938 and type_loss 2.9014315605163574



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: 0.5829873085021973 with time_loss: -2.3230607509613037 and type_loss 2.906048059463501



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5104093551635742 with time_loss: -3.36590576171875 and type_loss 2.855496406555176
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.24831628799438477 with time_loss: -3.0879464149475098 and type_loss 2.839630126953125



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:04<00:03, 16.14it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.5401008129119873 with time_loss: -3.368008613586426 and type_loss 2.8279078006744385
New best found!



  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:04<00:03, 16.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: 0.14048218727111816 with time_loss: -2.7182395458221436 and type_loss 2.8587217330932617



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8505873680114746 with time_loss: -2.0171399116516113 and type_loss 2.867727279663086




Train loss: -1.0412383079528809 with time_loss: -3.8382728099823 and type_loss 2.797034502029419
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3832545280456543 with time_loss: -1.4595179557800293 and type_loss 2.8427724838256836



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.97it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8164093494415283 with time_loss: -2.044396162033081 and type_loss 2.8608055114746094



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.516029715538025 with time_loss: -1.338499903678894 and type_loss 2.854529619216919



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.93it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 0.06895709037780762 with time_loss: -2.7868285179138184 and type_loss 2.855785608291626



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9872713088989258 with time_loss: -1.8414959907531738 and type_loss 2.8287672996520996



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.98it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.022055387496948242 with time_loss: -2.825266122817993 and type_loss 2.803210735321045



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.89it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.2791876792907715 with time_loss: -2.5089547634124756 and type_loss 2.788142442703247


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.7022483348846436 with time_loss: -2.1306040287017822 and type_loss 2.832852363586426



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.708942174911499 with time_loss: -2.0879013538360596 and type_loss 2.7968435287475586



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.2527978420257568 with time_loss: -4.0065202713012695 and type_loss 2.7537224292755127
Test loss: -0.47780895233154297 with time_loss: -3.2676844596862793 and type_loss 2.7898755073547363



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.95it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.22035551071166992 with time_loss: -2.5697667598724365 and type_loss 2.7901222705841064



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.0441442728042603 with time_loss: -1.757259488105774 and type_loss 2.801403760910034



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.08757328987121582 with time_loss: -2.7023799419403076 and type_loss 2.7899532318115234



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.23069405555725098 with time_loss: -2.5685133934020996 and type_loss 2.7992074489593506




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4422497749328613 with time_loss: -4.173765182495117 and type_loss 2.731515407562256
Test loss: 0.5887389183044434 with time_loss: -2.206327199935913 and type_loss 2.7950661182403564



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.88it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.9738249778747559 with time_loss: -1.8220891952514648 and type_loss 2.7959141731262207


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.98it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.6333527565002441 with time_loss: -2.1424787044525146 and type_loss 2.775831460952759



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: 1.363506555557251 with time_loss: -1.4172708988189697 and type_loss 2.7807774543762207



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5555820465087891 with time_loss: -2.222728967666626 and type_loss 2.778311014175415



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.90it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.1529028415679932 with time_loss: -1.6158514022827148 and type_loss 2.768754243850708


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.92it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: 0.6704630851745605 with time_loss: -2.10679292678833 and type_loss 2.7772560119628906



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 16.01it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.6424295902252197 with time_loss: -2.130157470703125 and type_loss 2.7725870609283447



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.09054851531982422 with time_loss: -2.6976585388183594 and type_loss 2.7882070541381836



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4017062187194824 with time_loss: -3.17075514793396 and type_loss 2.7690489292144775



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.5648806095123291 with time_loss: -2.2072582244873047 and type_loss 2.772138833999634


  - (Training)   :  55%|████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                       | 66/121 [00:04<00:03, 16.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.6963603496551514 with time_loss: -2.074596881866455 and type_loss 2.7709572315216064



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.8641879558563232 with time_loss: -1.9132745265960693 and type_loss 2.7774624824523926



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5980079174041748 with time_loss: -2.1774301528930664 and type_loss 2.775438070297241




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6474494934082031 with time_loss: -4.34057092666626 and type_loss 2.6931214332580566
Test loss: 1.0221582651138306 with time_loss: -1.75421941280365 and type_loss 2.7763776779174805



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.98it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.24174714088439941 with time_loss: -2.53071928024292 and type_loss 2.7724664211273193


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.5463199615478516 with time_loss: -2.227651834487915 and type_loss 2.7739717960357666



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.97it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.9785813093185425 with time_loss: -1.7963615655899048 and type_loss 2.7749428749084473




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.631836175918579 with time_loss: -4.321216106414795 and type_loss 2.689379930496216
Test loss: 0.4695920944213867 with time_loss: -2.304263114929199 and type_loss 2.773855209350586



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.987259030342102 with time_loss: -1.785300374031067 and type_loss 2.772559404373169

