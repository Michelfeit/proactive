Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 6, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 18.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.31783533096313477 with time_loss: -2.438422441482544 and type_loss 2.7562577724456787



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.38it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.8044416904449463 with time_loss: -3.1000382900238037 and type_loss 2.2955965995788574
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:03<06:07,  3.06s/it]

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -1.1139779090881348 with time_loss: -3.306936025619507 and type_loss 2.192958116531372
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.116149663925171 with time_loss: -3.2663605213165283 and type_loss 2.1502108573913574
Test loss: -1.0635650157928467 with time_loss: -3.1026008129119873 and type_loss 2.0390357971191406




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.56it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7044456005096436 with time_loss: -2.773630142211914 and type_loss 2.0691845417022705



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.11824965476989746 with time_loss: -2.524947166442871 and type_loss 2.4066975116729736




  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:07<00:00, 19.63it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: 0.7597447633743286 with time_loss: -1.645492672920227 and type_loss 2.4052374362945557



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7361242771148682 with time_loss: -3.094120502471924 and type_loss 2.3579962253570557




  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.15084218978881836 with time_loss: -2.110081911087036 and type_loss 2.2609241008758545



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  3.00s/it]
Test loss: -1.2425293922424316 with time_loss: -3.4282097816467285 and type_loss 2.185680389404297
New best found!




  - (Training)   :  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                      | 107/121 [00:07<00:00, 18.20it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2046287059783936 with time_loss: -3.470353126525879 and type_loss 2.2657244205474854



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.4012317657470703 with time_loss: -3.6174962520599365 and type_loss 2.216264486312866
Test loss: -1.0886359214782715 with time_loss: -3.313563108444214 and type_loss 2.2249271869659424



  - (Training)   :  40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 48/121 [00:05<00:06, 11.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: 0.6216033697128296 with time_loss: -1.5873461961746216 and type_loss 2.208949565887451



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.72it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.30347585678100586 with time_loss: -2.431678295135498 and type_loss 2.128202438354492



  - (Training)   :  40%|█████████████████████████████████████████████████████████████████████████████▊                                                                                                                  | 49/121 [00:05<00:06, 11.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.0462470054626465 with time_loss: -3.3361306190490723 and type_loss 2.289883613586426



  - (Training)   :  40%|████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 48/121 [00:05<00:06, 11.51it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.024411439895629883 with time_loss: -2.391439914703369 and type_loss 2.3670284748077393




  - (Training)   :  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 103/121 [00:07<00:00, 18.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.7221455574035645 with time_loss: -3.0236105918884277 and type_loss 2.3014650344848633




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.184481143951416 with time_loss: -3.4988880157470703 and type_loss 2.3144068717956543
Test loss: -0.8701386451721191 with time_loss: -3.135805606842041 and type_loss 2.265666961669922



  - (Training)   :  44%|████████████████████████████████████████████████████████████████████████████████████                                                                                                            | 53/121 [00:05<00:05, 12.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8344912528991699 with time_loss: -3.0894951820373535 and type_loss 2.2550039291381836



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:05<00:05, 13.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: 0.36461830139160156 with time_loss: -1.8877744674682617 and type_loss 2.2523927688598633




  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:07<00:00, 18.57it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -0.7751390933990479 with time_loss: -2.990849733352661 and type_loss 2.2157106399536133



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.14509201049804688 with time_loss: -2.3546457290649414 and type_loss 2.2095537185668945



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8813555240631104 with time_loss: -3.195237874984741 and type_loss 2.313882350921631




  - (Training)   :  94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 114/121 [00:07<00:00, 19.57it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -0.5073471069335938 with time_loss: -2.784992218017578 and type_loss 2.2776451110839844




  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:07<00:00, 19.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.13555240631103516 with time_loss: -2.4071099758148193 and type_loss 2.271557569503784



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.0080413818359375 with time_loss: -2.247802972793579 and type_loss 2.2397615909576416



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.91it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -0.9080290794372559 with time_loss: -3.117130756378174 and type_loss 2.209101676940918




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 18.73it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.5395891666412354 with time_loss: -2.7652690410614014 and type_loss 2.225679874420166



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6471052169799805 with time_loss: -3.9621596336364746 and type_loss 2.315054416656494
Test loss: -1.4729077816009521 with time_loss: -3.7801027297973633 and type_loss 2.307194948196411
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.6437814235687256 with time_loss: -3.9914610385894775 and type_loss 2.347679615020752
Test loss: -1.3207130432128906 with time_loss: -3.643817186355591 and type_loss 2.3231041431427



  - (Training)   :  49%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                  | 59/121 [00:05<00:04, 14.23it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -1.0731329917907715 with time_loss: -3.359920024871826 and type_loss 2.2867870330810547




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.10939860343933105 with time_loss: -2.392889976501465 and type_loss 2.283491373062134


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.696364164352417 with time_loss: -2.959552764892578 and type_loss 2.263188600540161



  - (Training)   :  47%|██████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     | 57/121 [00:05<00:04, 13.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.895869255065918 with time_loss: -3.153491735458374 and type_loss 2.257622480392456




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.870723009109497 with time_loss: -4.138957500457764 and type_loss 2.2682344913482666
Test loss: -0.973137617111206 with time_loss: -3.2222530841827393 and type_loss 2.249115467071533




  - (Training)   :  36%|█████████████████████████████████████████████████████████████████████▊                                                                                                                          | 44/121 [00:05<00:07, 10.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.7891201972961426 with time_loss: -3.0152783393859863 and type_loss 2.2261581420898438



  - (Training)   :  42%|████████████████████████████████████████████████████████████████████████████████▉                                                                                                               | 51/121 [00:05<00:05, 12.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -1.0472898483276367 with time_loss: -3.274076223373413 and type_loss 2.2267863750457764




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:07<00:00, 18.80it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.06s/it]
Test loss: -0.8978359699249268 with time_loss: -3.1245975494384766 and type_loss 2.22676157951355




  - (Training)   :  93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 113/121 [00:07<00:00, 19.48it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.2820026874542236 with time_loss: -3.5031070709228516 and type_loss 2.221104383468628



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.257781982421875 with time_loss: -3.4791808128356934 and type_loss 2.2213988304138184



  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.59it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.9590742588043213 with time_loss: -3.1684439182281494 and type_loss 2.209369659423828



  - (Training)   :  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                       | 86/121 [00:07<00:02, 14.78it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.5888645648956299 with time_loss: -2.798888921737671 and type_loss 2.210024356842041



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.6401677131652832 with time_loss: -2.851996898651123 and type_loss 2.21182918548584



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.6714150905609131 with time_loss: -2.8755855560302734 and type_loss 2.2041704654693604


  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.88it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -0.7896099090576172 with time_loss: -2.9971179962158203 and type_loss 2.207508087158203



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:05<00:04, 13.50it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.7709543704986572 with time_loss: -2.972728967666626 and type_loss 2.2017745971679688




  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:07<00:00, 18.36it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -0.9946184158325195 with time_loss: -3.1964197158813477 and type_loss 2.201801300048828




  - (Training)   :  82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 99/121 [00:07<00:01, 16.59it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.857006311416626 with time_loss: -3.0547759532928467 and type_loss 2.1977696418762207



  - (Training)   :  72%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 87/121 [00:07<00:02, 14.85it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -0.7748720645904541 with time_loss: -2.9730191230773926 and type_loss 2.1981470584869385




Train loss: -2.058439016342163 with time_loss: -4.26776647567749 and type_loss 2.209327459335327

Test loss: -0.9341151714324951 with time_loss: -3.1363089084625244 and type_loss 2.2021937370300293
Best loss is: tensor(-1.4729, device='cuda:0')