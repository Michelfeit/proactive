Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -0.3205087184906006 with time_loss: -2.539757013320923 and type_loss 2.2192482948303223
Test loss: -1.41648268699646 with time_loss: -3.0011816024780273 and type_loss 1.5846989154815674
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0216808319091797 with time_loss: -3.389819622039795 and type_loss 1.3681387901306152
New best found!


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.92it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6449791193008423 with time_loss: -3.0169973373413086 and type_loss 1.3720182180404663



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.85it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.204108476638794 with time_loss: -3.412536144256592 and type_loss 1.2084276676177979
New best found!



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.96it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.041266441345215 with time_loss: -3.2274603843688965 and type_loss 1.1861939430236816


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4469573497772217 with time_loss: -3.7145276069641113 and type_loss 1.2675702571868896
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3847718238830566 with time_loss: -3.593644142150879 and type_loss 1.2088723182678223


  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.88it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.351783275604248 with time_loss: -3.578789234161377 and type_loss 1.227005958557129



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.6231350898742676 with time_loss: -3.799692392349243 and type_loss 1.1765573024749756
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.887216091156006 with time_loss: -4.1032185554504395 and type_loss 1.2160024642944336
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.05534029006958 with time_loss: -3.1623375415802 and type_loss 1.1069973707199097


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.388906478881836 with time_loss: -3.4613137245178223 and type_loss 1.0724071264266968



  - (Training)   :  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                            | 73/121 [00:04<00:02, 17.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2138227224349976 with time_loss: -2.334089517593384 and type_loss 1.1202667951583862


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.3160544633865356 with time_loss: -2.4128236770629883 and type_loss 1.0967692136764526


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:52,  2.94s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7833621501922607 with time_loss: -3.8694183826446533 and type_loss 1.0860562324523926


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0644078254699707 with time_loss: -3.162964344024658 and type_loss 1.0985565185546875


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]
Train loss: -3.475550651550293 with time_loss: -4.494403839111328 and type_loss 1.0188533067703247
Test loss: -2.694045066833496 with time_loss: -3.8098769187927246 and type_loss 1.115831732749939
[ Epoch 17 ]
Train loss: -3.495117664337158 with time_loss: -4.512791156768799 and type_loss 1.017673373222351
Test loss: -2.10965633392334 with time_loss: -3.1929426193237305 and type_loss 1.0832864046096802
[ Epoch 18 ]
Train loss: -3.5646255016326904 with time_loss: -4.566335201263428 and type_loss 1.0017096996307373
Test loss: -1.3162201642990112 with time_loss: -2.37823224067688 and type_loss 1.0620120763778687
[ Epoch 19 ]
Train loss: -3.6186275482177734 with time_loss: -4.6109209060668945 and type_loss 0.9922934174537659
Test loss: -1.870451807975769 with time_loss: -2.940579891204834 and type_loss 1.070128083229065
[ Epoch 20 ]
Train loss: -3.713038682937622 with time_loss: -4.6667609214782715 and type_loss 0.9537221789360046
Test loss: -2.200179100036621 with time_loss: -3.2378602027893066 and type_loss 1.037681221961975
[ Epoch 21 ]
Train loss: -3.8334503173828125 with time_loss: -4.773268699645996 and type_loss 0.9398183822631836
Test loss: -2.0003457069396973 with time_loss: -3.035841941833496 and type_loss 1.0354961156845093
[ Epoch 22 ]
Train loss: -3.8470499515533447 with time_loss: -4.783995151519775 and type_loss 0.9369452595710754
Test loss: -0.8518284559249878 with time_loss: -1.888131856918335 and type_loss 1.0363034009933472
[ Epoch 23 ]
Train loss: -3.872605562210083 with time_loss: -4.809265613555908 and type_loss 0.9366600513458252
Test loss: -2.501068592071533 with time_loss: -3.5608980655670166 and type_loss 1.059829592704773
[ Epoch 24 ]
Train loss: -3.9053897857666016 with time_loss: -4.8431196212768555 and type_loss 0.9377297163009644
Test loss: -1.9051984548568726 with time_loss: -2.943405866622925 and type_loss 1.0382074117660522
[ Epoch 25 ]
Train loss: -3.9324147701263428 with time_loss: -4.856515407562256 and type_loss 0.9241006374359131
Test loss: -1.7778427600860596 with time_loss: -2.8149027824401855 and type_loss 1.037060022354126
[ Epoch 26 ]
Train loss: -3.9514269828796387 with time_loss: -4.871036529541016 and type_loss 0.9196096658706665
Test loss: -3.097217082977295 with time_loss: -4.140440464019775 and type_loss 1.04322350025177
New best found!
[ Epoch 27 ]
Train loss: -3.9310262203216553 with time_loss: -4.857585906982422 and type_loss 0.9265596270561218
Test loss: -2.775163173675537 with time_loss: -3.8191545009613037 and type_loss 1.0439913272857666
[ Epoch 28 ]
Train loss: -3.978011131286621 with time_loss: -4.898216247558594 and type_loss 0.9202051758766174
Test loss: -2.1461181640625 with time_loss: -3.1963562965393066 and type_loss 1.0502382516860962
[ Epoch 29 ]
Train loss: -4.014414310455322 with time_loss: -4.93701696395874 and type_loss 0.9226024746894836
Test loss: -1.5830570459365845 with time_loss: -2.6165497303009033 and type_loss 1.0334926843643188
[ Epoch 30 ]
Train loss: -4.1308674812316895 with time_loss: -5.027276515960693 and type_loss 0.8964091539382935
Test loss: -0.574988842010498 with time_loss: -1.5945446491241455 and type_loss 1.0195558071136475
[ Epoch 31 ]
Train loss: -4.152254104614258 with time_loss: -5.048989295959473 and type_loss 0.8967351317405701
Test loss: -2.3235487937927246 with time_loss: -3.3391482830047607 and type_loss 1.0155996084213257
[ Epoch 32 ]
Train loss: -4.2019853591918945 with time_loss: -5.081138610839844 and type_loss 0.8791532516479492
Test loss: -1.9476745128631592 with time_loss: -2.956704616546631 and type_loss 1.0090301036834717
[ Epoch 33 ]
Train loss: -4.206463813781738 with time_loss: -5.096132755279541 and type_loss 0.8896687030792236
Test loss: -1.6866475343704224 with time_loss: -2.7006239891052246 and type_loss 1.0139764547348022
[ Epoch 34 ]
Train loss: -4.2253594398498535 with time_loss: -5.102766036987305 and type_loss 0.8774067163467407
Test loss: -2.2057342529296875 with time_loss: -3.223240613937378 and type_loss 1.01750648021698
[ Epoch 35 ]
Train loss: -4.240612030029297 with time_loss: -5.112771987915039 and type_loss 0.8721598982810974
Test loss: -2.083698272705078 with time_loss: -3.1047422885894775 and type_loss 1.021044135093689
[ Epoch 36 ]
Train loss: -4.261096954345703 with time_loss: -5.125488758087158 and type_loss 0.8643920421600342
Test loss: -2.1995534896850586 with time_loss: -3.215134382247925 and type_loss 1.0155808925628662
[ Epoch 37 ]
Train loss: -4.3035783767700195 with time_loss: -5.17936897277832 and type_loss 0.8757908344268799
Test loss: -3.2052817344665527 with time_loss: -4.220124244689941 and type_loss 1.0148426294326782
New best found!
[ Epoch 38 ]
Train loss: -4.272679805755615 with time_loss: -5.146275520324707 and type_loss 0.8735955357551575
Test loss: -1.5258561372756958 with time_loss: -2.5419905185699463 and type_loss 1.0161343812942505
[ Epoch 39 ]
Train loss: -4.2728657722473145 with time_loss: -5.141268730163574 and type_loss 0.868402898311615
Test loss: -2.670442581176758 with time_loss: -3.687009334564209 and type_loss 1.0165666341781616
[ Epoch 40 ]
Train loss: -4.39019775390625 with time_loss: -5.2389726638793945 and type_loss 0.8487750291824341
Test loss: -1.8959625959396362 with time_loss: -2.9054412841796875 and type_loss 1.0094786882400513
[ Epoch 41 ]
Train loss: -4.391244411468506 with time_loss: -5.2493896484375 and type_loss 0.8581453561782837
Test loss: -1.953924536705017 with time_loss: -2.9640486240386963 and type_loss 1.0101240873336792
[ Epoch 42 ]
Train loss: -4.394383430480957 with time_loss: -5.243913650512695 and type_loss 0.8495302200317383
Test loss: -1.6635018587112427 with time_loss: -2.674251079559326 and type_loss 1.0107492208480835
[ Epoch 43 ]
Train loss: -4.39667272567749 with time_loss: -5.246595859527588 and type_loss 0.8499230742454529
Test loss: -2.5700502395629883 with time_loss: -3.5835251808166504 and type_loss 1.0134750604629517
[ Epoch 44 ]
Train loss: -4.422740459442139 with time_loss: -5.273336410522461 and type_loss 0.8505960702896118
Test loss: -1.9292820692062378 with time_loss: -2.944373846054077 and type_loss 1.0150917768478394
[ Epoch 45 ]
Train loss: -4.433692932128906 with time_loss: -5.276453495025635 and type_loss 0.8427605628967285
Test loss: -2.1409449577331543 with time_loss: -3.1497080326080322 and type_loss 1.0087629556655884
[ Epoch 46 ]
Train loss: -4.458347320556641 with time_loss: -5.303391456604004 and type_loss 0.845043957233429
Test loss: -1.2423183917999268 with time_loss: -2.2549564838409424 and type_loss 1.0126380920410156
[ Epoch 47 ]
Train loss: -4.464962005615234 with time_loss: -5.308426856994629 and type_loss 0.8434649705886841
Test loss: -1.1860473155975342 with time_loss: -2.2031455039978027 and type_loss 1.0170981884002686
[ Epoch 48 ]
Train loss: -4.497658729553223 with time_loss: -5.335599422454834 and type_loss 0.8379406332969666
Test loss: -1.5674474239349365 with time_loss: -2.581408739089966 and type_loss 1.0139613151550293
[ Epoch 49 ]
Train loss: -4.4984636306762695 with time_loss: -5.342564105987549 and type_loss 0.8441002368927002
Test loss: -2.018972158432007 with time_loss: -3.037123918533325 and type_loss 1.0181517601013184

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s][34m[1mwandb[39m[22m: Network error (ConnectionError), entering retry loop.