Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 5, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.39it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.3566612005233765 with time_loss: -3.063742160797119 and type_loss 1.7070809602737427
New best found!


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0700626373291016 with time_loss: -3.5484249591827393 and type_loss 1.4783623218536377
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2597126960754395 with time_loss: -3.54679012298584 and type_loss 1.28707754611969
New best found!



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.51it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5073180198669434 with time_loss: -3.7751195430755615 and type_loss 1.2678014039993286
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.259413719177246 with time_loss: -3.4961445331573486 and type_loss 1.236730694770813



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.73it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.775689125061035 with time_loss: -3.993802070617676 and type_loss 1.2181129455566406
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.738387107849121 with time_loss: -3.9399936199188232 and type_loss 1.2016065120697021
Test loss: -2.8394789695739746 with time_loss: -4.0282182693481445 and type_loss 1.18873929977417
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8809356689453125 with time_loss: -4.052888870239258 and type_loss 1.1719533205032349
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.6423068046569824 with time_loss: -3.7833168506622314 and type_loss 1.1410101652145386



  - (Training)   :  52%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                            | 63/121 [00:04<00:03, 15.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3561766147613525 with time_loss: -3.496497869491577 and type_loss 1.1403212547302246



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.71it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.71006441116333 with time_loss: -3.797112226486206 and type_loss 1.087047815322876



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.68it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.9224424362182617 with time_loss: -4.001841068267822 and type_loss 1.0793986320495605
New best found!


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -2.9755361080169678 with time_loss: -4.046692371368408 and type_loss 1.0711562633514404
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.958522915840149 with time_loss: -3.031956434249878 and type_loss 1.073433518409729



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.74it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.768186569213867 with time_loss: -3.8500418663024902 and type_loss 1.081855297088623



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.65it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.24521541595459 with time_loss: -4.326912879943848 and type_loss 1.0816973447799683
New best found!


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -3.4514808654785156 with time_loss: -4.545476913452148 and type_loss 1.0939961671829224
New best found!



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.091540575027466 with time_loss: -4.156087398529053 and type_loss 1.064546823501587



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.64it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.580796241760254 with time_loss: -3.66819167137146 and type_loss 1.0873955488204956



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9500651359558105 with time_loss: -4.047860622406006 and type_loss 1.0977954864501953



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.4872894287109375 with time_loss: -3.5255627632141113 and type_loss 1.0382732152938843



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.74251651763916 with time_loss: -3.783477306365967 and type_loss 1.0409607887268066




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.805640459060669 with time_loss: -4.766032695770264 and type_loss 0.9603922963142395
Test loss: -2.760376453399658 with time_loss: -3.803412914276123 and type_loss 1.0430365800857544



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.70it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.209460735321045 with time_loss: -3.2565059661865234 and type_loss 1.047045350074768



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -3.2371277809143066 with time_loss: -4.276612758636475 and type_loss 1.0394850969314575



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.70it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.870223045349121 with time_loss: -3.9009389877319336 and type_loss 1.030716061592102




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.897348642349243 with time_loss: -4.856091022491455 and type_loss 0.9587423205375671
Test loss: -3.8248183727264404 with time_loss: -4.860947132110596 and type_loss 1.0361287593841553
New best found!



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.91it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.387439250946045 with time_loss: -3.4232382774353027 and type_loss 1.0357991456985474



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.951632499694824 with time_loss: -3.9715569019317627 and type_loss 1.019924283027649



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -3.742023229598999 with time_loss: -4.765838146209717 and type_loss 1.0238149166107178




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.9999122619628906 with time_loss: -4.9378814697265625 and type_loss 0.9379691481590271
Test loss: -3.2240543365478516 with time_loss: -4.241035461425781 and type_loss 1.0169811248779297




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.057837963104248 with time_loss: -4.99103307723999 and type_loss 0.9331949353218079
Test loss: -3.0667977333068848 with time_loss: -4.086404323577881 and type_loss 1.0196064710617065



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.72it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.6178641319274902 with time_loss: -3.636427164077759 and type_loss 1.018562912940979


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -3.2915139198303223 with time_loss: -4.305956840515137 and type_loss 1.014443039894104



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.67it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7626185417175293 with time_loss: -3.779775381088257 and type_loss 1.0171568393707275




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.416356086730957 with time_loss: -3.434281826019287 and type_loss 1.01792573928833


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.92it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.1777193546295166 with time_loss: -4.198092937469482 and type_loss 1.0203735828399658


  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.85it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.771852970123291 with time_loss: -3.7920920848846436 and type_loss 1.020238995552063



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.7322874069213867 with time_loss: -3.747082471847534 and type_loss 1.014794945716858




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.129647731781006 with time_loss: -5.043026924133301 and type_loss 0.9133793711662292
Test loss: -3.161646604537964 with time_loss: -4.1804609298706055 and type_loss 1.0188143253326416



  - (Training)   :  54%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                        | 65/121 [00:04<00:03, 15.85it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.3394196033477783 with time_loss: -4.349409580230713 and type_loss 1.0099899768829346


  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.62it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -3.2834596633911133 with time_loss: -4.293361663818359 and type_loss 1.0099021196365356



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.972486734390259 with time_loss: -3.9848554134368896 and type_loss 1.0123686790466309




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.226144313812256 with time_loss: -5.13491678237915 and type_loss 0.9087724685668945
Test loss: -3.1973180770874023 with time_loss: -4.205307960510254 and type_loss 1.007989764213562



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.76it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.502652645111084 with time_loss: -3.5077459812164307 and type_loss 1.0050934553146362



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.71it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.6033105850219727 with time_loss: -3.6154415607452393 and type_loss 1.0121309757232666



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.69it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.8324227333068848 with time_loss: -3.841089963912964 and type_loss 1.0086673498153687




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.302368640899658 with time_loss: -5.190750598907471 and type_loss 0.8883818984031677
Test loss: -2.6523263454437256 with time_loss: -3.662543773651123 and type_loss 1.0102174282073975




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.24712610244751 with time_loss: -5.148319721221924 and type_loss 0.9011937975883484
Test loss: -2.8840460777282715 with time_loss: -3.8850855827331543 and type_loss 1.0010393857955933



  - (Training)   :  53%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                          | 64/121 [00:04<00:03, 15.74it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -2.574125289916992 with time_loss: -3.5807697772979736 and type_loss 1.0066444873809814

