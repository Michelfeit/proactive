Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'd_model': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 2.5e-05, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 16, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]

  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.6237119436264038 with time_loss: -3.246868848800659 and type_loss 1.6231569051742554
New best found!




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.7492098808288574 with time_loss: -3.2669410705566406 and type_loss 1.5177311897277832
Test loss: -2.4702882766723633 with time_loss: -3.7758595943450928 and type_loss 1.30557119846344
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3681724071502686 with time_loss: -3.636709451675415 and type_loss 1.2685370445251465


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.331458806991577 with time_loss: -3.5728256702423096 and type_loss 1.2413668632507324


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.505977153778076 with time_loss: -3.7324414253234863 and type_loss 1.2264642715454102
Test loss: -2.5377049446105957 with time_loss: -3.754025459289551 and type_loss 1.2163203954696655
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.648411512374878 with time_loss: -3.8548691272735596 and type_loss 1.2064576148986816
Test loss: -2.283787488937378 with time_loss: -3.509155750274658 and type_loss 1.2253682613372803



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1891796588897705 with time_loss: -3.356494426727295 and type_loss 1.1673147678375244


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.563225269317627 with time_loss: -3.727871894836426 and type_loss 1.1646467447280884
New best found!



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.82it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4601738452911377 with time_loss: -3.636704444885254 and type_loss 1.1765305995941162



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:04<00:02, 18.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.4466371536254883 with time_loss: -3.579376220703125 and type_loss 1.1327389478683472



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.78it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.619050979614258 with time_loss: -3.7061359882354736 and type_loss 1.0870850086212158
New best found!



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -2.700261116027832 with time_loss: -3.8198282718658447 and type_loss 1.1195671558380127
New best found!



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.60it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.578552722930908 with time_loss: -3.6448633670806885 and type_loss 1.0663107633590698



  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:04<00:02, 18.23it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.956087589263916 with time_loss: -4.059995651245117 and type_loss 1.1039079427719116
New best found!



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.75it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.9591004848480225 with time_loss: -4.031078815460205 and type_loss 1.0719783306121826
New best found!



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2084743976593018 with time_loss: -3.2895286083221436 and type_loss 1.0810542106628418



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.49it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.0090785026550293 with time_loss: -4.091123580932617 and type_loss 1.0820449590682983
New best found!


  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.75it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.0385210514068604 with time_loss: -4.101613998413086 and type_loss 1.0630929470062256
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.541940212249756 with time_loss: -4.54872465133667 and type_loss 1.0067845582962036
Test loss: -3.275261402130127 with time_loss: -4.375029563903809 and type_loss 1.099768042564392
New best found!



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 18.93it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.5368306636810303 with time_loss: -4.605109214782715 and type_loss 1.0682785511016846
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.6772494316101074 with time_loss: -4.708035945892334 and type_loss 1.0307866334915161
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:58,  2.98s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.370637893676758 with time_loss: -3.397418260574341 and type_loss 1.0267804861068726


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9581151008605957 with time_loss: -3.9837779998779297 and type_loss 1.0256630182266235


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:58,  2.99s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8778085708618164 with time_loss: -3.9064714908599854 and type_loss 1.0286628007888794


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4875845909118652 with time_loss: -3.5169715881347656 and type_loss 1.02938711643219



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.77it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9093127250671387 with time_loss: -3.9353549480438232 and type_loss 1.026042103767395


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.309368133544922 with time_loss: -4.3492112159729 and type_loss 1.039842963218689



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.51it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.328679084777832 with time_loss: -4.350982666015625 and type_loss 1.022303581237793



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.69it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.4202632904052734 with time_loss: -4.452005386352539 and type_loss 1.0317420959472656



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.58it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.038292646408081 with time_loss: -4.067568302154541 and type_loss 1.02927565574646


  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:04<00:02, 18.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.974046230316162 with time_loss: -3.9972665309906006 and type_loss 1.023220419883728



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.57it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -3.443307399749756 with time_loss: -4.459866046905518 and type_loss 1.0165586471557617



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -3.419475555419922 with time_loss: -4.435514450073242 and type_loss 1.0160387754440308


  - (Training)   :  62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 75/121 [00:04<00:02, 18.26it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -3.3332417011260986 with time_loss: -4.348386287689209 and type_loss 1.0151445865631104



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.32it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.99s/it]
Test loss: -3.327669620513916 with time_loss: -4.339752674102783 and type_loss 1.0120831727981567



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.72it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.6611037254333496 with time_loss: -3.6797471046447754 and type_loss 1.0186433792114258



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.54it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.7979111671447754 with time_loss: -3.819406270980835 and type_loss 1.0214952230453491


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.5500693321228027 with time_loss: -4.566996097564697 and type_loss 1.016926884651184




  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.45it/s]


Test loss: -2.2342801094055176 with time_loss: -3.2550556659698486 and type_loss 1.020775556564331
[ Epoch 39 ]


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:05<00:02, 18.40it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.8386456966400146 with time_loss: -3.8506147861480713 and type_loss 1.0119690895080566


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.1248133182525635 with time_loss: -4.126877784729004 and type_loss 1.0020644664764404




  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.75it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.8700122833251953 with time_loss: -3.876909017562866 and type_loss 1.0068968534469604


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.857691764831543 with time_loss: -3.865166425704956 and type_loss 1.0074745416641235



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.340138912200928 with time_loss: -5.211930274963379 and type_loss 0.8717912435531616
Test loss: -3.34519624710083 with time_loss: -4.35459041595459 and type_loss 1.0093942880630493


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:54,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.142920970916748 with time_loss: -4.145613670349121 and type_loss 1.002692699432373



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.328369140625 with time_loss: -5.205061912536621 and type_loss 0.8766926527023315
Test loss: -2.9709372520446777 with time_loss: -3.987974166870117 and type_loss 1.01703679561615


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.96s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.1202926635742188 with time_loss: -4.123995304107666 and type_loss 1.0037027597427368



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.146685838699341 with time_loss: -4.151167869567871 and type_loss 1.0044820308685303



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.412347793579102 with time_loss: -5.2607951164245605 and type_loss 0.848447322845459
Test loss: -2.8012161254882812 with time_loss: -3.8051557540893555 and type_loss 1.0039397478103638



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.421936511993408 with time_loss: -5.2924113273620605 and type_loss 0.8704748749732971
Test loss: -3.393444538116455 with time_loss: -4.3948493003845215 and type_loss 1.0014047622680664

