Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'd_model': 128, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 4, 'num_mix_components': 32, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:05<00:02, 17.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:32,  2.97s/it]
Test loss: -1.678573489189148 with time_loss: -3.2392590045928955 and type_loss 1.5606855154037476
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.0640082359313965 with time_loss: -3.3871266841888428 and type_loss 1.3231185674667358
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3923840522766113 with time_loss: -3.7083075046539307 and type_loss 1.3159234523773193
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.510002374649048 with time_loss: -3.7513179779052734 and type_loss 1.2413156032562256
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.480900764465332 with time_loss: -3.6905081272125244 and type_loss 1.2096073627471924



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.0052590370178223 with time_loss: -3.2223503589630127 and type_loss 1.2170913219451904


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:56,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2484791278839111 with time_loss: -2.4375388622283936 and type_loss 1.1890597343444824


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:55,  2.97s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4701478481292725 with time_loss: -3.664320230484009 and type_loss 1.1941723823547363



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.770077705383301 with time_loss: -3.9521901607513428 and type_loss 1.182112455368042
Test loss: -0.860209584236145 with time_loss: -2.0650932788848877 and type_loss 1.2048836946487427



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4239814281463623 with time_loss: -3.6030709743499756 and type_loss 1.1790895462036133



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.28it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5686659812927246 with time_loss: -3.717592477798462 and type_loss 1.1489266157150269
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.8002943992614746 with time_loss: -2.9146335124969482 and type_loss 1.1143391132354736



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.4026565551757812 with time_loss: -3.513780355453491 and type_loss 1.1111239194869995



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.56it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.96s/it]
Test loss: -2.7395176887512207 with time_loss: -3.86261248588562 and type_loss 1.1230947971343994
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.061514377593994 with time_loss: -3.17665433883667 and type_loss 1.1151400804519653



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.651778221130371 with time_loss: -2.749084949493408 and type_loss 1.097306728363037



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -2.7505173683166504 with time_loss: -3.8579041957855225 and type_loss 1.107386827468872
New best found!



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:05<00:02, 17.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.323652505874634 with time_loss: -4.419052600860596 and type_loss 1.095400094985962
New best found!



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.30it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.116486072540283 with time_loss: -3.201349973678589 and type_loss 1.0848639011383057



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.55it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.377598762512207 with time_loss: -3.448432683944702 and type_loss 1.0708338022232056



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.57it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4457216262817383 with time_loss: -3.4889049530029297 and type_loss 1.0431832075119019



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2578277587890625 with time_loss: -3.2951462268829346 and type_loss 1.037318468093872



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.1477890014648438 with time_loss: -4.204619884490967 and type_loss 1.0568310022354126



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.6341991424560547 with time_loss: -3.659019708633423 and type_loss 1.0248206853866577



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -1.6827112436294556 with time_loss: -2.722639322280884 and type_loss 1.0399280786514282



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.34it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.443418264389038 with time_loss: -2.4929027557373047 and type_loss 1.0494844913482666


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.29it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -3.067164897918701 with time_loss: -4.126124858856201 and type_loss 1.0589599609375



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.36it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.97s/it]
Test loss: -1.512160301208496 with time_loss: -2.5491020679473877 and type_loss 1.0369417667388916



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.7056031227111816 with time_loss: -2.732037305831909 and type_loss 1.0264341831207275



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -2.1442720890045166 with time_loss: -3.1690754890441895 and type_loss 1.0248034000396729



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.853928565979004 with time_loss: -3.8850765228271484 and type_loss 1.031147837638855



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3673853874206543 with time_loss: -3.387115240097046 and type_loss 1.019729733467102



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.70294189453125 with time_loss: -2.7219181060791016 and type_loss 1.0189762115478516




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.1618523597717285 with time_loss: -5.051686763763428 and type_loss 0.8898342251777649
Test loss: -1.9341537952423096 with time_loss: -2.9516689777374268 and type_loss 1.0175151824951172



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.234694480895996 with time_loss: -5.117654323577881 and type_loss 0.8829600214958191
Test loss: -2.260786771774292 with time_loss: -3.2734034061431885 and type_loss 1.0126166343688965



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.208444595336914 with time_loss: -5.088487148284912 and type_loss 0.880042552947998
Test loss: -2.2125484943389893 with time_loss: -3.2327945232391357 and type_loss 1.0202460289001465



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.6328566074371338 with time_loss: -2.644883155822754 and type_loss 1.0120265483856201


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.32it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.632316827774048 with time_loss: -3.6387128829956055 and type_loss 1.0063960552215576


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.51it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.5232146978378296 with time_loss: -2.5384299755096436 and type_loss 1.015215277671814


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.24it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.931583285331726 with time_loss: -2.942225456237793 and type_loss 1.010642170906067


  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.55it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.94s/it]
Test loss: -2.4851927757263184 with time_loss: -3.4964101314544678 and type_loss 1.0112173557281494



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.51it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.387235164642334 with time_loss: -3.4004383087158203 and type_loss 1.0132031440734863



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.59it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -2.1426234245300293 with time_loss: -3.1433732509613037 and type_loss 1.0007497072219849



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.30it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.95s/it]
Test loss: -1.206756591796875 with time_loss: -2.21293306350708 and type_loss 1.006176471710205



  - (Training)   :  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                             | 72/121 [00:04<00:02, 17.52it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.495220184326172 with time_loss: -3.4988958835601807 and type_loss 1.0036755800247192



  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.27it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.784109115600586 with time_loss: -2.788424491882324 and type_loss 1.0043153762817383



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.424836158752441 with time_loss: -5.280032634735107 and type_loss 0.8551962971687317
Test loss: -2.3615264892578125 with time_loss: -3.368832588195801 and type_loss 1.0073060989379883



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.425892353057861 with time_loss: -5.284678936004639 and type_loss 0.8587865829467773
Test loss: -2.575970411300659 with time_loss: -3.581510066986084 and type_loss 1.0055396556854248



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.103937864303589 with time_loss: -3.1076784133911133 and type_loss 1.0037405490875244


  - (Training)   :  59%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 71/121 [00:04<00:02, 17.31it/s]


Test loss: -2.193668842315674 with time_loss: -3.1987555027008057 and type_loss 1.0050865411758423
Best loss is: tensor(-3.3237, device='cuda:0')