Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 2, 'n_layers': 6, 'num_mix_components': 4, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]





  - (Training)   :  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 94/121 [00:11<00:02, 10.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.05s/it]
Test loss: -0.5859081745147705 with time_loss: -2.7838540077209473 and type_loss 2.1979458332061768
New best found!






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5615417957305908 with time_loss: -3.2851903438568115 and type_loss 1.7236485481262207
New best found!






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.36it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7895028591156006 with time_loss: -3.3280086517333984 and type_loss 1.5385057926177979
New best found!






  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:11<00:03,  9.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.798551082611084 with time_loss: -3.2879669666290283 and type_loss 1.4894158840179443
New best found!







  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.81it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.4555306434631348 with time_loss: -3.7570602893829346 and type_loss 1.3015295267105103
New best found!






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.3082447052001953 with time_loss: -3.687777519226074 and type_loss 1.3795329332351685






  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.77it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.3107762336730957 with time_loss: -3.5869641304016113 and type_loss 1.2761878967285156







  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.86it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: -2.5604307651519775 with time_loss: -3.7966973781585693 and type_loss 1.2362666130065918
New best found!







  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -2.4220786094665527 with time_loss: -3.6676218509674072 and type_loss 1.245543360710144







  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.82it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.7728710174560547 with time_loss: -3.973181962966919 and type_loss 1.2003109455108643
New best found!







  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.83it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.01s/it]
Test loss: -2.579676628112793 with time_loss: -3.7237112522125244 and type_loss 1.1440346240997314






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.34it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.416077136993408 with time_loss: -3.552450656890869 and type_loss 1.1363734006881714






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.39it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9862828254699707 with time_loss: -4.1063971519470215 and type_loss 1.1201143264770508
New best found!






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5534286499023438 with time_loss: -3.6949985027313232 and type_loss 1.14156973361969






  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:11<00:03,  9.35it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.875370502471924 with time_loss: -3.9968183040618896 and type_loss 1.1214479207992554







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.7137808799743652 with time_loss: -3.8261423110961914 and type_loss 1.1123613119125366






  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:13<00:01,  9.81it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -3.0114965438842773 with time_loss: -4.104490280151367 and type_loss 1.0929936170578003
New best found!



  - (Training)   :  51%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                             | 62/121 [00:04<00:03, 15.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.404386281967163 with time_loss: -3.525939464569092 and type_loss 1.1215531826019287




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.6931955814361572 with time_loss: -3.796377658843994 and type_loss 1.103182077407837



  - (Training)   :  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 94/121 [00:08<00:02, 12.65it/s]



  - (Training)   :  69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 22/32 [00:05<00:01,  5.21it/s]
Test loss: -3.2020812034606934 with time_loss: -4.302687644958496 and type_loss 1.1006064414978027
New best found!



  - (Training)   :  48%|████████████████████████████████████████████████████████████████████████████████████████████                                                                                                    | 58/121 [00:05<00:04, 13.84it/s]



  - (Training)   :  69%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 22/32 [00:05<00:01,  5.19it/s]
Test loss: -3.3030967712402344 with time_loss: -4.37858772277832 and type_loss 1.0754910707473755
New best found!





  - (Training)   :  89%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                    | 108/121 [00:09<00:00, 16.31it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.94415283203125 with time_loss: -4.0037102699279785 and type_loss 1.059557557106018






  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.885552406311035 with time_loss: -3.9633750915527344 and type_loss 1.0778228044509888






  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.53it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1451575756073 with time_loss: -3.2161331176757812 and type_loss 1.0709755420684814







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.04s/it]
Test loss: -3.0454936027526855 with time_loss: -4.1124067306518555 and type_loss 1.0669130086898804







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.939762592315674 with time_loss: -3.9821970462799072 and type_loss 1.042434573173523







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.52it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.03s/it]
Test loss: -2.6221680641174316 with time_loss: -3.667799472808838 and type_loss 1.0456314086914062







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.332097291946411 with time_loss: -4.372702598571777 and type_loss 1.0406053066253662
New best found!







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.53it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.02s/it]
Test loss: -2.535970449447632 with time_loss: -3.5826544761657715 and type_loss 1.0466840267181396







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.54it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.515613555908203 with time_loss: -3.565445899963379 and type_loss 1.0498324632644653







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.48it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:34,  3.03s/it]
Test loss: -3.2476727962493896 with time_loss: -4.284794330596924 and type_loss 1.0371215343475342







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.3716421127319336 with time_loss: -3.410634756088257 and type_loss 1.0389926433563232







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.50it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.750300884246826 with time_loss: -3.7851626873016357 and type_loss 1.0348618030548096







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.759943962097168 with time_loss: -3.7910659313201904 and type_loss 1.031121850013733







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.0785090923309326 with time_loss: -4.103287696838379 and type_loss 1.0247786045074463







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:03<01:33,  3.00s/it]
Test loss: -3.225825071334839 with time_loss: -4.255558490753174 and type_loss 1.029733419418335







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8393423557281494 with time_loss: -3.8698301315307617 and type_loss 1.0304877758026123








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -3.925401449203491 with time_loss: -4.875908374786377 and type_loss 0.9505069851875305
Test loss: -3.466616630554199 with time_loss: -4.497016429901123 and type_loss 1.0303997993469238
New best found!






  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:11<00:05,  8.05it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.405898094177246 with time_loss: -4.431123733520508 and type_loss 1.0252255201339722







  - (Training)   :  79%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                         | 95/121 [00:13<00:03,  8.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.8596558570861816 with time_loss: -3.892406702041626 and type_loss 1.0327508449554443








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.276705503463745 with time_loss: -4.30543851852417 and type_loss 1.0287330150604248







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.137265205383301 with time_loss: -4.167119026184082 and type_loss 1.0298539400100708







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.004848480224609 with time_loss: -4.93705415725708 and type_loss 0.9322054386138916
Test loss: -2.8723983764648438 with time_loss: -3.8971900939941406 and type_loss 1.0247915983200073








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.3941359519958496 with time_loss: -4.42498779296875 and type_loss 1.0308517217636108







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.017193794250488 with time_loss: -4.959851264953613 and type_loss 0.9426572918891907
Test loss: -2.3903188705444336 with time_loss: -3.4147605895996094 and type_loss 1.0244417190551758








  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.180995464324951 with time_loss: -4.205806255340576 and type_loss 1.0248106718063354







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.055707931518555 with time_loss: -4.978576183319092 and type_loss 0.9228684306144714
Test loss: -2.9905457496643066 with time_loss: -4.014317035675049 and type_loss 1.0237714052200317







  - (Training)   :  79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 96/121 [00:13<00:02,  8.51it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -3.0934762954711914 with time_loss: -4.1180620193481445 and type_loss 1.0245858430862427







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.940563678741455 with time_loss: -3.963636875152588 and type_loss 1.0230731964111328







  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

Test loss: -2.7603726387023926 with time_loss: -3.78934383392334 and type_loss 1.0289710760116577
Best loss is: tensor(-3.4666, device='cuda:0')