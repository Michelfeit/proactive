Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 6, 'num_mix_components': 5, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.48it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9724476337432861 with time_loss: -2.2791645526885986 and type_loss 3.2516121864318848



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:04<00:05, 13.14it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.2798595428466797 with time_loss: -2.868345260620117 and type_loss 3.148204803466797




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:06<00:00, 19.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5342907905578613 with time_loss: -2.596431255340576 and type_loss 3.1307220458984375



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.00016641616821289062 with time_loss: -2.933650493621826 and type_loss 2.933816909790039





Train loss: -0.18534088134765625 with time_loss: -3.1365134716033936 and type_loss 2.9511725902557373

  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -0.30019497871398926 with time_loss: -3.247692108154297 and type_loss 2.9474971294403076
New best found!



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4629366397857666 with time_loss: -3.371433973312378 and type_loss 2.9084973335266113
New best found!


  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -0.6393105983734131 with time_loss: -3.5465290546417236 and type_loss 2.9072184562683105
New best found!



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:04<00:05, 13.23it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.474729061126709 with time_loss: -3.391576051712036 and type_loss 2.916846990585327



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.45it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.1124720573425293 with time_loss: -1.7846856117248535 and type_loss 2.897157669067383




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.20it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.5180715322494507 with time_loss: -1.330834984779358 and type_loss 2.8489065170288086



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.66it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.40512847900390625 with time_loss: -2.4344353675842285 and type_loss 2.8395638465881348




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:06<00:00, 19.22it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.048858642578125 with time_loss: -0.8402903079986572 and type_loss 2.8891489505767822



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.65it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 1.0479815006256104 with time_loss: -1.8158445358276367 and type_loss 2.863826036453247




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.08it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.2801377773284912 with time_loss: -2.5566420555114746 and type_loss 2.836779832839966



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.63it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8016314506530762 with time_loss: -3.611201763153076 and type_loss 2.8095703125
New best found!



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.46it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.49122047424316406 with time_loss: -2.328108072280884 and type_loss 2.819328546524048



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.48it/s]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.11681127548217773 with time_loss: -2.7214765548706055 and type_loss 2.838287830352783



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.73it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 0.46091580390930176 with time_loss: -2.4001996517181396 and type_loss 2.8611154556274414




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.12it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.5075845718383789 with time_loss: -2.303493022918701 and type_loss 2.81107759475708



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7129075527191162 with time_loss: -2.1282880306243896 and type_loss 2.841195583343506




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:06<00:00, 19.33it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.9765812158584595 with time_loss: -1.8355048894882202 and type_loss 2.8120861053466797




  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.66it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4242749214172363 with time_loss: -1.412809133529663 and type_loss 2.8370840549468994



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.40it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 0.29669857025146484 with time_loss: -2.5965840816497803 and type_loss 2.893282651901245




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3119843006134033 with time_loss: -4.0446391105651855 and type_loss 2.7326548099517822
Test loss: 0.2882988452911377 with time_loss: -2.523409605026245 and type_loss 2.811708450317383



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.67it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 2.032320261001587 with time_loss: -0.8787179589271545 and type_loss 2.9110381603240967




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3806111812591553 with time_loss: -4.108622074127197 and type_loss 2.728010892868042
Test loss: 0.6889450550079346 with time_loss: -2.106431484222412 and type_loss 2.7953765392303467



  - (Training)   :  45%|█████████████████████████████████████████████████████████████████████████████████████▋                                                                                                          | 54/121 [00:04<00:05, 13.21it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4995380640029907 with time_loss: -1.3489583730697632 and type_loss 2.848496437072754




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:06<00:00, 19.37it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.2348748445510864 with time_loss: -1.6197201013565063 and type_loss 2.8545949459075928


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.45it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.36527585983276367 with time_loss: -2.4335274696350098 and type_loss 2.7988033294677734




  - (Training)   :  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 111/121 [00:06<00:00, 19.23it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.0749026536941528 with time_loss: -1.7893849611282349 and type_loss 2.8642876148223877


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.47it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.1860623359680176 with time_loss: -0.6401808857917786 and type_loss 2.8262431621551514



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.49it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: 1.6217031478881836 with time_loss: -1.1774213314056396 and type_loss 2.7991244792938232





Train loss: -1.569664478302002 with time_loss: -4.267519474029541 and type_loss 2.697854995727539
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8610103130340576 with time_loss: -0.9960176944732666 and type_loss 2.857028007507324



  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.68it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 1.9408955574035645 with time_loss: -0.9157702922821045 and type_loss 2.856665849685669




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.17it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.810776472091675 with time_loss: -0.03971722722053528 and type_loss 2.8504936695098877




  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.46it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.2696337699890137 with time_loss: -1.5661275386810303 and type_loss 2.835761308670044




  - (Training)   :  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 112/121 [00:06<00:00, 19.45it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: 1.174331784248352 with time_loss: -1.6437691450119019 and type_loss 2.818100929260254



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.8595219850540161 with time_loss: -1.0135999917984009 and type_loss 2.873121976852417



  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:06<00:00, 19.05it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 1.4310399293899536 with time_loss: -1.3902684450149536 and type_loss 2.8213083744049072




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.635859489440918 with time_loss: -1.2177231311798096 and type_loss 2.8535826206207275


  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.6616783142089844 with time_loss: -0.16375195980072021 and type_loss 2.825430393218994




  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.16it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.243081569671631 with time_loss: -0.6201227903366089 and type_loss 2.86320424079895


  - (Training)   :  46%|████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                       | 56/121 [00:04<00:04, 13.68it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.7566872835159302 with time_loss: -1.0624350309371948 and type_loss 2.819122314453125




  - (Training)   :  90%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 109/121 [00:06<00:00, 18.99it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.835528016090393 with time_loss: -1.0024362802505493 and type_loss 2.8379642963409424


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.49it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.176215648651123 with time_loss: -0.6316189765930176 and type_loss 2.8078346252441406



  - (Training)   :  91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                 | 110/121 [00:06<00:00, 19.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 1.4244070053100586 with time_loss: -1.403477430343628 and type_loss 2.8278844356536865




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.78904390335083 with time_loss: -4.469851016998291 and type_loss 2.680807113647461
Test loss: 2.093959331512451 with time_loss: -0.7256984114646912 and type_loss 2.819657802581787



  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.44it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: 1.8754494190216064 with time_loss: -0.9726090431213379 and type_loss 2.8480584621429443




  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 2.345329999923706 with time_loss: -0.49955371022224426 and type_loss 2.844883680343628


  - (Training)   :  45%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                                        | 55/121 [00:04<00:04, 13.43it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: 3.4662013053894043 with time_loss: 0.5918627381324768 and type_loss 2.8743386268615723

