Training hawkes transformer...
{'batch_size': 4, 'd_k': 32, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 4, 'n_layers': 3, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.4214496612548828 with time_loss: -2.956026315689087 and type_loss 1.534576654434204
New best found!


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.963213324546814 with time_loss: -3.3520801067352295 and type_loss 1.3888667821884155
Test loss: -2.4082717895507812 with time_loss: -3.704453229904175 and type_loss 1.296181559562683
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4393973350524902 with time_loss: -3.701796531677246 and type_loss 1.2623991966247559
New best found!



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -1.0162396430969238 with time_loss: -2.2159385681152344 and type_loss 1.1996989250183105



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.19it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.4629926681518555 with time_loss: -3.72723126411438 and type_loss 1.2642385959625244
New best found!



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.43it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.517819404602051 with time_loss: -3.637000322341919 and type_loss 1.1191807985305786
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4697823524475098 with time_loss: -3.655744791030884 and type_loss 1.1859623193740845



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.15it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.92s/it]
Test loss: -2.663297176361084 with time_loss: -3.8178913593292236 and type_loss 1.1545941829681396
New best found!



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.44it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8845727443695068 with time_loss: -3.0525636672973633 and type_loss 1.1679909229278564



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4673914909362793 with time_loss: -3.618471145629883 and type_loss 1.1510796546936035


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7836484909057617 with time_loss: -2.8407654762268066 and type_loss 1.057116985321045


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.1575450897216797 with time_loss: -3.237926483154297 and type_loss 1.0803813934326172



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.23it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.2514262199401855 with time_loss: -3.3092408180236816 and type_loss 1.0578144788742065



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.34it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.623437523841858 with time_loss: -2.7254340648651123 and type_loss 1.1019965410232544


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.4318366050720215 with time_loss: -3.4852957725524902 and type_loss 1.0534590482711792


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.9739394187927246 with time_loss: -4.053169250488281 and type_loss 1.079229712486267
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.538945198059082 with time_loss: -3.618135690689087 and type_loss 1.0791906118392944



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.36it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:31,  2.94s/it]
Test loss: -3.238431692123413 with time_loss: -4.306002140045166 and type_loss 1.067570447921753
New best found!



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.15it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.154231071472168 with time_loss: -4.251927852630615 and type_loss 1.0976966619491577


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.557025909423828 with time_loss: -3.643040895462036 and type_loss 1.0860151052474976


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.212501049041748 with time_loss: -2.2540781497955322 and type_loss 1.0415771007537842


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.5883779525756836 with time_loss: -3.621513843536377 and type_loss 1.033136010169983



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.38it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.3329005241394043 with time_loss: -3.3501973152160645 and type_loss 1.0172969102859497



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.26it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.096376419067383 with time_loss: -4.116735935211182 and type_loss 1.0203595161437988


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.7299870252609253 with time_loss: -2.781822919845581 and type_loss 1.0518358945846558


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.7709367275238037 with time_loss: -3.805920124053955 and type_loss 1.0349833965301514



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.17it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -0.8893074989318848 with time_loss: -1.9193040132522583 and type_loss 1.0299965143203735



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.11it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.9685300588607788 with time_loss: -2.9884374141693115 and type_loss 1.0199073553085327



  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -3.029560089111328 with time_loss: -4.035122394561768 and type_loss 1.00556218624115


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.215402603149414 with time_loss: -2.236508846282959 and type_loss 1.021106243133545


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.565896987915039 with time_loss: -3.5772807598114014 and type_loss 1.0113837718963623



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.39it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.90s/it]
Test loss: -2.0717713832855225 with time_loss: -3.0794811248779297 and type_loss 1.0077097415924072



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.37it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.607670783996582 with time_loss: -2.617292642593384 and type_loss 1.0096218585968018


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.92s/it]


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.522043228149414 with time_loss: -3.535074234008789 and type_loss 1.0130308866500854


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.887683391571045 with time_loss: -3.905625820159912 and type_loss 1.0179424285888672



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -2.1248693466186523 with time_loss: -3.122225284576416 and type_loss 0.9973559379577637



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.16it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -2.1745669841766357 with time_loss: -3.173790454864502 and type_loss 0.999223530292511


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.359809875488281 with time_loss: -5.210699558258057 and type_loss 0.8508899211883545
Test loss: -1.5286743640899658 with time_loss: -2.5341684818267822 and type_loss 1.0054941177368164


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:53,  2.95s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.8131556510925293 with time_loss: -2.816027879714966 and type_loss 1.0028722286224365


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.2737302780151367 with time_loss: -3.272411584854126 and type_loss 0.998681366443634



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.42it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.93s/it]
Test loss: -2.041985034942627 with time_loss: -3.045693874359131 and type_loss 1.003708839416504



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.15it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.914496898651123 with time_loss: -2.910634994506836 and type_loss 0.9961381554603577


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.476314544677734 with time_loss: -5.312455177307129 and type_loss 0.8361408710479736
Test loss: -1.275578498840332 with time_loss: -2.2767021656036377 and type_loss 1.0011236667633057


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -2.046950578689575 with time_loss: -3.039804458618164 and type_loss 0.9928538799285889



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.10it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.5642426013946533 with time_loss: -2.5581154823303223 and type_loss 0.9938729405403137



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.12it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.99473237991333 with time_loss: -2.9958863258361816 and type_loss 1.0011539459228516



  - (Training)   :  68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                              | 82/121 [00:04<00:01, 20.20it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.7523856163024902 with time_loss: -2.7534008026123047 and type_loss 1.0010151863098145


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -4.516576290130615 with time_loss: -5.352870941162109 and type_loss 0.8362945914268494
Test loss: -1.9102524518966675 with time_loss: -2.91048526763916 and type_loss 1.0002328157424927


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.890946626663208 with time_loss: -2.887190103530884 and type_loss 0.9962434768676758



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.34it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:30,  2.91s/it]
Test loss: -1.8989242315292358 with time_loss: -2.8992717266082764 and type_loss 1.0003474950790405

