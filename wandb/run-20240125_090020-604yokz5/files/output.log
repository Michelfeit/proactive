Training hawkes transformer...
{'batch_size': 4, 'd_k': 64, 'data': 'data/Breakfast/', 'device': 'cuda', 'dropout': 0.1, 'epochs': 50, 'learning_rate': 0.0001, 'n_head': 8, 'n_layers': 3, 'num_mix_components': 6, 'smooth': 0}
Loading All Datasets...
45 9
tensor(-2.0079, device='cuda:0') tensor(1.7772, device='cuda:0')
[ Epoch 0 ]


  - (Training)   :  61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 74/121 [00:04<00:02, 18.18it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: -0.08333134651184082 with time_loss: -2.708261251449585 and type_loss 2.624929904937744
New best found!



  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.65it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.13752174377441406 with time_loss: -2.583712339401245 and type_loss 2.446190595626831
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4945101737976074 with time_loss: -2.68884015083313 and type_loss 2.1943299770355225
New best found!



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.72it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.7654252052307129 with time_loss: -1.6252000331878662 and type_loss 2.390625238418579


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.4252440929412842 with time_loss: -2.6287126541137695 and type_loss 2.2034685611724854


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:47,  2.90s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -0.30970096588134766 with time_loss: -2.8870139122009277 and type_loss 2.57731294631958



  - (Training)   :  70%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                         | 85/121 [00:04<00:01, 20.89it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.6491799354553223 with time_loss: -2.570653200149536 and type_loss 1.9214732646942139
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.8851051330566406 with time_loss: -2.8023438453674316 and type_loss 1.917238712310791
New best found!



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.13it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -1.1145081520080566 with time_loss: -2.9598612785339355 and type_loss 1.845353126525879
New best found!



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -1.3155800104141235 with time_loss: -3.293497085571289 and type_loss 1.9779170751571655
Test loss: -1.137831449508667 with time_loss: -3.236217975616455 and type_loss 2.098386526107788
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.89s/it]
Test loss: -0.5878565311431885 with time_loss: -2.3002099990844727 and type_loss 1.7123534679412842



  - (Training)   :  64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                     | 77/121 [00:04<00:02, 18.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 2.00179386138916 with time_loss: 0.3314104676246643 and type_loss 1.6703834533691406



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.94it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -0.13158690929412842 with time_loss: -1.7805007696151733 and type_loss 1.648913860321045


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.9885692596435547 with time_loss: 2.3637189865112305 and type_loss 1.6248502731323242



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.99it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.3850138187408447 with time_loss: -0.23915447294712067 and type_loss 1.6241682767868042


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.4105294942855835 with time_loss: -1.2365227937698364 and type_loss 1.64705228805542



  - (Training)   :  64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 78/121 [00:04<00:02, 19.16it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: -0.669029951095581 with time_loss: -2.268686294555664 and type_loss 1.599656343460083



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.92it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: -1.162781000137329 with time_loss: -2.7642781734466553 and type_loss 1.6014971733093262
New best found!

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.1501801013946533 with time_loss: -2.7434277534484863 and type_loss 1.593247652053833


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: -0.9639617204666138 with time_loss: -2.597248077392578 and type_loss 1.6332863569259644



  - (Training)   :  73%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                    | 88/121 [00:04<00:01, 21.68it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 0.6534115076065063 with time_loss: -0.8868459463119507 and type_loss 1.540257453918457


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.3556180000305176 with time_loss: -3.851940870285034 and type_loss 1.4963228702545166
Test loss: 4.211688995361328 with time_loss: 2.7138075828552246 and type_loss 1.4978816509246826



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.10it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 2.8536314964294434 with time_loss: 1.3511940240859985 and type_loss 1.5024374723434448



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.84it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 0.014489412307739258 with time_loss: -1.5214465856552124 and type_loss 1.5359359979629517


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 6.194206237792969 with time_loss: 4.7215752601623535 and type_loss 1.4726310968399048



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 21.94it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.9736255407333374 with time_loss: -0.5812194347381592 and type_loss 1.5548449754714966



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.4054861068725586 with time_loss: -3.8692901134490967 and type_loss 1.463804006576538

  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: -1.2348943948745728 with time_loss: -2.697683095932007 and type_loss 1.462788701057434
New best found!


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.90s/it]
Test loss: 0.1647881269454956 with time_loss: -1.32716703414917 and type_loss 1.4919551610946655



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.07it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.4554113149642944 with time_loss: -0.02494814246892929 and type_loss 1.480359435081482


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.0118173360824585 with time_loss: -0.4555576741695404 and type_loss 1.4673750400543213



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.15it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.7043859958648682 with time_loss: 0.26543599367141724 and type_loss 1.4389500617980957


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.571213483810425 with time_loss: -3.9731225967407227 and type_loss 1.4019091129302979
Test loss: 0.8386069536209106 with time_loss: -0.5876773595809937 and type_loss 1.4262843132019043


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 1.465630292892456 with time_loss: 0.043350402265787125 and type_loss 1.4222798347473145



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.08it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.5571954250335693 with time_loss: 2.141153573989868 and type_loss 1.4160418510437012


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.595055103302002 with time_loss: -3.993232250213623 and type_loss 1.3981770277023315
Test loss: 1.1646716594696045 with time_loss: -0.25045228004455566 and type_loss 1.4151239395141602


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:50,  2.92s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.70759654045105 with time_loss: 1.3098841905593872 and type_loss 1.3977123498916626



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.14it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.064108967781067 with time_loss: -0.33351001143455505 and type_loss 1.3976190090179443

  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:51,  2.93s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 3.775355100631714 with time_loss: 2.3599705696105957 and type_loss 1.4153845310211182


  - (Training)   :  63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                       | 76/121 [00:04<00:02, 18.62it/s]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.534026622772217 with time_loss: 1.1147149801254272 and type_loss 1.4193115234375



  - (Training)   :  74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 90/121 [00:04<00:01, 22.09it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.0196516513824463 with time_loss: 1.6349655389785767 and type_loss 1.3846861124038696


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.7462680339813232 with time_loss: -4.095981121063232 and type_loss 1.3497130870819092
Test loss: 2.408590316772461 with time_loss: 1.0213533639907837 and type_loss 1.3872369527816772


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:49,  2.91s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 2.3258755207061768 with time_loss: 0.9472321271896362 and type_loss 1.3786433935165405



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.92it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 3.1396102905273438 with time_loss: 1.7576349973678589 and type_loss 1.3819754123687744



Train loss: -2.7694389820098877 with time_loss: -4.108679294586182 and type_loss 1.339240312576294
  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 5.122945785522461 with time_loss: 3.7392213344573975 and type_loss 1.3837244510650635



  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.7701053619384766 with time_loss: -4.118858814239502 and type_loss 1.348753571510315
Test loss: 4.232654094696045 with time_loss: 2.838325262069702 and type_loss 1.3943289518356323



  - (Training)   :  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                  | 89/121 [00:04<00:01, 21.95it/s]


  - (Training)   :   0%|                                                                                                                                                                                                         | 0/121 [00:00<?, ?it/s]
Test loss: 1.5668697357177734 with time_loss: 0.1818917691707611 and type_loss 1.38497793674469


  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Train loss: -2.7767577171325684 with time_loss: -4.128476619720459 and type_loss 1.3517190217971802
Test loss: 4.135465621948242 with time_loss: 2.745452642440796 and type_loss 1.3900129795074463


  - (Training)   :   1%|█▌                                                                                                                                                                                               | 1/121 [00:02<05:48,  2.90s/it]

  - (Training)   :   0%|                                                                                                                                                                                                          | 0/32 [00:00<?, ?it/s]
Test loss: 5.52114725112915 with time_loss: 4.128669261932373 and type_loss 1.3924778699874878



  - (Training)   :  69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 83/121 [00:04<00:01, 20.41it/s]


  - (Training)   :   3%|██████                                                                                                                                                                                            | 1/32 [00:02<01:29,  2.88s/it]
Test loss: 3.5263254642486572 with time_loss: 2.1507561206817627 and type_loss 1.3755693435668945

